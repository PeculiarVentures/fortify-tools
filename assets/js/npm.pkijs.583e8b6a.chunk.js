(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"26BL":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("5v3g"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.altNames=(0,i.getParametersValue)(e,"altNames",o.defaultValues("altNames")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"altNames":return[];default:throw new Error(`Invalid member name for AltName class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.altNames||"",value:n.default.schema()})]})}fromSchema(e){(0,i.clearProps)(e,["altNames"]);const t=s.compareSchema(e,e,o.schema({names:{altNames:"altNames"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AltName");"altNames"in t.result&&(this.altNames=Array.from(t.result.altNames,e=>new n.default({schema:e})))}toSchema(){return new s.Sequence({value:Array.from(this.altNames,e=>e.toSchema())})}toJSON(){return{altNames:Array.from(this.altNames,e=>e.toJSON())}}}t.default=o},"2jW+":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("kQfs"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.version=(0,i.getParametersValue)(e,"version",o.defaultValues("version")),this.modulus=(0,i.getParametersValue)(e,"modulus",o.defaultValues("modulus")),this.publicExponent=(0,i.getParametersValue)(e,"publicExponent",o.defaultValues("publicExponent")),this.privateExponent=(0,i.getParametersValue)(e,"privateExponent",o.defaultValues("privateExponent")),this.prime1=(0,i.getParametersValue)(e,"prime1",o.defaultValues("prime1")),this.prime2=(0,i.getParametersValue)(e,"prime2",o.defaultValues("prime2")),this.exponent1=(0,i.getParametersValue)(e,"exponent1",o.defaultValues("exponent1")),this.exponent2=(0,i.getParametersValue)(e,"exponent2",o.defaultValues("exponent2")),this.coefficient=(0,i.getParametersValue)(e,"coefficient",o.defaultValues("coefficient")),"otherPrimeInfos"in e&&(this.otherPrimeInfos=(0,i.getParametersValue)(e,"otherPrimeInfos",o.defaultValues("otherPrimeInfos"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"version":return 0;case"modulus":case"publicExponent":case"privateExponent":case"prime1":case"prime2":case"exponent1":case"exponent2":case"coefficient":return new s.Integer;case"otherPrimeInfos":return[];default:throw new Error(`Invalid member name for RSAPrivateKey class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.version||""}),new s.Integer({name:t.modulus||""}),new s.Integer({name:t.publicExponent||""}),new s.Integer({name:t.privateExponent||""}),new s.Integer({name:t.prime1||""}),new s.Integer({name:t.prime2||""}),new s.Integer({name:t.exponent1||""}),new s.Integer({name:t.exponent2||""}),new s.Integer({name:t.coefficient||""}),new s.Sequence({optional:!0,value:[new s.Repeated({name:t.otherPrimeInfosName||"",value:n.default.schema(t.otherPrimeInfo||{})})]})]})}fromSchema(e){(0,i.clearProps)(e,["version","modulus","publicExponent","privateExponent","prime1","prime2","exponent1","exponent2","coefficient","otherPrimeInfos"]);const t=s.compareSchema(e,e,o.schema({names:{version:"version",modulus:"modulus",publicExponent:"publicExponent",privateExponent:"privateExponent",prime1:"prime1",prime2:"prime2",exponent1:"exponent1",exponent2:"exponent2",coefficient:"coefficient",otherPrimeInfo:{names:{blockName:"otherPrimeInfos"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RSAPrivateKey");this.version=t.result.version.valueBlock.valueDec,this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent,this.privateExponent=t.result.privateExponent.convertFromDER(256),this.prime1=t.result.prime1.convertFromDER(128),this.prime2=t.result.prime2.convertFromDER(128),this.exponent1=t.result.exponent1.convertFromDER(128),this.exponent2=t.result.exponent2.convertFromDER(128),this.coefficient=t.result.coefficient.convertFromDER(128),"otherPrimeInfos"in t.result&&(this.otherPrimeInfos=Array.from(t.result.otherPrimeInfos,e=>new n.default({schema:e})))}toSchema(){const e=[];return e.push(new s.Integer({value:this.version})),e.push(this.modulus.convertToDER()),e.push(this.publicExponent),e.push(this.privateExponent.convertToDER()),e.push(this.prime1.convertToDER()),e.push(this.prime2.convertToDER()),e.push(this.exponent1.convertToDER()),e.push(this.exponent2.convertToDER()),e.push(this.coefficient.convertToDER()),"otherPrimeInfos"in this&&e.push(new s.Sequence({value:Array.from(this.otherPrimeInfos,e=>e.toSchema())})),new s.Sequence({value:e})}toJSON(){const e={n:(0,i.toBase64)((0,i.arrayBufferToString)(this.modulus.valueBlock.valueHex),!0,!0,!0),e:(0,i.toBase64)((0,i.arrayBufferToString)(this.publicExponent.valueBlock.valueHex),!0,!0,!0),d:(0,i.toBase64)((0,i.arrayBufferToString)(this.privateExponent.valueBlock.valueHex),!0,!0,!0),p:(0,i.toBase64)((0,i.arrayBufferToString)(this.prime1.valueBlock.valueHex),!0,!0,!0),q:(0,i.toBase64)((0,i.arrayBufferToString)(this.prime2.valueBlock.valueHex),!0,!0,!0),dp:(0,i.toBase64)((0,i.arrayBufferToString)(this.exponent1.valueBlock.valueHex),!0,!0,!0),dq:(0,i.toBase64)((0,i.arrayBufferToString)(this.exponent2.valueBlock.valueHex),!0,!0,!0),qi:(0,i.toBase64)((0,i.arrayBufferToString)(this.coefficient.valueBlock.valueHex),!0,!0,!0)};return"otherPrimeInfos"in this&&(e.oth=Array.from(this.otherPrimeInfos,e=>e.toJSON())),e}fromJSON(e){if(!("n"in e))throw new Error('Absent mandatory parameter "n"');if(this.modulus=new s.Integer({valueHex:(0,i.stringToArrayBuffer)((0,i.fromBase64)(e.n,!0,!0))}),!("e"in e))throw new Error('Absent mandatory parameter "e"');if(this.publicExponent=new s.Integer({valueHex:(0,i.stringToArrayBuffer)((0,i.fromBase64)(e.e,!0,!0))}),!("d"in e))throw new Error('Absent mandatory parameter "d"');if(this.privateExponent=new s.Integer({valueHex:(0,i.stringToArrayBuffer)((0,i.fromBase64)(e.d,!0,!0))}),!("p"in e))throw new Error('Absent mandatory parameter "p"');if(this.prime1=new s.Integer({valueHex:(0,i.stringToArrayBuffer)((0,i.fromBase64)(e.p,!0,!0))}),!("q"in e))throw new Error('Absent mandatory parameter "q"');if(this.prime2=new s.Integer({valueHex:(0,i.stringToArrayBuffer)((0,i.fromBase64)(e.q,!0,!0))}),!("dp"in e))throw new Error('Absent mandatory parameter "dp"');if(this.exponent1=new s.Integer({valueHex:(0,i.stringToArrayBuffer)((0,i.fromBase64)(e.dp,!0,!0))}),!("dq"in e))throw new Error('Absent mandatory parameter "dq"');if(this.exponent2=new s.Integer({valueHex:(0,i.stringToArrayBuffer)((0,i.fromBase64)(e.dq,!0,!0))}),!("qi"in e))throw new Error('Absent mandatory parameter "qi"');this.coefficient=new s.Integer({valueHex:(0,i.stringToArrayBuffer)((0,i.fromBase64)(e.qi,!0,!0))}),"oth"in e&&(this.otherPrimeInfos=Array.from(e.oth,e=>new n.default({json:e})))}}t.default=o},"3vEk":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09"),i=A(r("B4i1")),n=A(r("SInf")),o=A(r("26BL")),u=A(r("mfyR")),l=A(r("t7E/")),c=A(r("8VQD")),m=A(r("Nefp")),h=A(r("DCxM")),f=A(r("ZFiR")),d=A(r("yxVI")),p=A(r("Gf0/")),g=A(r("kVyt")),y=A(r("HK8C")),b=A(r("yfdt")),v=A(r("7FOr")),w=A(r("fC9T")),P=A(r("ZuMJ")),S=A(r("pZts"));function A(e){return e&&e.__esModule?e:{default:e}}class C{constructor(e={}){this.extnID=(0,s.getParametersValue)(e,"extnID",C.defaultValues("extnID")),this.critical=(0,s.getParametersValue)(e,"critical",C.defaultValues("critical")),this.extnValue="extnValue"in e?new a.OctetString({valueHex:e.extnValue}):C.defaultValues("extnValue"),"parsedValue"in e&&(this.parsedValue=(0,s.getParametersValue)(e,"parsedValue",C.defaultValues("parsedValue"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"extnID":return"";case"critical":return!1;case"extnValue":return new a.OctetString;case"parsedValue":return{};default:throw new Error(`Invalid member name for Extension class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.ObjectIdentifier({name:t.extnID||""}),new a.Boolean({name:t.critical||"",optional:!0}),new a.OctetString({name:t.extnValue||""})]})}fromSchema(e){(0,s.clearProps)(e,["extnID","critical","extnValue"]);let t=a.compareSchema(e,e,C.schema({names:{extnID:"extnID",critical:"critical",extnValue:"extnValue"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Extension");if(this.extnID=t.result.extnID.valueBlock.toString(),"critical"in t.result&&(this.critical=t.result.critical.valueBlock.value),this.extnValue=t.result.extnValue,t=a.fromBER(this.extnValue.valueBlock.valueHex),-1!==t.offset)switch(this.extnID){case"2.5.29.9":try{this.parsedValue=new i.default({schema:t.result})}catch(r){this.parsedValue=new i.default,this.parsedValue.parsingError="Incorrectly formated SubjectDirectoryAttributes"}break;case"2.5.29.14":case"2.5.29.15":this.parsedValue=t.result;break;case"2.5.29.16":try{this.parsedValue=new n.default({schema:t.result})}catch(r){this.parsedValue=new n.default,this.parsedValue.parsingError="Incorrectly formated PrivateKeyUsagePeriod"}break;case"2.5.29.17":case"2.5.29.18":try{this.parsedValue=new o.default({schema:t.result})}catch(r){this.parsedValue=new o.default,this.parsedValue.parsingError="Incorrectly formated AltName"}break;case"2.5.29.19":try{this.parsedValue=new u.default({schema:t.result})}catch(r){this.parsedValue=new u.default,this.parsedValue.parsingError="Incorrectly formated BasicConstraints"}break;case"2.5.29.20":case"2.5.29.27":case"2.5.29.21":case"2.5.29.24":this.parsedValue=t.result;break;case"2.5.29.28":try{this.parsedValue=new l.default({schema:t.result})}catch(r){this.parsedValue=new l.default,this.parsedValue.parsingError="Incorrectly formated IssuingDistributionPoint"}break;case"2.5.29.29":try{this.parsedValue=new c.default({schema:t.result})}catch(r){this.parsedValue=new c.default,this.parsedValue.parsingError="Incorrectly formated GeneralNames"}break;case"2.5.29.30":try{this.parsedValue=new m.default({schema:t.result})}catch(r){this.parsedValue=new m.default,this.parsedValue.parsingError="Incorrectly formated NameConstraints"}break;case"2.5.29.31":case"2.5.29.46":try{this.parsedValue=new h.default({schema:t.result})}catch(r){this.parsedValue=new h.default,this.parsedValue.parsingError="Incorrectly formated CRLDistributionPoints"}break;case"2.5.29.32":case"1.3.6.1.4.1.311.21.10":try{this.parsedValue=new f.default({schema:t.result})}catch(r){this.parsedValue=new f.default,this.parsedValue.parsingError="Incorrectly formated CertificatePolicies"}break;case"2.5.29.33":try{this.parsedValue=new d.default({schema:t.result})}catch(r){this.parsedValue=new d.default,this.parsedValue.parsingError="Incorrectly formated CertificatePolicies"}break;case"2.5.29.35":try{this.parsedValue=new p.default({schema:t.result})}catch(r){this.parsedValue=new p.default,this.parsedValue.parsingError="Incorrectly formated AuthorityKeyIdentifier"}break;case"2.5.29.36":try{this.parsedValue=new g.default({schema:t.result})}catch(r){this.parsedValue=new g.default,this.parsedValue.parsingError="Incorrectly formated PolicyConstraints"}break;case"2.5.29.37":try{this.parsedValue=new y.default({schema:t.result})}catch(r){this.parsedValue=new y.default,this.parsedValue.parsingError="Incorrectly formated ExtKeyUsage"}break;case"2.5.29.54":this.parsedValue=t.result;break;case"1.3.6.1.5.5.7.1.1":case"1.3.6.1.5.5.7.1.11":try{this.parsedValue=new b.default({schema:t.result})}catch(r){this.parsedValue=new b.default,this.parsedValue.parsingError="Incorrectly formated InfoAccess"}break;case"1.3.6.1.4.1.11129.2.4.2":try{this.parsedValue=new v.default({schema:t.result})}catch(r){this.parsedValue=new v.default,this.parsedValue.parsingError="Incorrectly formated SignedCertificateTimestampList"}break;case"1.3.6.1.4.1.311.20.2":case"1.3.6.1.4.1.311.21.2":this.parsedValue=t.result;break;case"1.3.6.1.4.1.311.21.7":try{this.parsedValue=new w.default({schema:t.result})}catch(r){this.parsedValue=new w.default,this.parsedValue.parsingError="Incorrectly formated CertificateTemplate"}break;case"1.3.6.1.4.1.311.21.1":try{this.parsedValue=new P.default({schema:t.result})}catch(r){this.parsedValue=new P.default,this.parsedValue.parsingError="Incorrectly formated CAVersion"}break;case"1.3.6.1.5.5.7.1.3":try{this.parsedValue=new S.default({schema:t.result})}catch(r){this.parsedValue=new S.default,this.parsedValue.parsingError="Incorrectly formated QCStatements"}}}toSchema(){const e=[];return e.push(new a.ObjectIdentifier({value:this.extnID})),this.critical!==C.defaultValues("critical")&&e.push(new a.Boolean({value:this.critical})),e.push(this.extnValue),new a.Sequence({value:e})}toJSON(){const e={extnID:this.extnID,extnValue:this.extnValue.toJSON()};return this.critical!==C.defaultValues("critical")&&(e.critical=this.critical),"parsedValue"in this&&"toJSON"in this.parsedValue&&(e.parsedValue=this.parsedValue.toJSON()),e}}t.default=C},"4uRB":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("px0U"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.keyDerivationFunc=(0,i.getParametersValue)(e,"keyDerivationFunc",o.defaultValues("keyDerivationFunc")),this.encryptionScheme=(0,i.getParametersValue)(e,"encryptionScheme",o.defaultValues("encryptionScheme")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"keyDerivationFunc":case"encryptionScheme":return new n.default;default:throw new Error(`Invalid member name for PBES2Params class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[n.default.schema(t.keyDerivationFunc||{}),n.default.schema(t.encryptionScheme||{})]})}fromSchema(e){(0,i.clearProps)(e,["keyDerivationFunc","encryptionScheme"]);const t=s.compareSchema(e,e,o.schema({names:{keyDerivationFunc:{names:{blockName:"keyDerivationFunc"}},encryptionScheme:{names:{blockName:"encryptionScheme"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PBES2Params");this.keyDerivationFunc=new n.default({schema:t.result.keyDerivationFunc}),this.encryptionScheme=new n.default({schema:t.result.encryptionScheme})}toSchema(){return new s.Sequence({value:[this.keyDerivationFunc.toSchema(),this.encryptionScheme.toSchema()]})}toJSON(){return{keyDerivationFunc:this.keyDerivationFunc.toJSON(),encryptionScheme:this.encryptionScheme.toJSON()}}}t.default=o},"5v3g":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("K3UR"))&&a.__esModule?a:{default:a};function o(e={},t=!1){const r=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({optional:t,value:[new s.Constructed({optional:!0,idBlock:{tagClass:2,tagNumber:1},name:r.country_name||"",value:[new s.Choice({value:[new s.NumericString,new s.PrintableString]})]}),new s.Constructed({optional:!0,idBlock:{tagClass:2,tagNumber:2},name:r.administration_domain_name||"",value:[new s.Choice({value:[new s.NumericString,new s.PrintableString]})]}),new s.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:0},name:r.network_address||"",isHexOnly:!0}),new s.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:1},name:r.terminal_identifier||"",isHexOnly:!0}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:2},name:r.private_domain_name||"",value:[new s.Choice({value:[new s.NumericString,new s.PrintableString]})]}),new s.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:3},name:r.organization_name||"",isHexOnly:!0}),new s.Primitive({optional:!0,name:r.numeric_user_identifier||"",idBlock:{tagClass:3,tagNumber:4},isHexOnly:!0}),new s.Constructed({optional:!0,name:r.personal_name||"",idBlock:{tagClass:3,tagNumber:5},value:[new s.Primitive({idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new s.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:1},isHexOnly:!0}),new s.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:2},isHexOnly:!0}),new s.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:3},isHexOnly:!0})]}),new s.Constructed({optional:!0,name:r.organizational_unit_names||"",idBlock:{tagClass:3,tagNumber:6},value:[new s.Repeated({value:new s.PrintableString})]})]})}function u(e=!1){return new s.Sequence({optional:e,value:[new s.PrintableString,new s.PrintableString]})}function l(e=!1){return new s.Set({optional:e,value:[new s.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.Any]})]})}class c{constructor(e={}){this.type=(0,i.getParametersValue)(e,"type",c.defaultValues("type")),this.value=(0,i.getParametersValue)(e,"value",c.defaultValues("value")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return 9;case"value":return{};default:throw new Error(`Invalid member name for GeneralName class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"type":return t===c.defaultValues(e);case"value":return 0===Object.keys(t).length;default:throw new Error(`Invalid member name for GeneralName class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Choice({value:[new s.Constructed({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||"",value:[new s.ObjectIdentifier,new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new s.Any]})]}),new s.Primitive({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:1}}),new s.Primitive({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:2}}),new s.Constructed({idBlock:{tagClass:3,tagNumber:3},name:t.blockName||"",value:[o(t.builtInStandardAttributes||{},!1),u(!0),l(!0)]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:4},name:t.blockName||"",value:[n.default.schema(t.directoryName||{})]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:5},name:t.blockName||"",value:[new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Choice({value:[new s.TeletexString,new s.PrintableString,new s.UniversalString,new s.Utf8String,new s.BmpString]})]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[new s.Choice({value:[new s.TeletexString,new s.PrintableString,new s.UniversalString,new s.Utf8String,new s.BmpString]})]})]}),new s.Primitive({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:6}}),new s.Primitive({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:7}}),new s.Primitive({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:8}})]})}fromSchema(e){(0,i.clearProps)(e,["blockName","otherName","rfc822Name","dNSName","x400Address","directoryName","ediPartyName","uniformResourceIdentifier","iPAddress","registeredID"]);const t=s.compareSchema(e,e,c.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for GeneralName");switch(this.type=t.result.blockName.idBlock.tagNumber,this.type){case 0:this.value=t.result.blockName;break;case 1:case 2:case 6:{const e=t.result.blockName;e.idBlock.tagClass=1,e.idBlock.tagNumber=22;const r=e.toBER(!1);this.value=s.fromBER(r).result.valueBlock.value}break;case 3:this.value=t.result.blockName;break;case 4:this.value=new n.default({schema:t.result.directoryName});break;case 5:this.value=t.result.ediPartyName;break;case 7:this.value=new s.OctetString({valueHex:t.result.blockName.valueBlock.valueHex});break;case 8:{const e=t.result.blockName;e.idBlock.tagClass=1,e.idBlock.tagNumber=6;const r=e.toBER(!1);this.value=s.fromBER(r).result.valueBlock.toString()}}}toSchema(){switch(this.type){case 0:case 3:case 5:return new s.Constructed({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:{const e=new s.IA5String({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 4:return new s.Constructed({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:{const e=this.value;return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 8:{const e=new s.ObjectIdentifier({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}default:return c.schema()}}toJSON(){const e={type:this.type,value:""};if("string"===typeof this.value)e.value=this.value;else try{e.value=this.value.toJSON()}catch(t){}return e}}t.default=c},"6kh4":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09"),i=r("UM/M"),n=h(r("px0U")),o=h(r("K3UR")),u=h(r("Iued")),l=h(r("tZ8Z")),c=h(r("3vEk")),m=h(r("aFlX"));function h(e){return e&&e.__esModule?e:{default:e}}function f(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"tbsCertificate",value:[new a.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new a.Integer({name:t.tbsCertificateVersion||"tbsCertificate.version"})]}),new a.Integer({name:t.tbsCertificateSerialNumber||"tbsCertificate.serialNumber"}),n.default.schema(t.signature||{names:{blockName:"tbsCertificate.signature"}}),o.default.schema(t.issuer||{names:{blockName:"tbsCertificate.issuer"}}),new a.Sequence({name:t.tbsCertificateValidity||"tbsCertificate.validity",value:[u.default.schema(t.notBefore||{names:{utcTimeName:"tbsCertificate.notBefore",generalTimeName:"tbsCertificate.notBefore"}}),u.default.schema(t.notAfter||{names:{utcTimeName:"tbsCertificate.notAfter",generalTimeName:"tbsCertificate.notAfter"}})]}),o.default.schema(t.subject||{names:{blockName:"tbsCertificate.subject"}}),l.default.schema(t.subjectPublicKeyInfo||{names:{blockName:"tbsCertificate.subjectPublicKeyInfo"}}),new a.Primitive({name:t.tbsCertificateIssuerUniqueID||"tbsCertificate.issuerUniqueID",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new a.Primitive({name:t.tbsCertificateSubjectUniqueID||"tbsCertificate.subjectUniqueID",optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new a.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[m.default.schema(t.extensions||{names:{blockName:"tbsCertificate.extensions"}})]})]})}class d{constructor(e={}){this.tbs=(0,s.getParametersValue)(e,"tbs",d.defaultValues("tbs")),this.version=(0,s.getParametersValue)(e,"version",d.defaultValues("version")),this.serialNumber=(0,s.getParametersValue)(e,"serialNumber",d.defaultValues("serialNumber")),this.signature=(0,s.getParametersValue)(e,"signature",d.defaultValues("signature")),this.issuer=(0,s.getParametersValue)(e,"issuer",d.defaultValues("issuer")),this.notBefore=(0,s.getParametersValue)(e,"notBefore",d.defaultValues("notBefore")),this.notAfter=(0,s.getParametersValue)(e,"notAfter",d.defaultValues("notAfter")),this.subject=(0,s.getParametersValue)(e,"subject",d.defaultValues("subject")),this.subjectPublicKeyInfo=(0,s.getParametersValue)(e,"subjectPublicKeyInfo",d.defaultValues("subjectPublicKeyInfo")),"issuerUniqueID"in e&&(this.issuerUniqueID=(0,s.getParametersValue)(e,"issuerUniqueID",d.defaultValues("issuerUniqueID"))),"subjectUniqueID"in e&&(this.subjectUniqueID=(0,s.getParametersValue)(e,"subjectUniqueID",d.defaultValues("subjectUniqueID"))),"extensions"in e&&(this.extensions=(0,s.getParametersValue)(e,"extensions",d.defaultValues("extensions"))),this.signatureAlgorithm=(0,s.getParametersValue)(e,"signatureAlgorithm",d.defaultValues("signatureAlgorithm")),this.signatureValue=(0,s.getParametersValue)(e,"signatureValue",d.defaultValues("signatureValue")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return new ArrayBuffer(0);case"version":return 0;case"serialNumber":return new a.Integer;case"signature":return new n.default;case"issuer":return new o.default;case"notBefore":case"notAfter":return new u.default;case"subject":return new o.default;case"subjectPublicKeyInfo":return new l.default;case"issuerUniqueID":case"subjectUniqueID":return new ArrayBuffer(0);case"extensions":return[];case"signatureAlgorithm":return new n.default;case"signatureValue":return new a.BitString;default:throw new Error(`Invalid member name for Certificate class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[f(t.tbsCertificate),n.default.schema(t.signatureAlgorithm||{names:{blockName:"signatureAlgorithm"}}),new a.BitString({name:t.signatureValue||"signatureValue"})]})}fromSchema(e){(0,s.clearProps)(e,["tbsCertificate","tbsCertificate.extensions","tbsCertificate.version","tbsCertificate.serialNumber","tbsCertificate.signature","tbsCertificate.issuer","tbsCertificate.notBefore","tbsCertificate.notAfter","tbsCertificate.subject","tbsCertificate.subjectPublicKeyInfo","tbsCertificate.issuerUniqueID","tbsCertificate.subjectUniqueID","signatureAlgorithm","signatureValue"]);const t=a.compareSchema(e,e,d.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:"tbsCertificate.extensions"}}}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Certificate");this.tbs=t.result.tbsCertificate.valueBeforeDecode,"tbsCertificate.version"in t.result&&(this.version=t.result["tbsCertificate.version"].valueBlock.valueDec),this.serialNumber=t.result["tbsCertificate.serialNumber"],this.signature=new n.default({schema:t.result["tbsCertificate.signature"]}),this.issuer=new o.default({schema:t.result["tbsCertificate.issuer"]}),this.notBefore=new u.default({schema:t.result["tbsCertificate.notBefore"]}),this.notAfter=new u.default({schema:t.result["tbsCertificate.notAfter"]}),this.subject=new o.default({schema:t.result["tbsCertificate.subject"]}),this.subjectPublicKeyInfo=new l.default({schema:t.result["tbsCertificate.subjectPublicKeyInfo"]}),"tbsCertificate.issuerUniqueID"in t.result&&(this.issuerUniqueID=t.result["tbsCertificate.issuerUniqueID"].valueBlock.valueHex),"tbsCertificate.subjectUniqueID"in t.result&&(this.subjectUniqueID=t.result["tbsCertificate.subjectUniqueID"].valueBlock.valueHex),"tbsCertificate.extensions"in t.result&&(this.extensions=Array.from(t.result["tbsCertificate.extensions"],e=>new c.default({schema:e}))),this.signatureAlgorithm=new n.default({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return"version"in this&&this.version!==d.defaultValues("version")&&e.push(new a.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new a.Integer({value:this.version})]})),e.push(this.serialNumber),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(new a.Sequence({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),e.push(this.subject.toSchema()),e.push(this.subjectPublicKeyInfo.toSchema()),"issuerUniqueID"in this&&e.push(new a.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID})),"subjectUniqueID"in this&&e.push(new a.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID})),"extensions"in this&&e.push(new a.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[new a.Sequence({value:Array.from(this.extensions,e=>e.toSchema())})]})),new a.Sequence({value:e})}toSchema(e=!1){let t={};if(!1===e){if(0===this.tbs.length)return d.schema().value[0];t=a.fromBER(this.tbs).result}else t=this.encodeTBS();return new a.Sequence({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:(0,s.bufferToHexCodes)(this.tbs,0,this.tbs.byteLength),serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return"version"in this&&this.version!==d.defaultValues("version")&&(e.version=this.version),"issuerUniqueID"in this&&(e.issuerUniqueID=(0,s.bufferToHexCodes)(this.issuerUniqueID,0,this.issuerUniqueID.byteLength)),"subjectUniqueID"in this&&(e.subjectUniqueID=(0,s.bufferToHexCodes)(this.subjectUniqueID,0,this.subjectUniqueID.byteLength)),"extensions"in this&&(e.extensions=Array.from(this.extensions,e=>e.toJSON())),e}getPublicKey(e=null){return(0,i.getEngine)().subtle.getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,e)}getKeyHash(e="SHA-1"){const t=(0,i.getCrypto)();return"undefined"===typeof t?Promise.reject("Unable to create WebCrypto object"):t.digest({name:e},new Uint8Array(this.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex))}sign(e,t="SHA-1"){if("undefined"===typeof e)return Promise.reject("Need to provide a private key for signing");let r,s=Promise.resolve();const n=(0,i.getEngine)();return s=s.then(()=>n.subtle.getSignatureParameters(e,t)),s=s.then(e=>{r=e.parameters,this.signature=e.signatureAlgorithm,this.signatureAlgorithm=e.signatureAlgorithm}),s=s.then(()=>{this.tbs=this.encodeTBS().toBER(!1)}),s=s.then(()=>n.subtle.signWithPrivateKey(this.tbs,e,r)),s=s.then(e=>{this.signatureValue=new a.BitString({valueHex:e})}),s}verify(e=null){let t={};return null!==e?t=e.subjectPublicKeyInfo:this.issuer.isEqual(this.subject)&&(t=this.subjectPublicKeyInfo),t instanceof l.default===!1?Promise.reject("Please provide issuer certificate as a parameter"):(0,i.getEngine)().subtle.verifyWithPublicKey(this.tbs,this.signatureValue,t,this.signatureAlgorithm)}}t.default=d},"6rMh":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("5v3g"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.base=(0,i.getParametersValue)(e,"base",o.defaultValues("base")),this.minimum=(0,i.getParametersValue)(e,"minimum",o.defaultValues("minimum")),"maximum"in e&&(this.maximum=(0,i.getParametersValue)(e,"maximum",o.defaultValues("maximum"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"base":return new n.default;case"minimum":case"maximum":return 0;default:throw new Error(`Invalid member name for GeneralSubtree class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[n.default.schema(t.base||{}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Integer({name:t.minimum||""})]}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.Integer({name:t.maximum||""})]})]})}fromSchema(e){(0,i.clearProps)(e,["base","minimum","maximum"]);const t=s.compareSchema(e,e,o.schema({names:{base:{names:{blockName:"base"}},minimum:"minimum",maximum:"maximum"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for GeneralSubtree");this.base=new n.default({schema:t.result.base}),"minimum"in t.result&&(t.result.minimum.valueBlock.isHexOnly?this.minimum=t.result.minimum:this.minimum=t.result.minimum.valueBlock.valueDec),"maximum"in t.result&&(t.result.maximum.valueBlock.isHexOnly?this.maximum=t.result.maximum:this.maximum=t.result.maximum.valueBlock.valueDec)}toSchema(){const e=[];if(e.push(this.base.toSchema()),0!==this.minimum){let t=0;t=this.minimum instanceof s.Integer?this.minimum:new s.Integer({value:this.minimum}),e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if("maximum"in this){let t=0;t=this.maximum instanceof s.Integer?this.maximum:new s.Integer({value:this.maximum}),e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[t]}))}return new s.Sequence({value:e})}toJSON(){const e={base:this.base.toJSON()};return 0!==this.minimum&&("number"===typeof this.minimum?e.minimum=this.minimum:e.minimum=this.minimum.toJSON()),"maximum"in this&&("number"===typeof this.maximum?e.maximum=this.maximum:e.maximum=this.maximum.toJSON()),e}}t.default=o},"7FOr":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifySCTsForCertificate=function(e,t,r){return f.apply(this,arguments)},t.default=t.SignedCertificateTimestamp=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=r("DtSX"),o=r("UM/M"),u=(a=r("tZ8Z"))&&a.__esModule?a:{default:a};function l(e,t,r,a,s,i,n){try{var o=e[i](n),u=o.value}catch(l){return void r(l)}o.done?t(u):Promise.resolve(u).then(a,s)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(a,s){var i=e.apply(t,r);function n(e){l(i,a,s,n,o,"next",e)}function o(e){l(i,a,s,n,o,"throw",e)}n(void 0)}))}}class m{constructor(e={}){this.version=(0,i.getParametersValue)(e,"version",m.defaultValues("version")),this.logID=(0,i.getParametersValue)(e,"logID",m.defaultValues("logID")),this.timestamp=(0,i.getParametersValue)(e,"timestamp",m.defaultValues("timestamp")),this.extensions=(0,i.getParametersValue)(e,"extensions",m.defaultValues("extensions")),this.hashAlgorithm=(0,i.getParametersValue)(e,"hashAlgorithm",m.defaultValues("hashAlgorithm")),this.signatureAlgorithm=(0,i.getParametersValue)(e,"signatureAlgorithm",m.defaultValues("signatureAlgorithm")),this.signature=(0,i.getParametersValue)(e,"signature",m.defaultValues("signature")),"schema"in e&&this.fromSchema(e.schema),"stream"in e&&this.fromStream(e.stream)}static defaultValues(e){switch(e){case"version":return 0;case"logID":case"extensions":return new ArrayBuffer(0);case"timestamp":return new Date(0);case"hashAlgorithm":case"signatureAlgorithm":return"";case"signature":return new s.Any;default:throw new Error(`Invalid member name for SignedCertificateTimestamp class: ${e}`)}}fromSchema(e){if(e instanceof s.RawData===!1)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestamp");const t=new n.SeqStream({stream:new n.ByteStream({buffer:e.data})});this.fromStream(t)}fromStream(e){const t=e.getUint16();if(this.version=e.getBlock(1)[0],0===this.version){this.logID=new Uint8Array(e.getBlock(32)).buffer.slice(0),this.timestamp=new Date((0,i.utilFromBase)(new Uint8Array(e.getBlock(8)),8));const r=e.getUint16();switch(this.extensions=new Uint8Array(e.getBlock(r)).buffer.slice(0),e.getBlock(1)[0]){case 0:this.hashAlgorithm="none";break;case 1:this.hashAlgorithm="md5";break;case 2:this.hashAlgorithm="sha1";break;case 3:this.hashAlgorithm="sha224";break;case 4:this.hashAlgorithm="sha256";break;case 5:this.hashAlgorithm="sha384";break;case 6:this.hashAlgorithm="sha512";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}switch(e.getBlock(1)[0]){case 0:this.signatureAlgorithm="anonymous";break;case 1:this.signatureAlgorithm="rsa";break;case 2:this.signatureAlgorithm="dsa";break;case 3:this.signatureAlgorithm="ecdsa";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}const a=e.getUint16(),n=new Uint8Array(e.getBlock(a)).buffer.slice(0),o=s.fromBER(n);if(-1===o.offset)throw new Error("Object's stream was not correct for SignedCertificateTimestamp");if(this.signature=o.result,t!==47+r+a)throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}}toSchema(){const e=this.toStream();return new s.RawData({data:e.stream.buffer})}toStream(){const e=new n.SeqStream;e.appendUint16(47+this.extensions.byteLength+this.signature.valueBeforeDecode.byteLength),e.appendChar(this.version),e.appendView(new Uint8Array(this.logID));const t=new ArrayBuffer(8),r=new Uint8Array(t),a=(0,i.utilToBase)(this.timestamp.valueOf(),8);let s,o;switch(r.set(new Uint8Array(a),8-a.byteLength),e.appendView(r),e.appendUint16(this.extensions.byteLength),this.extensions.byteLength&&e.appendView(new Uint8Array(this.extensions)),this.hashAlgorithm.toLowerCase()){case"none":s=0;break;case"md5":s=1;break;case"sha1":s=2;break;case"sha224":s=3;break;case"sha256":s=4;break;case"sha384":s=5;break;case"sha512":s=6;break;default:throw new Error(`Incorrect data for hashAlgorithm: ${this.hashAlgorithm}`)}switch(e.appendChar(s),this.signatureAlgorithm.toLowerCase()){case"anonymous":o=0;break;case"rsa":o=1;break;case"dsa":o=2;break;case"ecdsa":o=3;break;default:throw new Error(`Incorrect data for signatureAlgorithm: ${this.signatureAlgorithm}`)}e.appendChar(o);const u=this.signature.toBER(!1);return e.appendUint16(u.byteLength),e.appendView(new Uint8Array(u)),e}toJSON(){return{version:this.version,logID:(0,i.bufferToHexCodes)(this.logID),timestamp:this.timestamp,extensions:(0,i.bufferToHexCodes)(this.extensions),hashAlgorithm:this.hashAlgorithm,signatureAlgorithm:this.signatureAlgorithm,signature:this.signature.toJSON()}}verify(e,t,r=0){var a=this;return c((function*(){let l,c=(0,i.toBase64)((0,i.arrayBufferToString)(a.logID)),m=null,h=new n.SeqStream;var f=!0,d=!1,p=void 0;try{for(var g,y=e[Symbol.iterator]();!(f=(g=y.next()).done);f=!0){const e=g.value;if(e.log_id===c){m=e.key;break}}}catch(S){d=!0,p=S}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}if(null===m)throw new Error(`Public key not found for CT with logId: ${c}`);const b=s.fromBER((0,i.stringToArrayBuffer)((0,i.fromBase64)(m)));if(-1===b.offset)throw new Error(`Incorrect key value for CT Log with logId: ${c}`);l=new u.default({schema:b.result}),h.appendChar(0),h.appendChar(0);const v=new ArrayBuffer(8),w=new Uint8Array(v),P=(0,i.utilToBase)(a.timestamp.valueOf(),8);return w.set(new Uint8Array(P),8-P.byteLength),h.appendView(w),h.appendUint16(r),0===r&&h.appendUint24(t.byteLength),h.appendView(new Uint8Array(t)),h.appendUint16(a.extensions.byteLength),0!==a.extensions.byteLength&&h.appendView(new Uint8Array(a.extensions)),(0,o.getEngine)().subtle.verifyWithPublicKey(h._stream._buffer.slice(0,h._length),{valueBlock:{valueHex:a.signature.toBER(!1)}},l,{algorithmId:""},"SHA-256")}))()}}t.SignedCertificateTimestamp=m;class h{constructor(e={}){this.timestamps=(0,i.getParametersValue)(e,"timestamps",h.defaultValues("timestamps")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"timestamps":return[];default:throw new Error(`Invalid member name for SignedCertificateTimestampList class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"timestamps":return 0===t.length;default:throw new Error(`Invalid member name for SignedCertificateTimestampList class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return"optional"in t===!1&&(t.optional=!1),new s.OctetString({name:t.blockName||"SignedCertificateTimestampList",optional:t.optional})}fromSchema(e){if(e instanceof s.OctetString===!1)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");const t=new n.SeqStream({stream:new n.ByteStream({buffer:e.valueBlock.valueHex})});if(t.getUint16()!==t.length)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");for(;t.length;)this.timestamps.push(new m({stream:t}))}toSchema(){const e=new n.SeqStream;let t=0;const r=[];var a=!0,i=!1,o=void 0;try{for(var u,l=this.timestamps[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){const e=u.value.toStream();r.push(e),t+=e.stream.buffer.byteLength}}catch(h){i=!0,o=h}finally{try{a||null==l.return||l.return()}finally{if(i)throw o}}e.appendUint16(t);for(var c=0,m=r;c<m.length;c++){const t=m[c];e.appendView(t.stream.view)}return new s.OctetString({valueHex:e.stream.buffer.slice(0)})}toJSON(){return{timestamps:Array.from(this.timestamps,e=>e.toJSON())}}}function f(){return(f=c((function*(e,t,r,a=-1){let s,i,u=null;const l=new n.SeqStream;let c;const m=(0,o.getCrypto)();if("undefined"===typeof m)return Promise.reject("Unable to create WebCrypto object");for(let n=0;n<e.extensions.length;n++)switch(e.extensions[n].extnID){case"1.3.6.1.4.1.11129.2.4.2":if(u=e.extensions[n].parsedValue,0===u.timestamps.length)throw new Error("Nothing to verify in the certificate");e.extensions.splice(n,1)}if(null===u)throw new Error("No SignedCertificateTimestampList extension in the specified certificate");if(s=e.encodeTBS().toBER(!1),i=yield m.digest({name:"SHA-256"},new Uint8Array(t.subjectPublicKeyInfo.toSchema().toBER(!1))),l.appendView(new Uint8Array(i)),l.appendUint24(s.byteLength),l.appendView(new Uint8Array(s)),c=l._stream._buffer.slice(0,l._length),-1===a){const e=[];var h=!0,f=!1,d=void 0;try{for(var p,g=u.timestamps[Symbol.iterator]();!(h=(p=g.next()).done);h=!0){const t=p.value,a=yield t.verify(r,c,1);e.push(a)}}catch(y){f=!0,d=y}finally{try{h||null==g.return||g.return()}finally{if(f)throw d}}return e}return a>=u.timestamps.length&&(a=u.timestamps.length-1),[yield u.timestamps[a].verify(r,c,1)]}))).apply(this,arguments)}t.default=h},"87r+":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("5v3g"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.accessMethod=(0,i.getParametersValue)(e,"accessMethod",o.defaultValues("accessMethod")),this.accessLocation=(0,i.getParametersValue)(e,"accessLocation",o.defaultValues("accessLocation")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"accessMethod":return"";case"accessLocation":return new n.default;default:throw new Error(`Invalid member name for AccessDescription class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.ObjectIdentifier({name:t.accessMethod||""}),n.default.schema(t.accessLocation||{})]})}fromSchema(e){(0,i.clearProps)(e,["accessMethod","accessLocation"]);const t=s.compareSchema(e,e,o.schema({names:{accessMethod:"accessMethod",accessLocation:{names:{blockName:"accessLocation"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AccessDescription");this.accessMethod=t.result.accessMethod.valueBlock.toString(),this.accessLocation=new n.default({schema:t.result.accessLocation})}toSchema(){return new s.Sequence({value:[new s.ObjectIdentifier({value:this.accessMethod}),this.accessLocation.toSchema()]})}toJSON(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}t.default=o},"8VQD":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("5v3g"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.names=(0,i.getParametersValue)(e,"names",o.defaultValues("names")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"names":return[];default:throw new Error(`Invalid member name for GeneralNames class: ${e}`)}}static schema(e={},t=!1){const r=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({optional:t,name:r.blockName||"",value:[new s.Repeated({name:r.generalNames||"",value:n.default.schema()})]})}fromSchema(e){(0,i.clearProps)(e,["names","generalNames"]);const t=s.compareSchema(e,e,o.schema({names:{blockName:"names",generalNames:"generalNames"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for GeneralNames");this.names=Array.from(t.result.generalNames,e=>new n.default({schema:e}))}toSchema(){return new s.Sequence({value:Array.from(this.names,e=>e.toSchema())})}toJSON(){return{names:Array.from(this.names,e=>e.toJSON())}}}t.default=o},B4i1:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("gilY"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.attributes=(0,i.getParametersValue)(e,"attributes",o.defaultValues("attributes")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"attributes":return[];default:throw new Error(`Invalid member name for SubjectDirectoryAttributes class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.attributes||"",value:n.default.schema()})]})}fromSchema(e){(0,i.clearProps)(e,["attributes"]);const t=s.compareSchema(e,e,o.schema({names:{attributes:"attributes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for SubjectDirectoryAttributes");this.attributes=Array.from(t.result.attributes,e=>new n.default({schema:e}))}toSchema(){return new s.Sequence({value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){return{attributes:Array.from(this.attributes,e=>e.toJSON())}}}t.default=o},DCxM:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("MgLg"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.distributionPoints=(0,i.getParametersValue)(e,"distributionPoints",o.defaultValues("distributionPoints")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"distributionPoints":return[];default:throw new Error(`Invalid member name for CRLDistributionPoints class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.distributionPoints||"",value:n.default.schema()})]})}fromSchema(e){(0,i.clearProps)(e,["distributionPoints"]);const t=s.compareSchema(e,e,o.schema({names:{distributionPoints:"distributionPoints"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CRLDistributionPoints");this.distributionPoints=Array.from(t.result.distributionPoints,e=>new n.default({schema:e}))}toSchema(){return new s.Sequence({value:Array.from(this.distributionPoints,e=>e.toSchema())})}toJSON(){return{distributionPoints:Array.from(this.distributionPoints,e=>e.toJSON())}}}t.default=o},DFRD:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("TI6k"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.policyIdentifier=(0,i.getParametersValue)(e,"policyIdentifier",o.defaultValues("policyIdentifier")),"policyQualifiers"in e&&(this.policyQualifiers=(0,i.getParametersValue)(e,"policyQualifiers",o.defaultValues("policyQualifiers"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"policyIdentifier":return"";case"policyQualifiers":return[];default:throw new Error(`Invalid member name for PolicyInformation class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.ObjectIdentifier({name:t.policyIdentifier||""}),new s.Sequence({optional:!0,value:[new s.Repeated({name:t.policyQualifiers||"",value:n.default.schema()})]})]})}fromSchema(e){(0,i.clearProps)(e,["policyIdentifier","policyQualifiers"]);const t=s.compareSchema(e,e,o.schema({names:{policyIdentifier:"policyIdentifier",policyQualifiers:"policyQualifiers"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyInformation");this.policyIdentifier=t.result.policyIdentifier.valueBlock.toString(),"policyQualifiers"in t.result&&(this.policyQualifiers=Array.from(t.result.policyQualifiers,e=>new n.default({schema:e})))}toSchema(){const e=[];return e.push(new s.ObjectIdentifier({value:this.policyIdentifier})),"policyQualifiers"in this&&e.push(new s.Sequence({value:Array.from(this.policyQualifiers,e=>e.toSchema())})),new s.Sequence({value:e})}toJSON(){const e={policyIdentifier:this.policyIdentifier};return"policyQualifiers"in this&&(e.policyQualifiers=Array.from(this.policyQualifiers,e=>e.toJSON())),e}}t.default=o},GBpR:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09"),i=r("UM/M");class n{constructor(e={}){this.type=(0,s.getParametersValue)(e,"type",n.defaultValues("type")),this.value=(0,s.getParametersValue)(e,"value",n.defaultValues("value")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return"";case"value":return{};default:throw new Error(`Invalid member name for AttributeTypeAndValue class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.ObjectIdentifier({name:t.type||""}),new a.Any({name:t.value||""})]})}static blockName(){return"AttributeTypeAndValue"}fromSchema(e){(0,s.clearProps)(e,["type","typeValue"]);const t=a.compareSchema(e,e,n.schema({names:{type:"type",value:"typeValue"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AttributeTypeAndValue");this.type=t.result.type.valueBlock.toString(),this.value=t.result.typeValue}toSchema(){return new a.Sequence({value:[new a.ObjectIdentifier({value:this.type}),this.value]})}toJSON(){const e={type:this.type};return 0!==Object.keys(this.value).length?e.value=this.value.toJSON():e.value=this.value,e}isEqual(e){const t=[a.Utf8String.blockName(),a.BmpString.blockName(),a.UniversalString.blockName(),a.NumericString.blockName(),a.PrintableString.blockName(),a.TeletexString.blockName(),a.VideotexString.blockName(),a.IA5String.blockName(),a.GraphicString.blockName(),a.VisibleString.blockName(),a.GeneralString.blockName(),a.CharacterString.blockName()];if(e.constructor.blockName()===n.blockName()){if(this.type!==e.type)return!1;let a=!1;const n=this.value.constructor.blockName();if(n===e.value.constructor.blockName())for(var r=0,o=t;r<o.length;r++){if(n===o[r]){a=!0;break}}if(a){const t=(0,i.stringPrep)(this.value.valueBlock.value),r=(0,i.stringPrep)(e.value.valueBlock.value);if(0!==t.localeCompare(r))return!1}else if(!1===(0,s.isEqualBuffer)(this.value.valueBeforeDecode,e.value.valueBeforeDecode))return!1;return!0}return e instanceof ArrayBuffer&&(0,s.isEqualBuffer)(this.value.valueBeforeDecode,e)}}t.default=n},GS2A:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09"),i=r("UM/M"),n=c(r("tZ8Z")),o=c(r("K3UR")),u=c(r("px0U")),l=c(r("gilY"));function c(e){return e&&e.__esModule?e:{default:e}}function m(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.CertificationRequestInfo||"CertificationRequestInfo",value:[new a.Integer({name:t.CertificationRequestInfoVersion||"CertificationRequestInfo.version"}),o.default.schema(t.subject||{names:{blockName:"CertificationRequestInfo.subject"}}),n.default.schema({names:{blockName:"CertificationRequestInfo.subjectPublicKeyInfo"}}),new a.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new a.Repeated({optional:!0,name:t.CertificationRequestInfoAttributes||"CertificationRequestInfo.attributes",value:l.default.schema(t.attributes||{})})]})]})}class h{constructor(e={}){this.tbs=(0,s.getParametersValue)(e,"tbs",h.defaultValues("tbs")),this.version=(0,s.getParametersValue)(e,"version",h.defaultValues("version")),this.subject=(0,s.getParametersValue)(e,"subject",h.defaultValues("subject")),this.subjectPublicKeyInfo=(0,s.getParametersValue)(e,"subjectPublicKeyInfo",h.defaultValues("subjectPublicKeyInfo")),"attributes"in e&&(this.attributes=(0,s.getParametersValue)(e,"attributes",h.defaultValues("attributes"))),this.signatureAlgorithm=(0,s.getParametersValue)(e,"signatureAlgorithm",h.defaultValues("signatureAlgorithm")),this.signatureValue=(0,s.getParametersValue)(e,"signatureValue",h.defaultValues("signatureValue")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return new ArrayBuffer(0);case"version":return 0;case"subject":return new o.default;case"subjectPublicKeyInfo":return new n.default;case"attributes":return[];case"signatureAlgorithm":return new u.default;case"signatureValue":return new a.BitString;default:throw new Error(`Invalid member name for CertificationRequest class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({value:[m(t.certificationRequestInfo||{}),new a.Sequence({name:t.signatureAlgorithm||"signatureAlgorithm",value:[new a.ObjectIdentifier,new a.Any({optional:!0})]}),new a.BitString({name:t.signatureValue||"signatureValue"})]})}fromSchema(e){(0,s.clearProps)(e,["CertificationRequestInfo","CertificationRequestInfo.version","CertificationRequestInfo.subject","CertificationRequestInfo.subjectPublicKeyInfo","CertificationRequestInfo.attributes","signatureAlgorithm","signatureValue"]);const t=a.compareSchema(e,e,h.schema());if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CertificationRequest");this.tbs=t.result.CertificationRequestInfo.valueBeforeDecode,this.version=t.result["CertificationRequestInfo.version"].valueBlock.valueDec,this.subject=new o.default({schema:t.result["CertificationRequestInfo.subject"]}),this.subjectPublicKeyInfo=new n.default({schema:t.result["CertificationRequestInfo.subjectPublicKeyInfo"]}),"CertificationRequestInfo.attributes"in t.result&&(this.attributes=Array.from(t.result["CertificationRequestInfo.attributes"],e=>new l.default({schema:e}))),this.signatureAlgorithm=new u.default({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[new a.Integer({value:this.version}),this.subject.toSchema(),this.subjectPublicKeyInfo.toSchema()];return"attributes"in this&&e.push(new a.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,e=>e.toSchema())})),new a.Sequence({value:e})}toSchema(e=!1){let t;if(!1===e){if(0===this.tbs.byteLength)return h.schema();t=a.fromBER(this.tbs).result}else t=this.encodeTBS();return new a.Sequence({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:(0,s.bufferToHexCodes)(this.tbs,0,this.tbs.byteLength),version:this.version,subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return"attributes"in this&&(e.attributes=Array.from(this.attributes,e=>e.toJSON())),e}sign(e,t="SHA-1"){if("undefined"===typeof e)return Promise.reject("Need to provide a private key for signing");let r,s=Promise.resolve();const n=(0,i.getEngine)();return s=s.then(()=>n.subtle.getSignatureParameters(e,t)),s=s.then(e=>{r=e.parameters,this.signatureAlgorithm=e.signatureAlgorithm}),s=s.then(()=>{this.tbs=this.encodeTBS().toBER(!1)}),s=s.then(()=>n.subtle.signWithPrivateKey(this.tbs,e,r)),s=s.then(e=>{this.signatureValue=new a.BitString({valueHex:e})}),s}verify(){return(0,i.getEngine)().subtle.verifyWithPublicKey(this.tbs,this.signatureValue,this.subjectPublicKeyInfo,this.signatureAlgorithm)}getPublicKey(e=null){return(0,i.getEngine)().getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,e)}}t.default=h},"Gf0/":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("5v3g"))&&a.__esModule?a:{default:a};class o{constructor(e={}){"keyIdentifier"in e&&(this.keyIdentifier=(0,i.getParametersValue)(e,"keyIdentifier",o.defaultValues("keyIdentifier"))),"authorityCertIssuer"in e&&(this.authorityCertIssuer=(0,i.getParametersValue)(e,"authorityCertIssuer",o.defaultValues("authorityCertIssuer"))),"authorityCertSerialNumber"in e&&(this.authorityCertSerialNumber=(0,i.getParametersValue)(e,"authorityCertSerialNumber",o.defaultValues("authorityCertSerialNumber"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"keyIdentifier":return new s.OctetString;case"authorityCertIssuer":return[];case"authorityCertSerialNumber":return new s.Integer;default:throw new Error(`Invalid member name for AuthorityKeyIdentifier class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Primitive({name:t.keyIdentifier||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.Repeated({name:t.authorityCertIssuer||"",value:n.default.schema()})]}),new s.Primitive({name:t.authorityCertSerialNumber||"",optional:!0,idBlock:{tagClass:3,tagNumber:2}})]})}fromSchema(e){(0,i.clearProps)(e,["keyIdentifier","authorityCertIssuer","authorityCertSerialNumber"]);const t=s.compareSchema(e,e,o.schema({names:{keyIdentifier:"keyIdentifier",authorityCertIssuer:"authorityCertIssuer",authorityCertSerialNumber:"authorityCertSerialNumber"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AuthorityKeyIdentifier");"keyIdentifier"in t.result&&(this.keyIdentifier=new s.OctetString({valueHex:t.result.keyIdentifier.valueBlock.valueHex})),"authorityCertIssuer"in t.result&&(this.authorityCertIssuer=Array.from(t.result.authorityCertIssuer,e=>new n.default({schema:e}))),"authorityCertSerialNumber"in t.result&&(this.authorityCertSerialNumber=new s.Integer({valueHex:t.result.authorityCertSerialNumber.valueBlock.valueHex}))}toSchema(){const e=[];return"keyIdentifier"in this&&e.push(new s.Primitive({idBlock:{tagClass:3,tagNumber:0},valueHex:this.keyIdentifier.valueBlock.valueHex})),"authorityCertIssuer"in this&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.authorityCertIssuer,e=>e.toSchema())})),"authorityCertSerialNumber"in this&&e.push(new s.Primitive({idBlock:{tagClass:3,tagNumber:2},valueHex:this.authorityCertSerialNumber.valueBlock.valueHex})),new s.Sequence({value:e})}toJSON(){const e={};return"keyIdentifier"in this&&(e.keyIdentifier=this.keyIdentifier.toJSON()),"authorityCertIssuer"in this&&(e.authorityCertIssuer=Array.from(this.authorityCertIssuer,e=>e.toJSON())),"authorityCertSerialNumber"in this&&(e.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),e}}t.default=o},HK8C:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.keyPurposes=(0,s.getParametersValue)(e,"keyPurposes",i.defaultValues("keyPurposes")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"keyPurposes":return[];default:throw new Error(`Invalid member name for ExtKeyUsage class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.Repeated({name:t.keyPurposes||"",value:new a.ObjectIdentifier})]})}fromSchema(e){(0,s.clearProps)(e,["keyPurposes"]);const t=a.compareSchema(e,e,i.schema({names:{keyPurposes:"keyPurposes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for ExtKeyUsage");this.keyPurposes=Array.from(t.result.keyPurposes,e=>e.valueBlock.toString())}toSchema(){return new a.Sequence({value:Array.from(this.keyPurposes,e=>new a.ObjectIdentifier({value:e}))})}toJSON(){return{keyPurposes:Array.from(this.keyPurposes)}}}t.default=i},Iued:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.type=(0,s.getParametersValue)(e,"type",i.defaultValues("type")),this.value=(0,s.getParametersValue)(e,"value",i.defaultValues("value")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return 0;case"value":return new Date(0,0,0);default:throw new Error(`Invalid member name for Time class: ${e}`)}}static schema(e={},t=!1){const r=(0,s.getParametersValue)(e,"names",{});return new a.Choice({optional:t,value:[new a.UTCTime({name:r.utcTimeName||""}),new a.GeneralizedTime({name:r.generalTimeName||""})]})}fromSchema(e){(0,s.clearProps)(e,["utcTimeName","generalTimeName"]);const t=a.compareSchema(e,e,i.schema({names:{utcTimeName:"utcTimeName",generalTimeName:"generalTimeName"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Time");"utcTimeName"in t.result&&(this.type=0,this.value=t.result.utcTimeName.toDate()),"generalTimeName"in t.result&&(this.type=1,this.value=t.result.generalTimeName.toDate())}toSchema(){let e={};return 0===this.type&&(e=new a.UTCTime({valueDate:this.value})),1===this.type&&(e=new a.GeneralizedTime({valueDate:this.value})),e}toJSON(){return{type:this.type,value:this.value}}}t.default=i},K3UR:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("GBpR"))&&a.__esModule?a:{default:a};function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],a=!0,s=!1,i=void 0;try{for(var n,o=e[Symbol.iterator]();!(a=(n=o.next()).done)&&(r.push(n.value),!t||r.length!==t);a=!0);}catch(u){s=!0,i=u}finally{try{a||null==o.return||o.return()}finally{if(s)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class u{constructor(e={}){this.typesAndValues=(0,i.getParametersValue)(e,"typesAndValues",u.defaultValues("typesAndValues")),this.valueBeforeDecode=(0,i.getParametersValue)(e,"valueBeforeDecode",u.defaultValues("valueBeforeDecode")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"typesAndValues":return[];case"valueBeforeDecode":return new ArrayBuffer(0);default:throw new Error(`Invalid member name for RelativeDistinguishedNames class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"typesAndValues":return 0===t.length;case"valueBeforeDecode":return 0===t.byteLength;default:throw new Error(`Invalid member name for RelativeDistinguishedNames class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.repeatedSequence||"",value:new s.Set({value:[new s.Repeated({name:t.repeatedSet||"",value:n.default.schema(t.typeAndValue||{})})]})})]})}fromSchema(e){(0,i.clearProps)(e,["RDN","typesAndValues"]);const t=s.compareSchema(e,e,u.schema({names:{blockName:"RDN",repeatedSet:"typesAndValues"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RelativeDistinguishedNames");"typesAndValues"in t.result&&(this.typesAndValues=Array.from(t.result.typesAndValues,e=>new n.default({schema:e}))),this.valueBeforeDecode=t.result.RDN.valueBeforeDecode}toSchema(){if(0===this.valueBeforeDecode.byteLength)return new s.Sequence({value:[new s.Set({value:Array.from(this.typesAndValues,e=>e.toSchema())})]});return s.fromBER(this.valueBeforeDecode).result}toJSON(){return{typesAndValues:Array.from(this.typesAndValues,e=>e.toJSON())}}isEqual(e){if(e instanceof u){if(this.typesAndValues.length!==e.typesAndValues.length)return!1;var t=!0,r=!1,a=void 0;try{for(var s,n=this.typesAndValues.entries()[Symbol.iterator]();!(t=(s=n.next()).done);t=!0){const t=o(s.value,2),r=t[0];if(!1===t[1].isEqual(e.typesAndValues[r]))return!1}}catch(l){r=!0,a=l}finally{try{t||null==n.return||n.return()}finally{if(r)throw a}}return!0}return e instanceof ArrayBuffer&&(0,i.isEqualBuffer)(this.valueBeforeDecode,e)}}t.default=u},MgLg:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09"),i=o(r("5v3g")),n=o(r("K3UR"));function o(e){return e&&e.__esModule?e:{default:e}}class u{constructor(e={}){"distributionPoint"in e&&(this.distributionPoint=(0,s.getParametersValue)(e,"distributionPoint",u.defaultValues("distributionPoint"))),"reasons"in e&&(this.reasons=(0,s.getParametersValue)(e,"reasons",u.defaultValues("reasons"))),"cRLIssuer"in e&&(this.cRLIssuer=(0,s.getParametersValue)(e,"cRLIssuer",u.defaultValues("cRLIssuer"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"distributionPoint":return[];case"reasons":return new a.BitString;case"cRLIssuer":return[];default:throw new Error(`Invalid member name for DistributionPoint class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new a.Choice({value:[new a.Constructed({name:t.distributionPoint||"",optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new a.Repeated({name:t.distributionPointNames||"",value:i.default.schema()})]}),new a.Constructed({name:t.distributionPoint||"",optional:!0,idBlock:{tagClass:3,tagNumber:1},value:n.default.schema().valueBlock.value})]})]}),new a.Primitive({name:t.reasons||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new a.Constructed({name:t.cRLIssuer||"",optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[new a.Repeated({name:t.cRLIssuerNames||"",value:i.default.schema()})]})]})}fromSchema(e){(0,s.clearProps)(e,["distributionPoint","distributionPointNames","reasons","cRLIssuer","cRLIssuerNames"]);const t=a.compareSchema(e,e,u.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",reasons:"reasons",cRLIssuer:"cRLIssuer",cRLIssuerNames:"cRLIssuerNames"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for DistributionPoint");"distributionPoint"in t.result&&(0===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=Array.from(t.result.distributionPointNames,e=>new i.default({schema:e}))),1===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=new n.default({schema:new a.Sequence({value:t.result.distributionPoint.valueBlock.value})}))),"reasons"in t.result&&(this.reasons=new a.BitString({valueHex:t.result.reasons.valueBlock.valueHex})),"cRLIssuer"in t.result&&(this.cRLIssuer=Array.from(t.result.cRLIssuerNames,e=>new i.default({schema:e})))}toSchema(){const e=[];if("distributionPoint"in this){let t;t=this.distributionPoint instanceof Array?new a.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,e=>e.toSchema())}):new a.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]}),e.push(new a.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}return"reasons"in this&&e.push(new a.Primitive({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHex})),"cRLIssuer"in this&&e.push(new a.Constructed({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,e=>e.toSchema())})),new a.Sequence({value:e})}toJSON(){const e={};return"distributionPoint"in this&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,e=>e.toJSON()):e.distributionPoint=this.distributionPoint.toJSON()),"reasons"in this&&(e.reasons=this.reasons.toJSON()),"cRLIssuer"in this&&(e.cRLIssuer=Array.from(this.cRLIssuer,e=>e.toJSON())),e}}t.default=u},Nefp:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("6rMh"))&&a.__esModule?a:{default:a};class o{constructor(e={}){"permittedSubtrees"in e&&(this.permittedSubtrees=(0,i.getParametersValue)(e,"permittedSubtrees",o.defaultValues("permittedSubtrees"))),"excludedSubtrees"in e&&(this.excludedSubtrees=(0,i.getParametersValue)(e,"excludedSubtrees",o.defaultValues("excludedSubtrees"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"permittedSubtrees":case"excludedSubtrees":return[];default:throw new Error(`Invalid member name for NameConstraints class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Repeated({name:t.permittedSubtrees||"",value:n.default.schema()})]}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.Repeated({name:t.excludedSubtrees||"",value:n.default.schema()})]})]})}fromSchema(e){(0,i.clearProps)(e,["permittedSubtrees","excludedSubtrees"]);const t=s.compareSchema(e,e,o.schema({names:{permittedSubtrees:"permittedSubtrees",excludedSubtrees:"excludedSubtrees"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for NameConstraints");"permittedSubtrees"in t.result&&(this.permittedSubtrees=Array.from(t.result.permittedSubtrees,e=>new n.default({schema:e}))),"excludedSubtrees"in t.result&&(this.excludedSubtrees=Array.from(t.result.excludedSubtrees,e=>new n.default({schema:e})))}toSchema(){const e=[];return"permittedSubtrees"in this&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.permittedSubtrees,e=>e.toSchema())})),"excludedSubtrees"in this&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.excludedSubtrees,e=>e.toSchema())})),new s.Sequence({value:e})}toJSON(){const e={};return"permittedSubtrees"in this&&(e.permittedSubtrees=Array.from(this.permittedSubtrees,e=>e.toJSON())),"excludedSubtrees"in this&&(e.excludedSubtrees=Array.from(this.excludedSubtrees,e=>e.toJSON())),e}}t.default=o},NejM:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.issuerDomainPolicy=(0,s.getParametersValue)(e,"issuerDomainPolicy",i.defaultValues("issuerDomainPolicy")),this.subjectDomainPolicy=(0,s.getParametersValue)(e,"subjectDomainPolicy",i.defaultValues("subjectDomainPolicy")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"issuerDomainPolicy":case"subjectDomainPolicy":return"";default:throw new Error(`Invalid member name for PolicyMapping class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.ObjectIdentifier({name:t.issuerDomainPolicy||""}),new a.ObjectIdentifier({name:t.subjectDomainPolicy||""})]})}fromSchema(e){(0,s.clearProps)(e,["issuerDomainPolicy","subjectDomainPolicy"]);const t=a.compareSchema(e,e,i.schema({names:{issuerDomainPolicy:"issuerDomainPolicy",subjectDomainPolicy:"subjectDomainPolicy"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyMapping");this.issuerDomainPolicy=t.result.issuerDomainPolicy.valueBlock.toString(),this.subjectDomainPolicy=t.result.subjectDomainPolicy.valueBlock.toString()}toSchema(){return new a.Sequence({value:[new a.ObjectIdentifier({value:this.issuerDomainPolicy}),new a.ObjectIdentifier({value:this.subjectDomainPolicy})]})}toJSON(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}t.default=i},SInf:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){"notBefore"in e&&(this.notBefore=(0,s.getParametersValue)(e,"notBefore",i.defaultValues("notBefore"))),"notAfter"in e&&(this.notAfter=(0,s.getParametersValue)(e,"notAfter",i.defaultValues("notAfter"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"notBefore":case"notAfter":return new Date;default:throw new Error(`Invalid member name for PrivateKeyUsagePeriod class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.Primitive({name:t.notBefore||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new a.Primitive({name:t.notAfter||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){(0,s.clearProps)(e,["notBefore","notAfter"]);const t=a.compareSchema(e,e,i.schema({names:{notBefore:"notBefore",notAfter:"notAfter"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PrivateKeyUsagePeriod");if("notBefore"in t.result){const e=new a.GeneralizedTime;e.fromBuffer(t.result.notBefore.valueBlock.valueHex),this.notBefore=e.toDate()}if("notAfter"in t.result){const e=new a.GeneralizedTime({valueHex:t.result.notAfter.valueBlock.valueHex});e.fromBuffer(t.result.notAfter.valueBlock.valueHex),this.notAfter=e.toDate()}}toSchema(){const e=[];return"notBefore"in this&&e.push(new a.Primitive({idBlock:{tagClass:3,tagNumber:0},valueHex:new a.GeneralizedTime({valueDate:this.notBefore}).valueBlock.valueHex})),"notAfter"in this&&e.push(new a.Primitive({idBlock:{tagClass:3,tagNumber:1},valueHex:new a.GeneralizedTime({valueDate:this.notAfter}).valueBlock.valueHex})),new a.Sequence({value:e})}toJSON(){const e={};return"notBefore"in this&&(e.notBefore=this.notBefore),"notAfter"in this&&(e.notAfter=this.notAfter),e}}t.default=i},TI6k:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.policyQualifierId=(0,s.getParametersValue)(e,"policyQualifierId",i.defaultValues("policyQualifierId")),this.qualifier=(0,s.getParametersValue)(e,"qualifier",i.defaultValues("qualifier")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"policyQualifierId":return"";case"qualifier":return new a.Any;default:throw new Error(`Invalid member name for PolicyQualifierInfo class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.ObjectIdentifier({name:t.policyQualifierId||""}),new a.Any({name:t.qualifier||""})]})}fromSchema(e){(0,s.clearProps)(e,["policyQualifierId","qualifier"]);const t=a.compareSchema(e,e,i.schema({names:{policyQualifierId:"policyQualifierId",qualifier:"qualifier"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyQualifierInfo");this.policyQualifierId=t.result.policyQualifierId.valueBlock.toString(),this.qualifier=t.result.qualifier}toSchema(){return new a.Sequence({value:[new a.ObjectIdentifier({value:this.policyQualifierId}),this.qualifier]})}toJSON(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}t.default=i},"UM/M":function(e,t,r){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.setEngine=l,t.getEngine=c,t.getCrypto=m,t.getRandomValues=function(e){return c().subtle.getRandomValues(e)},t.getOIDByAlgorithm=function(e){return c().subtle.getOIDByAlgorithm(e)},t.getAlgorithmParameters=function(e,t){return c().subtle.getAlgorithmParameters(e,t)},t.createCMSECDSASignature=function(e){if(e.byteLength%2!==0)return new ArrayBuffer(0);const t=e.byteLength/2,r=new ArrayBuffer(t);new Uint8Array(r).set(new Uint8Array(e,0,t));const a=new i.Integer({valueHex:r}),s=new ArrayBuffer(t);new Uint8Array(s).set(new Uint8Array(e,t,t));const n=new i.Integer({valueHex:s});return new i.Sequence({value:[a.convertToDER(),n.convertToDER()]}).toBER(!1)},t.stringPrep=function(e){let t=!1,r="";const a=e.trim();for(let s=0;s<a.length;s++)32===a.charCodeAt(s)?!1===t&&(t=!0):(t&&(r+=" ",t=!1),r+=a[s]);return r.toLowerCase()},t.createECDSASignatureFromCMS=function(e){if(e instanceof i.Sequence===!1)return new ArrayBuffer(0);if(2!==e.valueBlock.value.length)return new ArrayBuffer(0);if(e.valueBlock.value[0]instanceof i.Integer===!1)return new ArrayBuffer(0);if(e.valueBlock.value[1]instanceof i.Integer===!1)return new ArrayBuffer(0);const t=e.valueBlock.value[0].convertFromDER(),r=e.valueBlock.value[1].convertFromDER();switch(!0){case t.valueBlock.valueHex.byteLength<r.valueBlock.valueHex.byteLength:{if(r.valueBlock.valueHex.byteLength-t.valueBlock.valueHex.byteLength!==1)throw new Error("Incorrect DER integer decoding");const e=r.valueBlock.valueHex.byteLength,a=new Uint8Array(t.valueBlock.valueHex),s=new ArrayBuffer(e),i=new Uint8Array(s);return i.set(a,1),i[0]=0,(0,n.utilConcatBuf)(s,r.valueBlock.valueHex)}case t.valueBlock.valueHex.byteLength>r.valueBlock.valueHex.byteLength:{if(t.valueBlock.valueHex.byteLength-r.valueBlock.valueHex.byteLength!==1)throw new Error("Incorrect DER integer decoding");const e=t.valueBlock.valueHex.byteLength,a=new Uint8Array(r.valueBlock.valueHex),s=new ArrayBuffer(e),i=new Uint8Array(s);return i.set(a,1),i[0]=0,(0,n.utilConcatBuf)(t.valueBlock.valueHex,s)}default:if(t.valueBlock.valueHex.byteLength%2){const e=t.valueBlock.valueHex.byteLength+1,a=new Uint8Array(t.valueBlock.valueHex),s=new ArrayBuffer(e),i=new Uint8Array(s);i.set(a,1),i[0]=0;const o=new Uint8Array(r.valueBlock.valueHex),u=new ArrayBuffer(e),l=new Uint8Array(u);return l.set(o,1),l[0]=0,(0,n.utilConcatBuf)(s,u)}}return(0,n.utilConcatBuf)(t.valueBlock.valueHex,r.valueBlock.valueHex)},t.getAlgorithmByOID=function(e){return c().subtle.getAlgorithmByOID(e)},t.getHashAlgorithm=function(e){return c().subtle.getHashAlgorithm(e)},t.kdfWithCounter=h,t.kdf=function(e,t,r,a){let s=0,i=1;const o=[];switch(e.toUpperCase()){case"SHA-1":s=160;break;case"SHA-256":s=256;break;case"SHA-384":s=384;break;case"SHA-512":s=512;break;default:return Promise.reject(`Unknown hash function: ${e}`)}if(t instanceof ArrayBuffer===!1)return Promise.reject('Please set "Zbuffer" as "ArrayBuffer"');if(0===t.byteLength)return Promise.reject('"Zbuffer" has zero length, error');if(a instanceof ArrayBuffer===!1)return Promise.reject('Please set "SharedInfo" as "ArrayBuffer"');const u=r/s;Math.floor(u)>0&&(i=Math.floor(u),u-i>0&&i++);for(let n=1;n<=i;n++)o.push(h(e,t,n,a));return Promise.all(o).then(e=>{let t=new ArrayBuffer(0),a=1,s=!0;for(;s;){s=!1;var i=!0,o=!1,u=void 0;try{for(var l,c=e[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){const e=l.value;if(e.counter===a){t=(0,n.utilConcatBuf)(t,e.result),s=!0;break}}}catch(m){o=!0,u=m}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}a++}if(r>>=3,t.byteLength>r){const e=new ArrayBuffer(r),a=new Uint8Array(e),s=new Uint8Array(t);for(let t=0;t<r;t++)a[t]=s[t];return e}return t})};var s,i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),n=r("OC09"),o=(s=r("e90+"))&&s.__esModule?s:{default:s};let u={name:"none",crypto:null,subtle:null};function l(t,r,s){if("undefined"!==typeof e&&"pid"in e&&"undefined"!==typeof a&&"undefined"===typeof window){if("undefined"===typeof a[e.pid])a[e.pid]={};else if("object"!==typeof a[e.pid])throw new Error(`Name global.${e.pid} already exists and it is not an object`);if("undefined"===typeof a[e.pid].pkijs)a[e.pid].pkijs={};else if("object"!==typeof a[e.pid].pkijs)throw new Error(`Name global.${e.pid}.pkijs already exists and it is not an object`);a[e.pid].pkijs.engine={name:t,crypto:r,subtle:s}}else u={name:t,crypto:r,subtle:s}}function c(){if("undefined"!==typeof e&&"pid"in e&&"undefined"!==typeof a&&"undefined"===typeof window){let r;try{r=a[e.pid].pkijs.engine}catch(t){throw new Error('Please call "setEngine" before call to "getEngine"')}return r}return u}function m(){const e=c();if(null!==e.subtle)return e.subtle}function h(e,t,r,a){switch(e.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;default:return Promise.reject(`Unknown hash function: ${e}`)}if(t instanceof ArrayBuffer===!1)return Promise.reject('Please set "Zbuffer" as "ArrayBuffer"');if(0===t.byteLength)return Promise.reject('"Zbuffer" has zero length, error');if(a instanceof ArrayBuffer===!1)return Promise.reject('Please set "SharedInfo" as "ArrayBuffer"');if(r>255)return Promise.reject('Please set "Counter" variable to value less or equal to 255');const s=new ArrayBuffer(4),i=new Uint8Array(s);i[0]=0,i[1]=0,i[2]=0,i[3]=r;let o=new ArrayBuffer(0);const u=m();return"undefined"===typeof u?Promise.reject("Unable to create WebCrypto object"):(o=(0,n.utilConcatBuf)(o,t),o=(0,n.utilConcatBuf)(o,s),o=(0,n.utilConcatBuf)(o,a),u.digest({name:e},o).then(e=>({counter:r,result:e})))}!function(){if("undefined"!==typeof self&&"crypto"in self){let t="webcrypto";const r=self.crypto;let a;if("webkitSubtle"in self.crypto){try{a=self.crypto.webkitSubtle}catch(e){a=self.crypto.subtle}t="safari"}"subtle"in self.crypto&&(a=self.crypto.subtle),u="undefined"===typeof a?{name:t,crypto:r,subtle:null}:{name:t,crypto:r,subtle:new o.default({name:t,crypto:self.crypto,subtle:a})}}l(u.name,u.crypto,u.subtle)}()}).call(this,r("8oxB"),r("yLpj"))},XtFe:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("px0U"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.hashAlgorithm=(0,i.getParametersValue)(e,"hashAlgorithm",o.defaultValues("hashAlgorithm")),this.maskGenAlgorithm=(0,i.getParametersValue)(e,"maskGenAlgorithm",o.defaultValues("maskGenAlgorithm")),this.saltLength=(0,i.getParametersValue)(e,"saltLength",o.defaultValues("saltLength")),this.trailerField=(0,i.getParametersValue)(e,"trailerField",o.defaultValues("trailerField")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"hashAlgorithm":return new n.default({algorithmId:"1.3.14.3.2.26",algorithmParams:new s.Null});case"maskGenAlgorithm":return new n.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new n.default({algorithmId:"1.3.14.3.2.26",algorithmParams:new s.Null}).toSchema()});case"saltLength":return 20;case"trailerField":return 1;default:throw new Error(`Invalid member name for RSASSAPSSParams class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Constructed({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[n.default.schema(t.hashAlgorithm||{})]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[n.default.schema(t.maskGenAlgorithm||{})]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[new s.Integer({name:t.saltLength||""})]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:3},optional:!0,value:[new s.Integer({name:t.trailerField||""})]})]})}fromSchema(e){(0,i.clearProps)(e,["hashAlgorithm","maskGenAlgorithm","saltLength","trailerField"]);const t=s.compareSchema(e,e,o.schema({names:{hashAlgorithm:{names:{blockName:"hashAlgorithm"}},maskGenAlgorithm:{names:{blockName:"maskGenAlgorithm"}},saltLength:"saltLength",trailerField:"trailerField"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RSASSAPSSParams");"hashAlgorithm"in t.result&&(this.hashAlgorithm=new n.default({schema:t.result.hashAlgorithm})),"maskGenAlgorithm"in t.result&&(this.maskGenAlgorithm=new n.default({schema:t.result.maskGenAlgorithm})),"saltLength"in t.result&&(this.saltLength=t.result.saltLength.valueBlock.valueDec),"trailerField"in t.result&&(this.trailerField=t.result.trailerField.valueBlock.valueDec)}toSchema(){const e=[];return this.hashAlgorithm.isEqual(o.defaultValues("hashAlgorithm"))||e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(o.defaultValues("maskGenAlgorithm"))||e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.saltLength!==o.defaultValues("saltLength")&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:2},value:[new s.Integer({value:this.saltLength})]})),this.trailerField!==o.defaultValues("trailerField")&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:3},value:[new s.Integer({value:this.trailerField})]})),new s.Sequence({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(o.defaultValues("hashAlgorithm"))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(o.defaultValues("maskGenAlgorithm"))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.saltLength!==o.defaultValues("saltLength")&&(e.saltLength=this.saltLength),this.trailerField!==o.defaultValues("trailerField")&&(e.trailerField=this.trailerField),e}}t.default=o},ZFiR:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("DFRD"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.certificatePolicies=(0,i.getParametersValue)(e,"certificatePolicies",o.defaultValues("certificatePolicies")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"certificatePolicies":return[];default:throw new Error(`Invalid member name for CertificatePolicies class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.certificatePolicies||"",value:n.default.schema()})]})}fromSchema(e){(0,i.clearProps)(e,["certificatePolicies"]);const t=s.compareSchema(e,e,o.schema({names:{certificatePolicies:"certificatePolicies"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CertificatePolicies");this.certificatePolicies=Array.from(t.result.certificatePolicies,e=>new n.default({schema:e}))}toSchema(){return new s.Sequence({value:Array.from(this.certificatePolicies,e=>e.toSchema())})}toJSON(){return{certificatePolicies:Array.from(this.certificatePolicies,e=>e.toJSON())}}}t.default=o},ZuMJ:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.certificateIndex=(0,s.getParametersValue)(e,"certificateIndex",i.defaultValues("certificateIndex")),this.keyIndex=(0,s.getParametersValue)(e,"keyIndex",i.defaultValues("keyIndex")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"certificateIndex":case"keyIndex":return 0;default:throw new Error(`Invalid member name for CAVersion class: ${e}`)}}static schema(e={}){return new a.Integer}fromSchema(e){if(e.constructor.blockName()!==a.Integer.blockName())throw new Error("Object's schema was not verified against input data for CAVersion");let t=e.valueBlock.valueHex.slice(0);const r=new Uint8Array(t);switch(!0){case t.byteLength<4:{const e=new ArrayBuffer(4);new Uint8Array(e).set(r,4-t.byteLength),t=e.slice(0)}break;case t.byteLength>4:{const e=new ArrayBuffer(4);new Uint8Array(e).set(r.slice(0,4)),t=e.slice(0)}}const s=t.slice(0,2),i=new Uint8Array(s);let n=i[0];i[0]=i[1],i[1]=n;const o=new Uint16Array(s);this.keyIndex=o[0];const u=t.slice(2),l=new Uint8Array(u);n=l[0],l[0]=l[1],l[1]=n;const c=new Uint16Array(u);this.certificateIndex=c[0]}toSchema(){const e=new ArrayBuffer(2);new Uint16Array(e)[0]=this.certificateIndex;const t=new Uint8Array(e);let r=t[0];t[0]=t[1],t[1]=r;const i=new ArrayBuffer(2);new Uint16Array(i)[0]=this.keyIndex;const n=new Uint8Array(i);return r=n[0],n[0]=n[1],n[1]=r,new a.Integer({valueHex:(0,s.utilConcatBuf)(i,e)})}toJSON(){return{certificateIndex:this.certificateIndex,keyIndex:this.keyIndex}}}t.default=i},aFlX:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("3vEk"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.extensions=(0,i.getParametersValue)(e,"extensions",o.defaultValues("extensions")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"extensions":return[];default:throw new Error(`Invalid member name for Extensions class: ${e}`)}}static schema(e={},t=!1){const r=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({optional:t,name:r.blockName||"",value:[new s.Repeated({name:r.extensions||"",value:n.default.schema(r.extension||{})})]})}fromSchema(e){(0,i.clearProps)(e,["extensions"]);const t=s.compareSchema(e,e,o.schema({names:{extensions:"extensions"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Extensions");this.extensions=Array.from(t.result.extensions,e=>new n.default({schema:e}))}toSchema(){return new s.Sequence({value:Array.from(this.extensions,e=>e.toSchema())})}toJSON(){return{extensions:Array.from(this.extensions,e=>e.toJSON())}}}t.default=o},"e90+":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09"),i=r("UM/M"),n=f(r("tZ8Z")),o=f(r("fYIA")),u=f(r("px0U")),l=f(r("mOOK")),c=f(r("XtFe")),m=f(r("uHtI")),h=f(r("4uRB"));function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t,r,a,s,i){let n,o;const u=[];switch(t.toUpperCase()){case"SHA-1":n=20,o=64;break;case"SHA-256":n=32,o=64;break;case"SHA-384":n=48,o=128;break;case"SHA-512":n=64,o=128;break;default:throw new Error("Unsupported hashing algorithm")}const l=new Uint8Array(a),c=new ArrayBuffer(2*a.byteLength+2),m=new Uint8Array(c);for(let I=0;I<l.length;I++)m[2*I]=0,m[2*I+1]=l[I];m[m.length-2]=0,m[m.length-1]=0,a=c.slice(0);const h=new ArrayBuffer(o),f=new Uint8Array(h);for(let I=0;I<h.byteLength;I++)f[I]=3;const d=s.byteLength,p=o*Math.ceil(d/o),g=new ArrayBuffer(p),y=new Uint8Array(g),b=new Uint8Array(s);for(let I=0;I<p;I++)y[I]=b[I%d];const v=a.byteLength,w=o*Math.ceil(v/o),P=new ArrayBuffer(w),S=new Uint8Array(P),A=new Uint8Array(a);for(let I=0;I<w;I++)S[I]=A[I%v];const C=g.byteLength+P.byteLength;let k=new ArrayBuffer(C),O=new Uint8Array(k);O.set(y),O.set(S,y.length);const B=Math.ceil((r>>3)/n);let j=Promise.resolve(k);for(let I=0;I<=B;I++){j=j.then(e=>{const t=new ArrayBuffer(h.byteLength+e.byteLength),r=new Uint8Array(t);return r.set(f),r.set(O,f.length),t});for(let r=0;r<i;r++)j=j.then(r=>e.digest({name:t},new Uint8Array(r)));j=j.then(e=>{const t=new ArrayBuffer(o),r=new Uint8Array(t);for(let o=0;o<t.byteLength;o++)r[o]=e[o%e.length];const a=Math.ceil(d/o)+Math.ceil(v/o),s=[];let i=0,n=o;for(let u=0;u<a;u++){const e=Array.from(new Uint8Array(k.slice(i,i+n)));i+=o,i+o>k.byteLength&&(n=k.byteLength-i);let a=511;for(let s=t.byteLength-1;s>=0;s--)a>>=8,a+=r[s]+e[s],e[s]=255&a;s.push(...e)}return k=new ArrayBuffer(s.length),O=new Uint8Array(k),O.set(s),u.push(...new Uint8Array(e)),k})}return j=j.then(()=>{const e=new ArrayBuffer(r>>3);return new Uint8Array(e).set(new Uint8Array(u).slice(0,r>>3)),e}),j}t.default=class{constructor(e={}){this.crypto=(0,s.getParametersValue)(e,"crypto",{}),this.subtle=(0,s.getParametersValue)(e,"subtle",{}),this.name=(0,s.getParametersValue)(e,"name","")}importKey(e,t,r,i,u){let l={};switch(t instanceof Uint8Array&&(t=t.buffer),e.toLowerCase()){case"raw":return this.subtle.importKey("raw",t,r,i,u);case"spki":{const e=a.fromBER(t);if(-1===e.offset)return Promise.reject("Incorrect keyData");const s=new n.default;try{s.fromSchema(e.result)}catch(S){return Promise.reject("Incorrect keyData")}switch(r.name.toUpperCase()){case"RSA-PSS":switch(r.hash.name.toUpperCase()){case"SHA-1":l.alg="PS1";break;case"SHA-256":l.alg="PS256";break;case"SHA-384":l.alg="PS384";break;case"SHA-512":l.alg="PS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(u=["verify"],l.kty="RSA",l.ext=i,l.key_ops=u,"1.2.840.113549.1.1.1"!==s.algorithm.algorithmId)return Promise.reject(`Incorrect public key algorithm: ${s.algorithm.algorithmId}`);if("alg"in l===!1)switch(r.hash.name.toUpperCase()){case"SHA-1":l.alg="RS1";break;case"SHA-256":l.alg="RS256";break;case"SHA-384":l.alg="RS384";break;case"SHA-512":l.alg="RS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const e=s.toJSON();for(var c=0,m=Object.keys(e);c<m.length;c++){const t=m[c];l[t]=e[t]}}break;case"ECDSA":u=["verify"];case"ECDH":{if(l={kty:"EC",ext:i,key_ops:u},"1.2.840.10045.2.1"!==s.algorithm.algorithmId)return Promise.reject(`Incorrect public key algorithm: ${s.algorithm.algorithmId}`);const e=s.toJSON();for(var h=0,f=Object.keys(e);h<f.length;h++){const t=f[h];l[t]=e[t]}}break;case"RSA-OAEP":{if(l.kty="RSA",l.ext=i,l.key_ops=u,"safari"===this.name.toLowerCase())l.alg="RSA-OAEP";else switch(r.hash.name.toUpperCase()){case"SHA-1":l.alg="RSA-OAEP";break;case"SHA-256":l.alg="RSA-OAEP-256";break;case"SHA-384":l.alg="RSA-OAEP-384";break;case"SHA-512":l.alg="RSA-OAEP-512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const e=s.toJSON();for(var d=0,p=Object.keys(e);d<p.length;d++){const t=p[d];l[t]=e[t]}}break;default:return Promise.reject(`Incorrect algorithm name: ${r.name.toUpperCase()}`)}}break;case"pkcs8":{const e=new o.default,s=a.fromBER(t);if(-1===s.offset)return Promise.reject("Incorrect keyData");try{e.fromSchema(s.result)}catch(S){return Promise.reject("Incorrect keyData")}if("parsedKey"in e===!1)return Promise.reject("Incorrect keyData");switch(r.name.toUpperCase()){case"RSA-PSS":switch(r.hash.name.toUpperCase()){case"SHA-1":l.alg="PS1";break;case"SHA-256":l.alg="PS256";break;case"SHA-384":l.alg="PS384";break;case"SHA-512":l.alg="PS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(u=["sign"],l.kty="RSA",l.ext=i,l.key_ops=u,"1.2.840.113549.1.1.1"!==e.privateKeyAlgorithm.algorithmId)return Promise.reject(`Incorrect private key algorithm: ${e.privateKeyAlgorithm.algorithmId}`);if("alg"in l===!1)switch(r.hash.name.toUpperCase()){case"SHA-1":l.alg="RS1";break;case"SHA-256":l.alg="RS256";break;case"SHA-384":l.alg="RS384";break;case"SHA-512":l.alg="RS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const t=e.toJSON();for(var g=0,y=Object.keys(t);g<y.length;g++){const e=y[g];l[e]=t[e]}}break;case"ECDSA":u=["sign"];case"ECDH":{if(l={kty:"EC",ext:i,key_ops:u},"1.2.840.10045.2.1"!==e.privateKeyAlgorithm.algorithmId)return Promise.reject(`Incorrect algorithm: ${e.privateKeyAlgorithm.algorithmId}`);const t=e.toJSON();for(var b=0,v=Object.keys(t);b<v.length;b++){const e=v[b];l[e]=t[e]}}break;case"RSA-OAEP":{if(l.kty="RSA",l.ext=i,l.key_ops=u,"safari"===this.name.toLowerCase())l.alg="RSA-OAEP";else switch(r.hash.name.toUpperCase()){case"SHA-1":l.alg="RSA-OAEP";break;case"SHA-256":l.alg="RSA-OAEP-256";break;case"SHA-384":l.alg="RSA-OAEP-384";break;case"SHA-512":l.alg="RSA-OAEP-512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const t=e.toJSON();for(var w=0,P=Object.keys(t);w<P.length;w++){const e=P[w];l[e]=t[e]}}break;default:return Promise.reject(`Incorrect algorithm name: ${r.name.toUpperCase()}`)}}break;case"jwk":l=t;break;default:return Promise.reject(`Incorrect format: ${e}`)}return"safari"===this.name.toLowerCase()?Promise.resolve().then(()=>this.subtle.importKey("jwk",(0,s.stringToArrayBuffer)(JSON.stringify(l)),r,i,u)).then(e=>e,()=>this.subtle.importKey("jwk",l,r,i,u)):this.subtle.importKey("jwk",l,r,i,u)}exportKey(e,t){let r=this.subtle.exportKey("jwk",t);switch("safari"===this.name.toLowerCase()&&(r=r.then(e=>e instanceof ArrayBuffer?JSON.parse((0,s.arrayBufferToString)(e)):e)),e.toLowerCase()){case"raw":return this.subtle.exportKey("raw",t);case"spki":r=r.then(e=>{const t=new n.default;try{t.fromJSON(e)}catch(r){return Promise.reject("Incorrect key data")}return t.toSchema().toBER(!1)});break;case"pkcs8":r=r.then(e=>{const t=new o.default;try{t.fromJSON(e)}catch(r){return Promise.reject("Incorrect key data")}return t.toSchema().toBER(!1)});break;case"jwk":break;default:return Promise.reject(`Incorrect format: ${e}`)}return r}convert(e,t,r,a,s,i){switch(e.toLowerCase()){case"raw":switch(t.toLowerCase()){case"raw":return Promise.resolve(r);case"spki":return Promise.resolve().then(()=>this.importKey("raw",r,a,s,i)).then(e=>this.exportKey("spki",e));case"pkcs8":return Promise.resolve().then(()=>this.importKey("raw",r,a,s,i)).then(e=>this.exportKey("pkcs8",e));case"jwk":return Promise.resolve().then(()=>this.importKey("raw",r,a,s,i)).then(e=>this.exportKey("jwk",e));default:return Promise.reject(`Incorrect outputFormat: ${t}`)}case"spki":switch(t.toLowerCase()){case"raw":return Promise.resolve().then(()=>this.importKey("spki",r,a,s,i)).then(e=>this.exportKey("raw",e));case"spki":return Promise.resolve(r);case"pkcs8":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"jwk":return Promise.resolve().then(()=>this.importKey("spki",r,a,s,i)).then(e=>this.exportKey("jwk",e));default:return Promise.reject(`Incorrect outputFormat: ${t}`)}case"pkcs8":switch(t.toLowerCase()){case"raw":return Promise.resolve().then(()=>this.importKey("pkcs8",r,a,s,i)).then(e=>this.exportKey("raw",e));case"spki":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"pkcs8":return Promise.resolve(r);case"jwk":return Promise.resolve().then(()=>this.importKey("pkcs8",r,a,s,i)).then(e=>this.exportKey("jwk",e));default:return Promise.reject(`Incorrect outputFormat: ${t}`)}case"jwk":switch(t.toLowerCase()){case"raw":return Promise.resolve().then(()=>this.importKey("jwk",r,a,s,i)).then(e=>this.exportKey("raw",e));case"spki":return Promise.resolve().then(()=>this.importKey("jwk",r,a,s,i)).then(e=>this.exportKey("spki",e));case"pkcs8":return Promise.resolve().then(()=>this.importKey("jwk",r,a,s,i)).then(e=>this.exportKey("pkcs8",e));case"jwk":return Promise.resolve(r);default:return Promise.reject(`Incorrect outputFormat: ${t}`)}default:return Promise.reject(`Incorrect inputFormat: ${e}`)}}encrypt(...e){return this.subtle.encrypt(...e)}decrypt(...e){return this.subtle.decrypt(...e)}sign(...e){return this.subtle.sign(...e)}verify(...e){return this.subtle.verify(...e)}digest(...e){return this.subtle.digest(...e)}generateKey(...e){return this.subtle.generateKey(...e)}deriveKey(...e){return this.subtle.deriveKey(...e)}deriveBits(...e){return this.subtle.deriveBits(...e)}wrapKey(...e){return this.subtle.wrapKey(...e)}unwrapKey(...e){return this.subtle.unwrapKey(...e)}getRandomValues(e){if("getRandomValues"in this.crypto===!1)throw new Error("No support for getRandomValues");return this.crypto.getRandomValues(e)}getAlgorithmByOID(e){switch(e){case"1.2.840.113549.1.1.1":case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"}}return{}}getOIDByAlgorithm(e){let t="";switch(e.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.113549.1.1.5";break;case"SHA-256":t="1.2.840.113549.1.1.11";break;case"SHA-384":t="1.2.840.113549.1.1.12";break;case"SHA-512":t="1.2.840.113549.1.1.13"}break;case"RSA-PSS":t="1.2.840.113549.1.1.10";break;case"RSA-OAEP":t="1.2.840.113549.1.1.7";break;case"ECDSA":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.10045.4.1";break;case"SHA-256":t="1.2.840.10045.4.3.2";break;case"SHA-384":t="1.2.840.10045.4.3.3";break;case"SHA-512":t="1.2.840.10045.4.3.4"}break;case"ECDH":switch(e.kdf.toUpperCase()){case"SHA-1":t="1.3.133.16.840.63.0.2";break;case"SHA-256":t="1.3.132.1.11.1";break;case"SHA-384":t="1.3.132.1.11.2";break;case"SHA-512":t="1.3.132.1.11.3"}break;case"AES-CTR":break;case"AES-CBC":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.2";break;case 192:t="2.16.840.1.101.3.4.1.22";break;case 256:t="2.16.840.1.101.3.4.1.42"}break;case"AES-CMAC":break;case"AES-GCM":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.6";break;case 192:t="2.16.840.1.101.3.4.1.26";break;case 256:t="2.16.840.1.101.3.4.1.46"}break;case"AES-CFB":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.4";break;case 192:t="2.16.840.1.101.3.4.1.24";break;case 256:t="2.16.840.1.101.3.4.1.44"}break;case"AES-KW":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.5";break;case 192:t="2.16.840.1.101.3.4.1.25";break;case 256:t="2.16.840.1.101.3.4.1.45"}break;case"HMAC":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.113549.2.7";break;case"SHA-256":t="1.2.840.113549.2.9";break;case"SHA-384":t="1.2.840.113549.2.10";break;case"SHA-512":t="1.2.840.113549.2.11"}break;case"DH":t="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":t="1.3.14.3.2.26";break;case"SHA-256":t="2.16.840.1.101.3.4.2.1";break;case"SHA-384":t="2.16.840.1.101.3.4.2.2";break;case"SHA-512":t="2.16.840.1.101.3.4.2.3";break;case"CONCAT":case"HKDF":break;case"PBKDF2":t="1.2.840.113549.1.5.12";break;case"P-256":t="1.2.840.10045.3.1.7";break;case"P-384":t="1.3.132.0.34";break;case"P-521":t="1.3.132.0.35"}return t}getAlgorithmParameters(e,t){let r={algorithm:{},usages:[]};switch(e.toUpperCase()){case"RSASSA-PKCS1-V1_5":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":r={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(t.toLowerCase()){case"encrypt":case"decrypt":r={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":r={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":r={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;case"exportkey":default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":r={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(t.toLowerCase()){case"exportkey":case"importkey":case"generatekey":r={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":r={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CBC",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-GCM",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":r={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":switch(t.toLowerCase()){case"derivekey":r={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"HKDF"},usages:[]}}break;case"PBKDF2":switch(t.toLowerCase()){case"derivekey":r={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e4},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"PBKDF2"},usages:[]}}}return r}getHashAlgorithm(e){let t="";switch(e.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":t="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":t="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":t="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":t="SHA-512";break;case"1.2.840.113549.1.1.10":try{const r=new c.default({schema:e.algorithmParams});if("hashAlgorithm"in r){const e=this.getAlgorithmByOID(r.hashAlgorithm.algorithmId);if("name"in e===!1)return"";t=e.name}else t="SHA-1"}catch(r){}}return t}encryptEncryptedContentInfo(e){if(e instanceof Object===!1)return Promise.reject('Parameters must have type "Object"');if("password"in e===!1)return Promise.reject('Absent mandatory parameter "password"');if("contentEncryptionAlgorithm"in e===!1)return Promise.reject('Absent mandatory parameter "contentEncryptionAlgorithm"');if("hmacHashAlgorithm"in e===!1)return Promise.reject('Absent mandatory parameter "hmacHashAlgorithm"');if("iterationCount"in e===!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("contentToEncrypt"in e===!1)return Promise.reject('Absent mandatory parameter "contentToEncrypt"');if("contentType"in e===!1)return Promise.reject('Absent mandatory parameter "contentType"');const t=this.getOIDByAlgorithm(e.contentEncryptionAlgorithm);if(""===t)return Promise.reject('Wrong "contentEncryptionAlgorithm" value');const r=this.getOIDByAlgorithm({name:"PBKDF2"});if(""===r)return Promise.reject("Can not find OID for PBKDF2");const s=this.getOIDByAlgorithm({name:"HMAC",hash:{name:e.hmacHashAlgorithm}});if(""===s)return Promise.reject(`Incorrect value for "hmacHashAlgorithm": ${e.hmacHashAlgorithm}`);let i=Promise.resolve();const n=new ArrayBuffer(16),o=new Uint8Array(n);this.getRandomValues(o);const c=new ArrayBuffer(64),f=new Uint8Array(c);this.getRandomValues(f);const d=new Uint8Array(e.contentToEncrypt),p=new m.default({salt:new a.OctetString({valueHex:c}),iterationCount:e.iterationCount,prf:new u.default({algorithmId:s,algorithmParams:new a.Null})});return i=i.then(()=>{const t=new Uint8Array(e.password);return this.importKey("raw",t,"PBKDF2",!1,["deriveKey"])},e=>Promise.reject(e)),i=i.then(t=>this.deriveKey({name:"PBKDF2",hash:{name:e.hmacHashAlgorithm},salt:f,iterations:e.iterationCount},t,e.contentEncryptionAlgorithm,!1,["encrypt"]),e=>Promise.reject(e)),i=i.then(t=>this.encrypt({name:e.contentEncryptionAlgorithm.name,iv:o},t,d),e=>Promise.reject(e)),i=i.then(s=>{const i=new h.default({keyDerivationFunc:new u.default({algorithmId:r,algorithmParams:p.toSchema()}),encryptionScheme:new u.default({algorithmId:t,algorithmParams:new a.OctetString({valueHex:n})})});return new l.default({contentType:e.contentType,contentEncryptionAlgorithm:new u.default({algorithmId:"1.2.840.113549.1.5.13",algorithmParams:i.toSchema()}),encryptedContent:new a.OctetString({valueHex:s})})},e=>Promise.reject(e)),i}decryptEncryptedContentInfo(e){if(e instanceof Object===!1)return Promise.reject('Parameters must have type "Object"');if("password"in e===!1)return Promise.reject('Absent mandatory parameter "password"');if("encryptedContentInfo"in e===!1)return Promise.reject('Absent mandatory parameter "encryptedContentInfo"');if("1.2.840.113549.1.5.13"!==e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId)return Promise.reject(`Unknown "contentEncryptionAlgorithm": ${e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId}`);let t,r,a=Promise.resolve();try{t=new h.default({schema:e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams})}catch(d){return Promise.reject('Incorrectly encoded "pbes2Parameters"')}try{r=new m.default({schema:t.keyDerivationFunc.algorithmParams})}catch(d){return Promise.reject('Incorrectly encoded "pbkdf2Params"')}const i=this.getAlgorithmByOID(t.encryptionScheme.algorithmId);if("name"in i===!1)return Promise.reject(`Incorrect OID for "contentEncryptionAlgorithm": ${t.encryptionScheme.algorithmId}`);const n=t.encryptionScheme.algorithmParams.valueBlock.valueHex,o=new Uint8Array(n),u=r.salt.valueBlock.valueHex,l=new Uint8Array(u),c=r.iterationCount;let f="SHA-1";if("prf"in r){const e=this.getAlgorithmByOID(r.prf.algorithmId);if("name"in e===!1)return Promise.reject("Incorrect OID for HMAC hash algorithm");f=e.hash.name}return a=a.then(()=>this.importKey("raw",e.password,"PBKDF2",!1,["deriveKey"]),e=>Promise.reject(e)),a=a.then(e=>this.deriveKey({name:"PBKDF2",hash:{name:f},salt:l,iterations:c},e,i,!1,["decrypt"]),e=>Promise.reject(e)),a=a.then(t=>{let r=new ArrayBuffer(0);if(!1===e.encryptedContentInfo.encryptedContent.idBlock.isConstructed)r=e.encryptedContentInfo.encryptedContent.valueBlock.valueHex;else{var a=!0,n=!1,u=void 0;try{for(var l,c=e.encryptedContentInfo.encryptedContent.valueBlock.value[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){const e=l.value;r=(0,s.utilConcatBuf)(r,e.valueBlock.valueHex)}}catch(m){n=!0,u=m}finally{try{a||null==c.return||c.return()}finally{if(n)throw u}}}return this.decrypt({name:i.name,iv:o},t,r)},e=>Promise.reject(e)),a}stampDataWithPassword(e){if(e instanceof Object===!1)return Promise.reject('Parameters must have type "Object"');if("password"in e===!1)return Promise.reject('Absent mandatory parameter "password"');if("hashAlgorithm"in e===!1)return Promise.reject('Absent mandatory parameter "hashAlgorithm"');if("salt"in e===!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("iterationCount"in e===!1)return Promise.reject('Absent mandatory parameter "salt"');if("contentToStamp"in e===!1)return Promise.reject('Absent mandatory parameter "contentToStamp"');let t;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:return Promise.reject(`Incorrect "parameters.hashAlgorithm" parameter: ${e.hashAlgorithm}`)}let r=Promise.resolve();const a={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}};return r=r.then(()=>d(this,e.hashAlgorithm,t,e.password,e.salt,e.iterationCount)),r=r.then(e=>this.importKey("raw",new Uint8Array(e),a,!1,["sign"])),r=r.then(t=>this.sign(a,t,new Uint8Array(e.contentToStamp)),e=>Promise.reject(e)),r}verifyDataStampedWithPassword(e){if(e instanceof Object===!1)return Promise.reject('Parameters must have type "Object"');if("password"in e===!1)return Promise.reject('Absent mandatory parameter "password"');if("hashAlgorithm"in e===!1)return Promise.reject('Absent mandatory parameter "hashAlgorithm"');if("salt"in e===!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("iterationCount"in e===!1)return Promise.reject('Absent mandatory parameter "salt"');if("contentToVerify"in e===!1)return Promise.reject('Absent mandatory parameter "contentToVerify"');if("signatureToVerify"in e===!1)return Promise.reject('Absent mandatory parameter "signatureToVerify"');let t;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:return Promise.reject(`Incorrect "parameters.hashAlgorithm" parameter: ${e.hashAlgorithm}`)}let r=Promise.resolve();const a={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}};return r=r.then(()=>d(this,e.hashAlgorithm,t,e.password,e.salt,e.iterationCount)),r=r.then(e=>this.importKey("raw",new Uint8Array(e),a,!1,["verify"])),r=r.then(t=>this.verify(a,t,new Uint8Array(e.signatureToVerify),new Uint8Array(e.contentToVerify)),e=>Promise.reject(e)),r}getSignatureParameters(e,t="SHA-1"){if(""===this.getOIDByAlgorithm({name:t}))return Promise.reject(`Unsupported hash algorithm: ${t}`);const r=new u.default,s=this.getAlgorithmParameters(e.algorithm.name,"sign");switch(s.algorithm.hash.name=t,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":r.algorithmId=this.getOIDByAlgorithm(s.algorithm);break;case"RSA-PSS":{switch(t.toUpperCase()){case"SHA-256":s.algorithm.saltLength=32;break;case"SHA-384":s.algorithm.saltLength=48;break;case"SHA-512":s.algorithm.saltLength=64}const e={};if("SHA-1"!==t.toUpperCase()){const r=this.getOIDByAlgorithm({name:t});if(""===r)return Promise.reject(`Unsupported hash algorithm: ${t}`);e.hashAlgorithm=new u.default({algorithmId:r,algorithmParams:new a.Null}),e.maskGenAlgorithm=new u.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:e.hashAlgorithm.toSchema()})}20!==s.algorithm.saltLength&&(e.saltLength=s.algorithm.saltLength);const i=new c.default(e);r.algorithmId="1.2.840.113549.1.1.10",r.algorithmParams=i.toSchema()}break;default:return Promise.reject(`Unsupported signature algorithm: ${e.algorithm.name}`)}return Promise.resolve().then(()=>({signatureAlgorithm:r,parameters:s}))}signWithPrivateKey(e,t,r){return this.sign(r.algorithm,t,new Uint8Array(e)).then(e=>("ECDSA"===r.algorithm.name&&(e=(0,i.createCMSECDSASignature)(e)),e),e=>Promise.reject(`Signing error: ${e}`))}fillPublicKeyParameters(e,t){const r={},a=this.getHashAlgorithm(t);if(""===a)return Promise.reject(`Unsupported signature algorithm: ${t.algorithmId}`);let s;s="1.2.840.113549.1.1.10"===t.algorithmId?t.algorithmId:e.algorithm.algorithmId;const i=this.getAlgorithmByOID(s);if("name"in i==="")return Promise.reject(`Unsupported public key algorithm: ${t.algorithmId}`);if(r.algorithm=this.getAlgorithmParameters(i.name,"importkey"),"hash"in r.algorithm.algorithm&&(r.algorithm.algorithm.hash.name=a),"ECDSA"===i.name){let t=!1;if("algorithmParams"in e.algorithm===!0&&"idBlock"in e.algorithm.algorithmParams&&1===e.algorithm.algorithmParams.idBlock.tagClass&&6===e.algorithm.algorithmParams.idBlock.tagNumber&&(t=!0),!1===t)return Promise.reject("Incorrect type for ECDSA public key parameters");const a=this.getAlgorithmByOID(e.algorithm.algorithmParams.valueBlock.toString());if("name"in a===!1)return Promise.reject(`Unsupported named curve algorithm: ${e.algorithm.algorithmParams.valueBlock.toString()}`);r.algorithm.algorithm.namedCurve=a.name}return r}getPublicKey(e,t,r=null){null===r&&(r=this.fillPublicKeyParameters(e,t));const a=e.toSchema().toBER(!1),s=new Uint8Array(a);return this.importKey("spki",s,r.algorithm.algorithm,!0,r.algorithm.usages)}verifyWithPublicKey(e,t,r,s,n=null){let o=Promise.resolve();if(null===n){if(""===(n=this.getHashAlgorithm(s)))return Promise.reject(`Unsupported signature algorithm: ${s.algorithmId}`);o=o.then(()=>this.getPublicKey(r,s))}else{const e={};let t;t="1.2.840.113549.1.1.10"===s.algorithmId?s.algorithmId:r.algorithm.algorithmId;const a=this.getAlgorithmByOID(t);if("name"in a==="")return Promise.reject(`Unsupported public key algorithm: ${s.algorithmId}`);if(e.algorithm=this.getAlgorithmParameters(a.name,"importkey"),"hash"in e.algorithm.algorithm&&(e.algorithm.algorithm.hash.name=n),"ECDSA"===a.name){let t=!1;if("algorithmParams"in r.algorithm===!0&&"idBlock"in r.algorithm.algorithmParams&&1===r.algorithm.algorithmParams.idBlock.tagClass&&6===r.algorithm.algorithmParams.idBlock.tagNumber&&(t=!0),!1===t)return Promise.reject("Incorrect type for ECDSA public key parameters");const a=this.getAlgorithmByOID(r.algorithm.algorithmParams.valueBlock.toString());if("name"in a===!1)return Promise.reject(`Unsupported named curve algorithm: ${r.algorithm.algorithmParams.valueBlock.toString()}`);e.algorithm.algorithm.namedCurve=a.name}o=o.then(()=>this.getPublicKey(r,null,e))}return o=o.then(r=>{const o=this.getAlgorithmParameters(r.algorithm.name,"verify");"hash"in o.algorithm&&(o.algorithm.hash.name=n);let u=t.valueBlock.valueHex;if("ECDSA"===r.algorithm.name){const e=a.fromBER(u);u=(0,i.createECDSASignatureFromCMS)(e.result)}if("RSA-PSS"===r.algorithm.name){let e;try{e=new c.default({schema:s.algorithmParams})}catch(l){return Promise.reject(l)}o.algorithm.saltLength="saltLength"in e?e.saltLength:20;let t="SHA-1";if("hashAlgorithm"in e){const r=this.getAlgorithmByOID(e.hashAlgorithm.algorithmId);if("name"in r===!1)return Promise.reject(`Unrecognized hash algorithm: ${e.hashAlgorithm.algorithmId}`);t=r.name}o.algorithm.hash.name=t}return this.verify(o.algorithm,r,new Uint8Array(u),new Uint8Array(e))}),o}}},eW67:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.x=(0,s.getParametersValue)(e,"x",i.defaultValues("x")),this.y=(0,s.getParametersValue)(e,"y",i.defaultValues("y")),this.namedCurve=(0,s.getParametersValue)(e,"namedCurve",i.defaultValues("namedCurve")),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"x":case"y":return new ArrayBuffer(0);case"namedCurve":return"";default:throw new Error(`Invalid member name for ECCPublicKey class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"x":case"y":return(0,s.isEqualBuffer)(t,i.defaultValues(e));case"namedCurve":return""===t;default:throw new Error(`Invalid member name for ECCPublicKey class: ${e}`)}}static schema(e={}){return new a.RawData}fromSchema(e){if(e instanceof ArrayBuffer===!1)throw new Error("Object's schema was not verified against input data for ECPublicKey");if(4!==new Uint8Array(e)[0])throw new Error("Object's schema was not verified against input data for ECPublicKey");let t;switch(this.namedCurve){case"1.2.840.10045.3.1.7":t=32;break;case"1.3.132.0.34":t=48;break;case"1.3.132.0.35":t=66;break;default:throw new Error(`Incorrect curve OID: ${this.namedCurve}`)}if(e.byteLength!==2*t+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.x=e.slice(1,t+1),this.y=e.slice(1+t,2*t+1)}toSchema(){return new a.RawData({data:(0,s.utilConcatBuf)(new Uint8Array([4]).buffer,this.x,this.y)})}toJSON(){let e="";switch(this.namedCurve){case"1.2.840.10045.3.1.7":e="P-256";break;case"1.3.132.0.34":e="P-384";break;case"1.3.132.0.35":e="P-521"}return{crv:e,x:(0,s.toBase64)((0,s.arrayBufferToString)(this.x),!0,!0,!1),y:(0,s.toBase64)((0,s.arrayBufferToString)(this.y),!0,!0,!1)}}fromJSON(e){let t=0;if(!("crv"in e))throw new Error('Absent mandatory parameter "crv"');switch(e.crv.toUpperCase()){case"P-256":this.namedCurve="1.2.840.10045.3.1.7",t=32;break;case"P-384":this.namedCurve="1.3.132.0.34",t=48;break;case"P-521":this.namedCurve="1.3.132.0.35",t=66}if(!("x"in e))throw new Error('Absent mandatory parameter "x"');{const r=(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.x,!0));if(r.byteLength<t){this.x=new ArrayBuffer(t);const e=new Uint8Array(this.x),a=new Uint8Array(r);e.set(a,1)}else this.x=r.slice(0,t)}if(!("y"in e))throw new Error('Absent mandatory parameter "y"');{const r=(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.y,!0));if(r.byteLength<t){this.y=new ArrayBuffer(t);const e=new Uint8Array(this.y),a=new Uint8Array(r);e.set(a,1)}else this.y=r.slice(0,t)}}}t.default=i},fC9T:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.templateID=(0,s.getParametersValue)(e,"templateID",i.defaultValues("templateID")),"templateMajorVersion"in e&&(this.templateMajorVersion=(0,s.getParametersValue)(e,"templateMajorVersion",i.defaultValues("templateMajorVersion"))),"templateMinorVersion"in e&&(this.templateMinorVersion=(0,s.getParametersValue)(e,"templateMinorVersion",i.defaultValues("templateMinorVersion"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"templateID":return"";case"templateMajorVersion":case"templateMinorVersion":return 0;default:throw new Error(`Invalid member name for CertificateTemplate class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.ObjectIdentifier({name:t.templateID||""}),new a.Integer({name:t.templateMajorVersion||"",optional:!0}),new a.Integer({name:t.templateMinorVersion||"",optional:!0})]})}fromSchema(e){(0,s.clearProps)(e,["templateID","templateMajorVersion","templateMinorVersion"]);let t=a.compareSchema(e,e,i.schema({names:{templateID:"templateID",templateMajorVersion:"templateMajorVersion",templateMinorVersion:"templateMinorVersion"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CertificateTemplate");this.templateID=t.result.templateID.valueBlock.toString(),"templateMajorVersion"in t.result&&(this.templateMajorVersion=t.result.templateMajorVersion.valueBlock.valueDec),"templateMinorVersion"in t.result&&(this.templateMinorVersion=t.result.templateMinorVersion.valueBlock.valueDec)}toSchema(){const e=[];return e.push(new a.ObjectIdentifier({value:this.templateID})),"templateMajorVersion"in this&&e.push(new a.Integer({value:this.templateMajorVersion})),"templateMinorVersion"in this&&e.push(new a.Integer({value:this.templateMinorVersion})),new a.Sequence({value:e})}toJSON(){const e={extnID:this.templateID};return"templateMajorVersion"in this&&(e.templateMajorVersion=this.templateMajorVersion),"templateMinorVersion"in this&&(e.templateMinorVersion=this.templateMinorVersion),e}}t.default=i},fYIA:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09"),i=l(r("px0U")),n=l(r("gilY")),o=l(r("wQ/7")),u=l(r("2jW+"));function l(e){return e&&e.__esModule?e:{default:e}}class c{constructor(e={}){this.version=(0,s.getParametersValue)(e,"version",c.defaultValues("version")),this.privateKeyAlgorithm=(0,s.getParametersValue)(e,"privateKeyAlgorithm",c.defaultValues("privateKeyAlgorithm")),this.privateKey=(0,s.getParametersValue)(e,"privateKey",c.defaultValues("privateKey")),"attributes"in e&&(this.attributes=(0,s.getParametersValue)(e,"attributes",c.defaultValues("attributes"))),"parsedKey"in e&&(this.parsedKey=(0,s.getParametersValue)(e,"parsedKey",c.defaultValues("parsedKey"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"version":return 0;case"privateKeyAlgorithm":return new i.default;case"privateKey":return new a.OctetString;case"attributes":return[];case"parsedKey":return{};default:throw new Error(`Invalid member name for PrivateKeyInfo class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.Integer({name:t.version||""}),i.default.schema(t.privateKeyAlgorithm||{}),new a.OctetString({name:t.privateKey||""}),new a.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new a.Repeated({name:t.attributes||"",value:n.default.schema()})]})]})}fromSchema(e){(0,s.clearProps)(e,["version","privateKeyAlgorithm","privateKey","attributes"]);const t=a.compareSchema(e,e,c.schema({names:{version:"version",privateKeyAlgorithm:{names:{blockName:"privateKeyAlgorithm"}},privateKey:"privateKey",attributes:"attributes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PrivateKeyInfo");switch(this.version=t.result.version.valueBlock.valueDec,this.privateKeyAlgorithm=new i.default({schema:t.result.privateKeyAlgorithm}),this.privateKey=t.result.privateKey,"attributes"in t.result&&(this.attributes=Array.from(t.result.attributes,e=>new n.default({schema:e}))),this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":{const e=a.fromBER(this.privateKey.valueBlock.valueHex);-1!==e.offset&&(this.parsedKey=new u.default({schema:e.result}))}break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm&&this.privateKeyAlgorithm.algorithmParams instanceof a.ObjectIdentifier){const e=a.fromBER(this.privateKey.valueBlock.valueHex);-1!==e.offset&&(this.parsedKey=new o.default({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:e.result}))}}}toSchema(){const e=[new a.Integer({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];return"attributes"in this&&e.push(new a.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,e=>e.toSchema())})),new a.Sequence({value:e})}toJSON(){if("parsedKey"in this===!1){const e={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};return"attributes"in this&&(e.attributes=Array.from(this.attributes,e=>e.toJSON())),e}const e={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();for(var r=0,a=Object.keys(t);r<a.length;r++){const s=a[r];e[s]=t[s]}return e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new o.default({json:e}),this.privateKeyAlgorithm=new i.default({algorithmId:"1.2.840.10045.2.1",algorithmParams:new a.ObjectIdentifier({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new u.default({json:e}),this.privateKeyAlgorithm=new i.default({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new a.Null});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.privateKey=new a.OctetString({valueHex:this.parsedKey.toSchema().toBER(!1)})}}}t.default=c},gilY:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.type=(0,s.getParametersValue)(e,"type",i.defaultValues("type")),this.values=(0,s.getParametersValue)(e,"values",i.defaultValues("values")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return"";case"values":return[];default:throw new Error(`Invalid member name for Attribute class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"type":return""===t;case"values":return 0===t.length;default:throw new Error(`Invalid member name for Attribute class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.ObjectIdentifier({name:t.type||""}),new a.Set({name:t.setName||"",value:[new a.Repeated({name:t.values||"",value:new a.Any})]})]})}fromSchema(e){(0,s.clearProps)(e,["type","values"]);const t=a.compareSchema(e,e,i.schema({names:{type:"type",values:"values"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Attribute");this.type=t.result.type.valueBlock.toString(),this.values=t.result.values}toSchema(){return new a.Sequence({value:[new a.ObjectIdentifier({value:this.type}),new a.Set({value:this.values})]})}toJSON(){return{type:this.type,values:Array.from(this.values,e=>e.toJSON())}}}t.default=i},kQfs:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.prime=(0,s.getParametersValue)(e,"prime",i.defaultValues("prime")),this.exponent=(0,s.getParametersValue)(e,"exponent",i.defaultValues("exponent")),this.coefficient=(0,s.getParametersValue)(e,"coefficient",i.defaultValues("coefficient")),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"prime":case"exponent":case"coefficient":return new a.Integer;default:throw new Error(`Invalid member name for OtherPrimeInfo class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.Integer({name:t.prime||""}),new a.Integer({name:t.exponent||""}),new a.Integer({name:t.coefficient||""})]})}fromSchema(e){(0,s.clearProps)(e,["prime","exponent","coefficient"]);const t=a.compareSchema(e,e,i.schema({names:{prime:"prime",exponent:"exponent",coefficient:"coefficient"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for OtherPrimeInfo");this.prime=t.result.prime.convertFromDER(),this.exponent=t.result.exponent.convertFromDER(),this.coefficient=t.result.coefficient.convertFromDER()}toSchema(){return new a.Sequence({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}toJSON(){return{r:(0,s.toBase64)((0,s.arrayBufferToString)(this.prime.valueBlock.valueHex),!0,!0),d:(0,s.toBase64)((0,s.arrayBufferToString)(this.exponent.valueBlock.valueHex),!0,!0),t:(0,s.toBase64)((0,s.arrayBufferToString)(this.coefficient.valueBlock.valueHex),!0,!0)}}fromJSON(e){if(!("r"in e))throw new Error('Absent mandatory parameter "r"');if(this.prime=new a.Integer({valueHex:(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.r,!0))}),!("d"in e))throw new Error('Absent mandatory parameter "d"');if(this.exponent=new a.Integer({valueHex:(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.d,!0))}),!("t"in e))throw new Error('Absent mandatory parameter "t"');this.coefficient=new a.Integer({valueHex:(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.t,!0))})}}t.default=i},kVyt:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){"requireExplicitPolicy"in e&&(this.requireExplicitPolicy=(0,s.getParametersValue)(e,"requireExplicitPolicy",i.defaultValues("requireExplicitPolicy"))),"inhibitPolicyMapping"in e&&(this.inhibitPolicyMapping=(0,s.getParametersValue)(e,"inhibitPolicyMapping",i.defaultValues("inhibitPolicyMapping"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"requireExplicitPolicy":case"inhibitPolicyMapping":return 0;default:throw new Error(`Invalid member name for PolicyConstraints class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.Primitive({name:t.requireExplicitPolicy||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new a.Primitive({name:t.inhibitPolicyMapping||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){(0,s.clearProps)(e,["requireExplicitPolicy","inhibitPolicyMapping"]);const t=a.compareSchema(e,e,i.schema({names:{requireExplicitPolicy:"requireExplicitPolicy",inhibitPolicyMapping:"inhibitPolicyMapping"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyConstraints");if("requireExplicitPolicy"in t.result){const e=t.result.requireExplicitPolicy;e.idBlock.tagClass=1,e.idBlock.tagNumber=2;const r=e.toBER(!1),s=a.fromBER(r);this.requireExplicitPolicy=s.result.valueBlock.valueDec}if("inhibitPolicyMapping"in t.result){const e=t.result.inhibitPolicyMapping;e.idBlock.tagClass=1,e.idBlock.tagNumber=2;const r=e.toBER(!1),s=a.fromBER(r);this.inhibitPolicyMapping=s.result.valueBlock.valueDec}}toSchema(){const e=[];if("requireExplicitPolicy"in this){const t=new a.Integer({value:this.requireExplicitPolicy});t.idBlock.tagClass=3,t.idBlock.tagNumber=0,e.push(t)}if("inhibitPolicyMapping"in this){const t=new a.Integer({value:this.inhibitPolicyMapping});t.idBlock.tagClass=3,t.idBlock.tagNumber=1,e.push(t)}return new a.Sequence({value:e})}toJSON(){const e={};return"requireExplicitPolicy"in this&&(e.requireExplicitPolicy=this.requireExplicitPolicy),"inhibitPolicyMapping"in this&&(e.inhibitPolicyMapping=this.inhibitPolicyMapping),e}}t.default=i},mOOK:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("px0U"))&&a.__esModule?a:{default:a};class o{constructor(e={}){if(this.contentType=(0,i.getParametersValue)(e,"contentType",o.defaultValues("contentType")),this.contentEncryptionAlgorithm=(0,i.getParametersValue)(e,"contentEncryptionAlgorithm",o.defaultValues("contentEncryptionAlgorithm")),"encryptedContent"in e&&(this.encryptedContent=e.encryptedContent,1===this.encryptedContent.idBlock.tagClass&&4===this.encryptedContent.idBlock.tagNumber&&!1===this.encryptedContent.idBlock.isConstructed)){const e=new s.OctetString({idBlock:{isConstructed:!0},isConstructed:!0});let t=0,r=this.encryptedContent.valueBlock.valueHex.byteLength;for(;r>0;){const a=new Uint8Array(this.encryptedContent.valueBlock.valueHex,t,t+1024>this.encryptedContent.valueBlock.valueHex.byteLength?this.encryptedContent.valueBlock.valueHex.byteLength-t:1024),i=new ArrayBuffer(a.length),n=new Uint8Array(i);for(let e=0;e<n.length;e++)n[e]=a[e];e.valueBlock.value.push(new s.OctetString({valueHex:i})),r-=a.length,t+=a.length}this.encryptedContent=e}"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"contentType":return"";case"contentEncryptionAlgorithm":return new n.default;case"encryptedContent":return new s.OctetString;default:throw new Error(`Invalid member name for EncryptedContentInfo class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"contentType":return""===t;case"contentEncryptionAlgorithm":return""===t.algorithmId&&"algorithmParams"in t===!1;case"encryptedContent":return t.isEqual(o.defaultValues(e));default:throw new Error(`Invalid member name for EncryptedContentInfo class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.ObjectIdentifier({name:t.contentType||""}),n.default.schema(t.contentEncryptionAlgorithm||{}),new s.Choice({value:[new s.Constructed({name:t.encryptedContent||"",idBlock:{tagClass:3,tagNumber:0},value:[new s.Repeated({value:new s.OctetString})]}),new s.Primitive({name:t.encryptedContent||"",idBlock:{tagClass:3,tagNumber:0}})]})]})}fromSchema(e){(0,i.clearProps)(e,["contentType","contentEncryptionAlgorithm","encryptedContent"]);const t=s.compareSchema(e,e,o.schema({names:{contentType:"contentType",contentEncryptionAlgorithm:{names:{blockName:"contentEncryptionAlgorithm"}},encryptedContent:"encryptedContent"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for EncryptedContentInfo");this.contentType=t.result.contentType.valueBlock.toString(),this.contentEncryptionAlgorithm=new n.default({schema:t.result.contentEncryptionAlgorithm}),"encryptedContent"in t.result&&(this.encryptedContent=t.result.encryptedContent,this.encryptedContent.idBlock.tagClass=1,this.encryptedContent.idBlock.tagNumber=4)}toSchema(){const e={isIndefiniteForm:!1},t=[];if(t.push(new s.ObjectIdentifier({value:this.contentType})),t.push(this.contentEncryptionAlgorithm.toSchema()),"encryptedContent"in this){e.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;const r=this.encryptedContent;r.idBlock.tagClass=3,r.idBlock.tagNumber=0,r.lenBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed,t.push(r)}return new s.Sequence({lenBlock:e,value:t})}toJSON(){const e={contentType:this.contentType,contentEncryptionAlgorithm:this.contentEncryptionAlgorithm.toJSON()};return"encryptedContent"in this&&(e.encryptedContent=this.encryptedContent.toJSON()),e}}t.default=o},mfyR:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.cA=(0,s.getParametersValue)(e,"cA",!1),"pathLenConstraint"in e&&(this.pathLenConstraint=(0,s.getParametersValue)(e,"pathLenConstraint",0)),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"cA":return!1;default:throw new Error(`Invalid member name for BasicConstraints class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.Boolean({optional:!0,name:t.cA||""}),new a.Integer({optional:!0,name:t.pathLenConstraint||""})]})}fromSchema(e){(0,s.clearProps)(e,["cA","pathLenConstraint"]);const t=a.compareSchema(e,e,i.schema({names:{cA:"cA",pathLenConstraint:"pathLenConstraint"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for BasicConstraints");"cA"in t.result&&(this.cA=t.result.cA.valueBlock.value),"pathLenConstraint"in t.result&&(t.result.pathLenConstraint.valueBlock.isHexOnly?this.pathLenConstraint=t.result.pathLenConstraint:this.pathLenConstraint=t.result.pathLenConstraint.valueBlock.valueDec)}toSchema(){const e=[];return this.cA!==i.defaultValues("cA")&&e.push(new a.Boolean({value:this.cA})),"pathLenConstraint"in this&&(this.pathLenConstraint instanceof a.Integer?e.push(this.pathLenConstraint):e.push(new a.Integer({value:this.pathLenConstraint}))),new a.Sequence({value:e})}toJSON(){const e={};return this.cA!==i.defaultValues("cA")&&(e.cA=this.cA),"pathLenConstraint"in this&&(this.pathLenConstraint instanceof a.Integer?e.pathLenConstraint=this.pathLenConstraint.toJSON():e.pathLenConstraint=this.pathLenConstraint),e}}t.default=i},pZts:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.QCStatement=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.id=(0,s.getParametersValue)(e,"id",i.defaultValues("id")),"type"in e&&(this.type=(0,s.getParametersValue)(e,"type",i.defaultValues("type"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"id":return"";case"type":return new a.Null;default:throw new Error(`Invalid member name for QCStatement class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"id":return""===t;case"type":return t instanceof a.Null;default:throw new Error(`Invalid member name for QCStatement class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.ObjectIdentifier({name:t.id||""}),new a.Any({name:t.type||"",optional:!0})]})}fromSchema(e){(0,s.clearProps)(e,["id","type"]);const t=a.compareSchema(e,e,i.schema({names:{id:"id",type:"type"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for QCStatement");this.id=t.result.id.valueBlock.toString(),"type"in t.result&&(this.type=t.result.type)}toSchema(){const e=[new a.ObjectIdentifier({value:this.id})];return"type"in this&&e.push(this.type),new a.Sequence({value:e})}toJSON(){const e={id:this.id};return"type"in this&&(e.type=this.type.toJSON()),e}}t.QCStatement=i;class n{constructor(e={}){this.values=(0,s.getParametersValue)(e,"values",n.defaultValues("values")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"values":return[];default:throw new Error(`Invalid member name for QCStatements class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"values":return 0===t.length;default:throw new Error(`Invalid member name for QCStatements class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.Repeated({name:t.values||"",value:i.schema(t.value||{})})]})}fromSchema(e){(0,s.clearProps)(e,["values"]);const t=a.compareSchema(e,e,n.schema({names:{values:"values"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for QCStatements");this.values=Array.from(t.result.values,e=>new i({schema:e}))}toSchema(){return new a.Sequence({value:Array.from(this.values,e=>e.toSchema())})}toJSON(){return{extensions:Array.from(this.values,e=>e.toJSON())}}}t.default=n},px0U:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.algorithmId=(0,s.getParametersValue)(e,"algorithmId",i.defaultValues("algorithmId")),"algorithmParams"in e&&(this.algorithmParams=(0,s.getParametersValue)(e,"algorithmParams",i.defaultValues("algorithmParams"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"algorithmId":return"";case"algorithmParams":return new a.Any;default:throw new Error(`Invalid member name for AlgorithmIdentifier class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"algorithmId":return""===t;case"algorithmParams":return t instanceof a.Any;default:throw new Error(`Invalid member name for AlgorithmIdentifier class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",optional:t.optional||!1,value:[new a.ObjectIdentifier({name:t.algorithmIdentifier||""}),new a.Any({name:t.algorithmParams||"",optional:!0})]})}fromSchema(e){(0,s.clearProps)(e,["algorithm","params"]);const t=a.compareSchema(e,e,i.schema({names:{algorithmIdentifier:"algorithm",algorithmParams:"params"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AlgorithmIdentifier");this.algorithmId=t.result.algorithm.valueBlock.toString(),"params"in t.result&&(this.algorithmParams=t.result.params)}toSchema(){const e=[];return e.push(new a.ObjectIdentifier({value:this.algorithmId})),"algorithmParams"in this&&this.algorithmParams instanceof a.Any===!1&&e.push(this.algorithmParams),new a.Sequence({value:e})}toJSON(){const e={algorithmId:this.algorithmId};return"algorithmParams"in this&&this.algorithmParams instanceof a.Any===!1&&(e.algorithmParams=this.algorithmParams.toJSON()),e}isEqual(e){return e instanceof i!==!1&&(this.algorithmId===e.algorithmId&&("algorithmParams"in this?"algorithmParams"in e&&JSON.stringify(this.algorithmParams)===JSON.stringify(e.algorithmParams):!("algorithmParams"in e)))}}t.default=i},rixF:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09");class i{constructor(e={}){this.modulus=(0,s.getParametersValue)(e,"modulus",i.defaultValues("modulus")),this.publicExponent=(0,s.getParametersValue)(e,"publicExponent",i.defaultValues("publicExponent")),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"modulus":case"publicExponent":return new a.Integer;default:throw new Error(`Invalid member name for RSAPublicKey class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.Integer({name:t.modulus||""}),new a.Integer({name:t.publicExponent||""})]})}fromSchema(e){(0,s.clearProps)(e,["modulus","publicExponent"]);const t=a.compareSchema(e,e,i.schema({names:{modulus:"modulus",publicExponent:"publicExponent"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RSAPublicKey");this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent}toSchema(){return new a.Sequence({value:[this.modulus.convertToDER(),this.publicExponent]})}toJSON(){return{n:(0,s.toBase64)((0,s.arrayBufferToString)(this.modulus.valueBlock.valueHex),!0,!0,!0),e:(0,s.toBase64)((0,s.arrayBufferToString)(this.publicExponent.valueBlock.valueHex),!0,!0,!0)}}fromJSON(e){if(!("n"in e))throw new Error('Absent mandatory parameter "n"');{const t=(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.n,!0));this.modulus=new a.Integer({valueHex:t.slice(0,Math.pow(2,(0,s.nearestPowerOf2)(t.byteLength)))})}if(!("e"in e))throw new Error('Absent mandatory parameter "e"');this.publicExponent=new a.Integer({valueHex:(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.e,!0)).slice(0,3)})}}t.default=i},"t7E/":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09"),i=o(r("5v3g")),n=o(r("K3UR"));function o(e){return e&&e.__esModule?e:{default:e}}class u{constructor(e={}){"distributionPoint"in e&&(this.distributionPoint=(0,s.getParametersValue)(e,"distributionPoint",u.defaultValues("distributionPoint"))),this.onlyContainsUserCerts=(0,s.getParametersValue)(e,"onlyContainsUserCerts",u.defaultValues("onlyContainsUserCerts")),this.onlyContainsCACerts=(0,s.getParametersValue)(e,"onlyContainsCACerts",u.defaultValues("onlyContainsCACerts")),"onlySomeReasons"in e&&(this.onlySomeReasons=(0,s.getParametersValue)(e,"onlySomeReasons",u.defaultValues("onlySomeReasons"))),this.indirectCRL=(0,s.getParametersValue)(e,"indirectCRL",u.defaultValues("indirectCRL")),this.onlyContainsAttributeCerts=(0,s.getParametersValue)(e,"onlyContainsAttributeCerts",u.defaultValues("onlyContainsAttributeCerts")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"distributionPoint":return[];case"onlyContainsUserCerts":case"onlyContainsCACerts":return!1;case"onlySomeReasons":return 0;case"indirectCRL":case"onlyContainsAttributeCerts":return!1;default:throw new Error(`Invalid member name for IssuingDistributionPoint class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[new a.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new a.Choice({value:[new a.Constructed({name:t.distributionPoint||"",idBlock:{tagClass:3,tagNumber:0},value:[new a.Repeated({name:t.distributionPointNames||"",value:i.default.schema()})]}),new a.Constructed({name:t.distributionPoint||"",idBlock:{tagClass:3,tagNumber:1},value:n.default.schema().valueBlock.value})]})]}),new a.Primitive({name:t.onlyContainsUserCerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new a.Primitive({name:t.onlyContainsCACerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new a.Primitive({name:t.onlySomeReasons||"",optional:!0,idBlock:{tagClass:3,tagNumber:3}}),new a.Primitive({name:t.indirectCRL||"",optional:!0,idBlock:{tagClass:3,tagNumber:4}}),new a.Primitive({name:t.onlyContainsAttributeCerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:5}})]})}fromSchema(e){(0,s.clearProps)(e,["distributionPoint","distributionPointNames","onlyContainsUserCerts","onlyContainsCACerts","onlySomeReasons","indirectCRL","onlyContainsAttributeCerts"]);const t=a.compareSchema(e,e,u.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",onlyContainsUserCerts:"onlyContainsUserCerts",onlyContainsCACerts:"onlyContainsCACerts",onlySomeReasons:"onlySomeReasons",indirectCRL:"indirectCRL",onlyContainsAttributeCerts:"onlyContainsAttributeCerts"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for IssuingDistributionPoint");if("distributionPoint"in t.result)switch(!0){case 0===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=Array.from(t.result.distributionPointNames,e=>new i.default({schema:e}));break;case 1===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=new n.default({schema:new a.Sequence({value:t.result.distributionPoint.valueBlock.value})});break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}if("onlyContainsUserCerts"in t.result){const e=new Uint8Array(t.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=0!==e[0]}if("onlyContainsCACerts"in t.result){const e=new Uint8Array(t.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=0!==e[0]}if("onlySomeReasons"in t.result){const e=new Uint8Array(t.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=e[0]}if("indirectCRL"in t.result){const e=new Uint8Array(t.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=0!==e[0]}if("onlyContainsAttributeCerts"in t.result){const e=new Uint8Array(t.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=0!==e[0]}}toSchema(){const e=[];if("distributionPoint"in this){let t;this.distributionPoint instanceof Array?t=new a.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,e=>e.toSchema())}):(t=this.distributionPoint.toSchema(),t.idBlock.tagClass=3,t.idBlock.tagNumber=1),e.push(new a.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(this.onlyContainsUserCerts!==u.defaultValues("onlyContainsUserCerts")&&e.push(new a.Primitive({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsCACerts!==u.defaultValues("onlyContainsCACerts")&&e.push(new a.Primitive({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer})),"onlySomeReasons"in this){const t=new ArrayBuffer(1);new Uint8Array(t)[0]=this.onlySomeReasons,e.push(new a.Primitive({idBlock:{tagClass:3,tagNumber:3},valueHex:t}))}return this.indirectCRL!==u.defaultValues("indirectCRL")&&e.push(new a.Primitive({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsAttributeCerts!==u.defaultValues("onlyContainsAttributeCerts")&&e.push(new a.Primitive({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer})),new a.Sequence({value:e})}toJSON(){const e={};return"distributionPoint"in this&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,e=>e.toJSON()):e.distributionPoint=this.distributionPoint.toJSON()),this.onlyContainsUserCerts!==u.defaultValues("onlyContainsUserCerts")&&(e.onlyContainsUserCerts=this.onlyContainsUserCerts),this.onlyContainsCACerts!==u.defaultValues("onlyContainsCACerts")&&(e.onlyContainsCACerts=this.onlyContainsCACerts),"onlySomeReasons"in this&&(e.onlySomeReasons=this.onlySomeReasons),this.indirectCRL!==u.defaultValues("indirectCRL")&&(e.indirectCRL=this.indirectCRL),this.onlyContainsAttributeCerts!==u.defaultValues("onlyContainsAttributeCerts")&&(e.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),e}}t.default=u},tZ8Z:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),s=r("OC09"),i=r("UM/M"),n=l(r("px0U")),o=l(r("eW67")),u=l(r("rixF"));function l(e){return e&&e.__esModule?e:{default:e}}class c{constructor(e={}){this.algorithm=(0,s.getParametersValue)(e,"algorithm",c.defaultValues("algorithm")),this.subjectPublicKey=(0,s.getParametersValue)(e,"subjectPublicKey",c.defaultValues("subjectPublicKey")),"parsedKey"in e&&(this.parsedKey=(0,s.getParametersValue)(e,"parsedKey",c.defaultValues("parsedKey"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"algorithm":return new n.default;case"subjectPublicKey":return new a.BitString;default:throw new Error(`Invalid member name for PublicKeyInfo class: ${e}`)}}static schema(e={}){const t=(0,s.getParametersValue)(e,"names",{});return new a.Sequence({name:t.blockName||"",value:[n.default.schema(t.algorithm||{}),new a.BitString({name:t.subjectPublicKey||""})]})}fromSchema(e){(0,s.clearProps)(e,["algorithm","subjectPublicKey"]);const t=a.compareSchema(e,e,c.schema({names:{algorithm:{names:{blockName:"algorithm"}},subjectPublicKey:"subjectPublicKey"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PublicKeyInfo");switch(this.algorithm=new n.default({schema:t.result.algorithm}),this.subjectPublicKey=t.result.subjectPublicKey,this.algorithm.algorithmId){case"1.2.840.10045.2.1":if("algorithmParams"in this.algorithm&&this.algorithm.algorithmParams.constructor.blockName()===a.ObjectIdentifier.blockName())try{this.parsedKey=new o.default({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHex})}catch(r){}break;case"1.2.840.113549.1.1.1":{const e=a.fromBER(this.subjectPublicKey.valueBlock.valueHex);if(-1!==e.offset)try{this.parsedKey=new u.default({schema:e.result})}catch(r){}}}}toSchema(){return new a.Sequence({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}toJSON(){if("parsedKey"in this===!1)return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()};const e={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();for(var r=0,a=Object.keys(t);r<a.length;r++){const s=a[r];e[s]=t[s]}return e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new o.default({json:e}),this.algorithm=new n.default({algorithmId:"1.2.840.10045.2.1",algorithmParams:new a.ObjectIdentifier({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new u.default({json:e}),this.algorithm=new n.default({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new a.Null});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.subjectPublicKey=new a.BitString({valueHex:this.parsedKey.toSchema().toBER(!1)})}}importKey(e){let t=Promise.resolve();const r=this;if("undefined"===typeof e)return Promise.reject("Need to provide publicKey input parameter");const s=(0,i.getCrypto)();return"undefined"===typeof s?Promise.reject("Unable to create WebCrypto object"):(t=t.then(()=>s.exportKey("spki",e)),t=t.then(e=>{const t=a.fromBER(e);try{r.fromSchema(t.result)}catch(s){return Promise.reject("Error during initializing object from schema")}},e=>Promise.reject(`Error during exporting public key: ${e}`)),t)}}t.default=c},uHtI:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("px0U"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.salt=(0,i.getParametersValue)(e,"salt",o.defaultValues("salt")),this.iterationCount=(0,i.getParametersValue)(e,"iterationCount",o.defaultValues("iterationCount")),"keyLength"in e&&(this.keyLength=(0,i.getParametersValue)(e,"keyLength",o.defaultValues("keyLength"))),"prf"in e&&(this.prf=(0,i.getParametersValue)(e,"prf",o.defaultValues("prf"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"salt":return{};case"iterationCount":return-1;case"keyLength":return 0;case"prf":return new n.default({algorithmId:"1.3.14.3.2.26",algorithmParams:new s.Null});default:throw new Error(`Invalid member name for PBKDF2Params class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Choice({value:[new s.OctetString({name:t.saltPrimitive||""}),n.default.schema(t.saltConstructed||{})]}),new s.Integer({name:t.iterationCount||""}),new s.Integer({name:t.keyLength||"",optional:!0}),n.default.schema(t.prf||{names:{optional:!0}})]})}fromSchema(e){(0,i.clearProps)(e,["salt","iterationCount","keyLength","prf"]);const t=s.compareSchema(e,e,o.schema({names:{saltPrimitive:"salt",saltConstructed:{names:{blockName:"salt"}},iterationCount:"iterationCount",keyLength:"keyLength",prf:{names:{blockName:"prf",optional:!0}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PBKDF2Params");this.salt=t.result.salt,this.iterationCount=t.result.iterationCount.valueBlock.valueDec,"keyLength"in t.result&&(this.keyLength=t.result.keyLength.valueBlock.valueDec),"prf"in t.result&&(this.prf=new n.default({schema:t.result.prf}))}toSchema(){const e=[];return e.push(this.salt),e.push(new s.Integer({value:this.iterationCount})),"keyLength"in this&&o.defaultValues("keyLength")!==this.keyLength&&e.push(new s.Integer({value:this.keyLength})),"prf"in this&&!1===o.defaultValues("prf").isEqual(this.prf)&&e.push(this.prf.toSchema()),new s.Sequence({value:e})}toJSON(){const e={salt:this.salt.toJSON(),iterationCount:this.iterationCount};return"keyLength"in this&&o.defaultValues("keyLength")!==this.keyLength&&(e.keyLength=this.keyLength),"prf"in this&&!1===o.defaultValues("prf").isEqual(this.prf)&&(e.prf=this.prf.toJSON()),e}}t.default=o},"wQ/7":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("eW67"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.version=(0,i.getParametersValue)(e,"version",o.defaultValues("version")),this.privateKey=(0,i.getParametersValue)(e,"privateKey",o.defaultValues("privateKey")),"namedCurve"in e&&(this.namedCurve=(0,i.getParametersValue)(e,"namedCurve",o.defaultValues("namedCurve"))),"publicKey"in e&&(this.publicKey=(0,i.getParametersValue)(e,"publicKey",o.defaultValues("publicKey"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"version":return 1;case"privateKey":return new s.OctetString;case"namedCurve":return"";case"publicKey":return new n.default;default:throw new Error(`Invalid member name for ECCPrivateKey class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"version":return t===o.defaultValues(e);case"privateKey":return t.isEqual(o.defaultValues(e));case"namedCurve":return""===t;case"publicKey":return n.default.compareWithDefault("namedCurve",t.namedCurve)&&n.default.compareWithDefault("x",t.x)&&n.default.compareWithDefault("y",t.y);default:throw new Error(`Invalid member name for ECCPrivateKey class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.version||""}),new s.OctetString({name:t.privateKey||""}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.ObjectIdentifier({name:t.namedCurve||""})]}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.BitString({name:t.publicKey||""})]})]})}fromSchema(e){(0,i.clearProps)(e,["version","privateKey","namedCurve","publicKey"]);const t=s.compareSchema(e,e,o.schema({names:{version:"version",privateKey:"privateKey",namedCurve:"namedCurve",publicKey:"publicKey"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for ECPrivateKey");if(this.version=t.result.version.valueBlock.valueDec,this.privateKey=t.result.privateKey,"namedCurve"in t.result&&(this.namedCurve=t.result.namedCurve.valueBlock.toString()),"publicKey"in t.result){const e={schema:t.result.publicKey.valueBlock.valueHex};"namedCurve"in this&&(e.namedCurve=this.namedCurve),this.publicKey=new n.default(e)}}toSchema(){const e=[new s.Integer({value:this.version}),this.privateKey];return"namedCurve"in this&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new s.ObjectIdentifier({value:this.namedCurve})]})),"publicKey"in this&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[new s.BitString({valueHex:this.publicKey.toSchema().toBER(!1)})]})),new s.Sequence({value:e})}toJSON(){if("namedCurve"in this===!1||o.compareWithDefault("namedCurve",this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');let e="";switch(this.namedCurve){case"1.2.840.10045.3.1.7":e="P-256";break;case"1.3.132.0.34":e="P-384";break;case"1.3.132.0.35":e="P-521"}const t={crv:e,d:(0,i.toBase64)((0,i.arrayBufferToString)(this.privateKey.valueBlock.valueHex),!0,!0,!1)};if("publicKey"in this){const e=this.publicKey.toJSON();t.x=e.x,t.y=e.y}return t}fromJSON(e){let t=0;if(!("crv"in e))throw new Error('Absent mandatory parameter "crv"');switch(e.crv.toUpperCase()){case"P-256":this.namedCurve="1.2.840.10045.3.1.7",t=32;break;case"P-384":this.namedCurve="1.3.132.0.34",t=48;break;case"P-521":this.namedCurve="1.3.132.0.35",t=66}if(!("d"in e))throw new Error('Absent mandatory parameter "d"');{const r=(0,i.stringToArrayBuffer)((0,i.fromBase64)(e.d,!0));if(r.byteLength<t){const e=new ArrayBuffer(t),a=new Uint8Array(e),i=new Uint8Array(r);a.set(i,1),this.privateKey=new s.OctetString({valueHex:e})}else this.privateKey=new s.OctetString({valueHex:r.slice(0,t)})}"x"in e&&"y"in e&&(this.publicKey=new n.default({json:e}))}}t.default=o},yfdt:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("87r+"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.accessDescriptions=(0,i.getParametersValue)(e,"accessDescriptions",o.defaultValues("accessDescriptions")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"accessDescriptions":return[];default:throw new Error(`Invalid member name for InfoAccess class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.accessDescriptions||"",value:n.default.schema()})]})}fromSchema(e){(0,i.clearProps)(e,["accessDescriptions"]);const t=s.compareSchema(e,e,o.schema({names:{accessDescriptions:"accessDescriptions"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for InfoAccess");this.accessDescriptions=Array.from(t.result.accessDescriptions,e=>new n.default({schema:e}))}toSchema(){return new s.Sequence({value:Array.from(this.accessDescriptions,e=>e.toSchema())})}toJSON(){return{accessDescriptions:Array.from(this.accessDescriptions,e=>e.toJSON())}}}t.default=o},yxVI:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};a.get||a.set?Object.defineProperty(t,r,a):t[r]=e[r]}return t.default=e,t}(r("aBBb")),i=r("OC09"),n=(a=r("NejM"))&&a.__esModule?a:{default:a};class o{constructor(e={}){this.mappings=(0,i.getParametersValue)(e,"mappings",o.defaultValues("mappings")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"mappings":return[];default:throw new Error(`Invalid member name for PolicyMappings class: ${e}`)}}static schema(e={}){const t=(0,i.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.mappings||"",value:n.default.schema()})]})}fromSchema(e){(0,i.clearProps)(e,["mappings"]);const t=s.compareSchema(e,e,o.schema({names:{mappings:"mappings"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyMappings");this.mappings=Array.from(t.result.mappings,e=>new n.default({schema:e}))}toSchema(){return new s.Sequence({value:Array.from(this.mappings,e=>e.toSchema())})}toJSON(){return{mappings:Array.from(this.mappings,e=>e.toJSON())}}}t.default=o}}]);