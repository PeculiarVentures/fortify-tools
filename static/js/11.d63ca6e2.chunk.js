(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[11],{151:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(33),a=r(56);var i=r(57);function o(e,t,r){return(o=Object(i.a)()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&Object(a.a)(i,r.prototype),i}).apply(null,arguments)}function u(e){var t="function"===typeof Map?new Map:void 0;return(u=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return o(e,arguments,Object(n.a)(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Object(a.a)(i,e)})(e)}},331:function(e,t,r){"use strict";r.r(t);var n=r(21),a=r(40),i=r(63),o=r(11),u=r(34),c=r(12),s=r(151),l=r(58),h=r(33),f=r(9),v=r(10),y=r(27),p=r(7),b=r(8);!function(e,t,r,d){var g;var k,m=function(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}(r),w=(k={})&&"object"===typeof k&&"default"in k?k:{default:k},O={};"undefined"!==typeof self&&(O=self),e.nativeCrypto=O.msCrypto||O.crypto||{},e.nativeSubtle=null;try{e.nativeSubtle=(null===e.nativeCrypto||void 0===e.nativeCrypto?void 0:e.nativeCrypto.subtle)||(null===e.nativeCrypto||void 0===e.nativeCrypto?void 0:e.nativeCrypto.webkitSubtle)||null}catch(on){console.warn("Cannot get subtle from crypto",on)}var B=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"isArrayBuffer",value:function(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}},{key:"toArrayBuffer",value:function(e){var t=this.toUint8Array(e);return t.byteOffset||t.length?t.buffer.slice(t.byteOffset,t.byteOffset+t.length):t.buffer}},{key:"toUint8Array",value:function(e){if("undefined"!==typeof Buffer&&Buffer.isBuffer(e))return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);if(this.isArrayBuffer(e))return new Uint8Array(e);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}},{key:"isBufferSource",value:function(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}},{key:"isArrayBufferView",value:function(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}}]),e}();function A(e){return"undefined"!==typeof Buffer&&Buffer.isBuffer(e)?new Uint8Array(e):B.isArrayBufferView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var j=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"isHex",value:function(e){return"string"===typeof e&&/^[a-z0-9]+$/i.test(e)}},{key:"isBase64",value:function(e){return"string"===typeof e&&/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},{key:"isBase64Url",value:function(e){return"string"===typeof e&&/^[a-zA-Z0-9-_]+$/i.test(e)}},{key:"ToString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=A(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);default:throw new Error("Unknown type of encoding '".concat(t,"'"))}}},{key:"FromString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);default:throw new Error("Unknown type of encoding '".concat(t,"'"))}}},{key:"ToBase64",value:function(e){var t=A(e);if("undefined"!==typeof btoa){var r=this.ToString(t,"binary");return btoa(r)}return Buffer.from(t).toString("base64")}},{key:"FromBase64",value:function(t){var r=this.formatString(t);if(!r)return new ArrayBuffer(0);if(!e.isBase64(r))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!==typeof atob?this.FromBinary(atob(r)):new Uint8Array(Buffer.from(r,"base64")).buffer}},{key:"FromBase64Url",value:function(t){var r=this.formatString(t);if(!r)return new ArrayBuffer(0);if(!e.isBase64Url(r))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(r.replace(/\-/g,"+").replace(/\_/g,"/")))}},{key:"ToBase64Url",value:function(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}},{key:"FromUtf8String",value:function(e){for(var t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r.buffer}},{key:"ToUtf8String",value:function(e){var t=A(e),r=String.fromCharCode.apply(null,t);return decodeURIComponent(escape(r))}},{key:"FromBinary",value:function(e){for(var t=e.length,r=new Uint8Array(t),n=0;n<t;n++)r[n]=e.charCodeAt(n);return r.buffer}},{key:"ToBinary",value:function(e){for(var t=A(e),r="",n=t.length,a=0;a<n;a++)r+=String.fromCharCode(t[a]);return r}},{key:"ToHex",value:function(e){for(var t=A(e),r=[],n=t.length,a=0;a<n;a++){var i=t[a].toString(16);r.push(1===i.length?"0"+i:i)}return r.join("")}},{key:"FromHex",value:function(t){var r=this.formatString(t);if(!r)return new ArrayBuffer(0);if(!e.isHex(r))throw new TypeError("Argument 'hexString' is not HEX encoded");r.length%2&&(r="0".concat(r));for(var n=new Uint8Array(r.length/2),a=0;a<r.length;a+=2){var i=r.slice(a,a+2);n[a/2]=parseInt(i,16)}return n.buffer}},{key:"Base64Padding",value:function(e){var t=4-e.length%4;if(t<4)for(var r=0;r<t;r++)e+="=";return e}},{key:"formatString",value:function(e){return(null===e||void 0===e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}]),e}();function x(e,t,r,n){var a,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o}function S(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(k){i(k)}}function u(e){try{c(n.throw(e))}catch(k){i(k)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}c((n=n.apply(e,t||[])).next())}))}function C(e){var t={exports:{}};return e(t,t.exports),t.exports}function K(e,t){var r=0;if(1===e.length)return e[0];for(var n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function E(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=r,a=e,i=0,o=Math.pow(2,t),u=1;u<8;u++){if(e<o){var c=void 0;if(n<0)c=new ArrayBuffer(u),i=u;else{if(n<u)return new ArrayBuffer(0);c=new ArrayBuffer(n),i=n}for(var s=new Uint8Array(c),l=u-1;l>=0;l--){var h=Math.pow(2,l*t);s[i-l-1]=Math.floor(a/h),a-=s[i-l-1]*h}return c}o*=Math.pow(2,t)}return new ArrayBuffer(0)}var N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";var P=Math.log(2);var L,H,I,T=function(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t}(Object.freeze({__proto__:null,getUTCDate:function(e){return new Date(e.getTime()+6e4*e.getTimezoneOffset())},getParametersValue:function(e,t,r){return e instanceof Object===!1?r:t in e?e[t]:r},bufferToHexCodes:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength-r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i="",o=Object(y.a)(new Uint8Array(e,r,n));try{for(o.s();!(t=o.n()).done;){var u=t.value,c=u.toString(16).toUpperCase();1===c.length&&(i+="0"),i+=c,a&&(i+=" ")}}catch(on){o.e(on)}finally{o.f()}return i.trim()},checkBufferParams:function(e,t,r,n){return t instanceof ArrayBuffer===!1?(e.error='Wrong parameter: inputBuffer must be "ArrayBuffer"',!1):0===t.byteLength?(e.error="Wrong parameter: inputBuffer has zero length",!1):r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1)},utilFromBase:K,utilToBase:E,utilConcatBuf:function(){for(var e=0,t=0,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];for(var i=0,o=n;i<o.length;i++){var u=o[i];e+=u.byteLength}for(var c=new ArrayBuffer(e),s=new Uint8Array(c),l=0,h=n;l<h.length;l++){var f=h[l];s.set(new Uint8Array(f),t),t+=f.byteLength}return c},utilConcatView:function(){for(var e=0,t=0,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];for(var i=0,o=n;i<o.length;i++){var u=o[i];e+=u.length}for(var c=new ArrayBuffer(e),s=new Uint8Array(c),l=0,h=n;l<h.length;l++){var f=h[l];s.set(f,t),t+=f.length}return s},utilDecodeTC:function(){var e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){var t=255===e[0]&&128&e[1],r=0===e[0]&&0===(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}for(var n=new ArrayBuffer(this.valueHex.byteLength),a=new Uint8Array(n),i=0;i<this.valueHex.byteLength;i++)a[i]=0;a[0]=128&e[0];for(var o=K(a,8),u=new ArrayBuffer(this.valueHex.byteLength),c=new Uint8Array(u),s=0;s<this.valueHex.byteLength;s++)c[s]=e[s];return c[0]&=127,K(c,8)-o},utilEncodeTC:function(e){for(var t=e<0?-1*e:e,r=128,n=1;n<8;n++){if(t<=r){if(e<0){var a=E(r-t,8,n);return new Uint8Array(a)[0]|=128,a}var i=E(t,8,n),o=new Uint8Array(i);if(128&o[0]){var u=i.slice(0),c=new Uint8Array(u);i=new ArrayBuffer(i.byteLength+1),o=new Uint8Array(i);for(var s=0;s<u.byteLength;s++)o[s+1]=c[s];o[0]=0}return i}r*=Math.pow(2,8)}return new ArrayBuffer(0)},isEqualBuffer:function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=new Uint8Array(e),n=new Uint8Array(t),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0},padNumber:function(e,t){var r=e.toString(10);if(t<r.length)return"";for(var n=t-r.length,a=new Array(n),i=0;i<n;i++)a[i]="0";return a.join("").concat(r)},toBase64:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=0,i=0,o=0,u="",c=t?U:N;if(n){for(var s=0,l=0;l<e.length;l++)if(0!==e.charCodeAt(l)){s=l;break}e=e.slice(s)}for(;a<e.length;){var h=e.charCodeAt(a++);a>=e.length&&(i=1);var f=e.charCodeAt(a++);a>=e.length&&(o=1);var v=e.charCodeAt(a++),y=h>>2,p=(3&h)<<4|f>>4,b=(15&f)<<2|v>>6,d=63&v;1===i?b=d=64:1===o&&(d=64),u+=r?64===b?"".concat(c.charAt(y)).concat(c.charAt(p)):64===d?"".concat(c.charAt(y)).concat(c.charAt(p)).concat(c.charAt(b)):"".concat(c.charAt(y)).concat(c.charAt(p)).concat(c.charAt(b)).concat(c.charAt(d)):"".concat(c.charAt(y)).concat(c.charAt(p)).concat(c.charAt(b)).concat(c.charAt(d))}return u},fromBase64:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t?U:N;function a(e){for(var t=0;t<64;t++)if(n.charAt(t)===e)return t;return 64}function i(e){return 64===e?0:e}for(var o=0,u="";o<e.length;){var c=a(e.charAt(o++)),s=o>=e.length?0:a(e.charAt(o++)),l=o>=e.length?0:a(e.charAt(o++)),h=o>=e.length?0:a(e.charAt(o++)),f=i(c)<<2|i(s)>>4,v=(15&i(s))<<4|i(l)>>2,y=(3&i(l))<<6|i(h);u+=String.fromCharCode(f),64!==l&&(u+=String.fromCharCode(v)),64!==h&&(u+=String.fromCharCode(y))}if(r){for(var p=u.length,b=-1,d=p-1;d>=0;d--)if(0!==u.charCodeAt(d)){b=d;break}u=-1!==b?u.slice(0,b+1):""}return u},arrayBufferToString:function(e){var t,r="",n=new Uint8Array(e),a=Object(y.a)(n);try{for(a.s();!(t=a.n()).done;){var i=t.value;r+=String.fromCharCode(i)}}catch(on){a.e(on)}finally{a.f()}return r},stringToArrayBuffer:function(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),a=0;a<t;a++)n[a]=e.charCodeAt(a);return r},nearestPowerOf2:function(e){var t=Math.log(e)/P,r=Math.floor(t),n=Math.round(t);return r===n?r:n},clearProps:function(e,t){var r,n=Object(y.a)(t);try{for(n.s();!(r=n.n()).done;){delete e[r.value]}}catch(on){n.e(on)}finally{n.f()}}})),R=C((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fromBER=be,t.compareSchema=de,t.verifySchema=function(e,t){if(t instanceof Object===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};var r=be(e);if(-1===r.offset)return{verified:!1,result:r.result};return de(r.result,r.result,t)},t.fromJSON=function(e){},t.RawData=t.Repeated=t.Any=t.Choice=t.TIME=t.Duration=t.DateTime=t.TimeOfDay=t.DATE=t.GeneralizedTime=t.UTCTime=t.CharacterString=t.GeneralString=t.VisibleString=t.GraphicString=t.IA5String=t.VideotexString=t.TeletexString=t.PrintableString=t.NumericString=t.UniversalString=t.BmpString=t.RelativeObjectIdentifier=t.Utf8String=t.ObjectIdentifier=t.Enumerated=t.Integer=t.BitString=t.OctetString=t.Null=t.Set=t.Sequence=t.Boolean=t.EndOfContent=t.Constructed=t.Primitive=t.BaseBlock=t.ValueBlock=t.HexBlock=void 0;var r=[new Uint8Array([1])],n="0123456789",a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(p.a)(this,e),this.blockLength=(0,T.getParametersValue)(t,"blockLength",0),this.error=(0,T.getParametersValue)(t,"error",""),this.warnings=(0,T.getParametersValue)(t,"warnings",[]),this.valueBeforeDecode="valueBeforeDecode"in t?t.valueBeforeDecode.slice(0):new ArrayBuffer(0)}return Object(b.a)(e,[{key:"toJSON",value:function(){return{blockName:this.constructor.blockName(),blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:(0,T.bufferToHexCodes)(this.valueBeforeDecode,0,this.valueBeforeDecode.byteLength)}}}],[{key:"blockName",value:function(){return"baseBlock"}}]),e}(),i=function(e){return function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).isHexOnly=(0,T.getParametersValue)(n,"isHexOnly",!1),e.valueHex="valueHex"in n?n.valueHex.slice(0):new ArrayBuffer(0),e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){return!1===(0,T.checkBufferParams)(this,e,t,r)?-1:0===new Uint8Array(e,t,r).length?(this.warnings.push("Zero buffer length"),t):(this.valueHex=e.slice(t,t+r),this.blockLength=r,t+r)}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!0!==this.isHexOnly?(this.error='Flag "isHexOnly" is not set, abort',new ArrayBuffer(0)):!0===e?new ArrayBuffer(this.valueHex.byteLength):this.valueHex.slice(0)}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.blockName=this.constructor.blockName(),e.isHexOnly=this.isHexOnly,e.valueHex=(0,T.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}],[{key:"blockName",value:function(){return"hexBlock"}}]),r}(e)};t.HexBlock=i;var o=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),e=t.call(this),"idBlock"in n?(e.isHexOnly=(0,T.getParametersValue)(n.idBlock,"isHexOnly",!1),e.valueHex=(0,T.getParametersValue)(n.idBlock,"valueHex",new ArrayBuffer(0)),e.tagClass=(0,T.getParametersValue)(n.idBlock,"tagClass",-1),e.tagNumber=(0,T.getParametersValue)(n.idBlock,"tagNumber",-1),e.isConstructed=(0,T.getParametersValue)(n.idBlock,"isConstructed",!1)):(e.tagClass=-1,e.tagNumber=-1,e.isConstructed=!1),e}return Object(b.a)(r,[{key:"toBER",value:function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=0;switch(this.tagClass){case 1:n|=0;break;case 2:n|=64;break;case 3:n|=128;break;case 4:n|=192;break;default:return this.error="Unknown tag class",new ArrayBuffer(0)}if(this.isConstructed&&(n|=32),this.tagNumber<31&&!this.isHexOnly){if(e=new ArrayBuffer(1),t=new Uint8Array(e),!r){var a=this.tagNumber;n|=a&=31,t[0]=n}return e}if(!1===this.isHexOnly){var i=(0,T.utilToBase)(this.tagNumber,7),o=new Uint8Array(i),u=i.byteLength;if(e=new ArrayBuffer(u+1),(t=new Uint8Array(e))[0]=31|n,!r){for(var c=0;c<u-1;c++)t[c+1]=128|o[c];t[u]=o[u-1]}return e}if(e=new ArrayBuffer(this.valueHex.byteLength+1),(t=new Uint8Array(e))[0]=31|n,!1===r){for(var s=new Uint8Array(this.valueHex),l=0;l<s.length-1;l++)t[l+1]=128|s[l];t[this.valueHex.byteLength]=s[s.length-1]}return e}},{key:"fromBER",value:function(e,t,r){if(!1===(0,T.checkBufferParams)(this,e,t,r))return-1;var n=new Uint8Array(e,t,r);if(0===n.length)return this.error="Zero buffer length",-1;switch(192&n[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32===(32&n[0]),this.isHexOnly=!1;var a=31&n[0];if(31!==a)this.tagNumber=a,this.blockLength=1;else{var i=1;this.valueHex=new ArrayBuffer(255);for(var o=255,u=new Uint8Array(this.valueHex);128&n[i];){if(u[i-1]=127&n[i],++i>=n.length)return this.error="End of input reached before message was fully decoded",-1;if(i===o){o+=255;for(var c=new ArrayBuffer(o),s=new Uint8Array(c),l=0;l<u.length;l++)s[l]=u[l];this.valueHex=new ArrayBuffer(o),u=new Uint8Array(this.valueHex)}}this.blockLength=i+1,u[i-1]=127&n[i];for(var h=new ArrayBuffer(i),f=new Uint8Array(h),v=0;v<i;v++)f[v]=u[v];this.valueHex=new ArrayBuffer(i),(u=new Uint8Array(this.valueHex)).set(f),this.blockLength<=9?this.tagNumber=(0,T.utilFromBase)(u,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.blockName=this.constructor.blockName(),e.tagClass=this.tagClass,e.tagNumber=this.tagNumber,e.isConstructed=this.isConstructed,e}}],[{key:"blockName",value:function(){return"identificationBlock"}}]),r}(i(a)),u=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),e=t.call(this),"lenBlock"in n?(e.isIndefiniteForm=(0,T.getParametersValue)(n.lenBlock,"isIndefiniteForm",!1),e.longFormUsed=(0,T.getParametersValue)(n.lenBlock,"longFormUsed",!1),e.length=(0,T.getParametersValue)(n.lenBlock,"length",0)):(e.isIndefiniteForm=!1,e.longFormUsed=!1,e.length=0),e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){if(!1===(0,T.checkBufferParams)(this,e,t,r))return-1;var n=new Uint8Array(e,t,r);if(0===n.length)return this.error="Zero buffer length",-1;if(255===n[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===n[0],!0===this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&n[0]),!1===this.longFormUsed)return this.length=n[0],this.blockLength=1,t+this.blockLength;var a=127&n[0];if(a>8)return this.error="Too big integer",-1;if(a+1>n.length)return this.error="End of input reached before message was fully decoded",-1;for(var i=new Uint8Array(a),o=0;o<a;o++)i[o]=n[o+1];return 0===i[a-1]&&this.warnings.push("Needlessly long encoded length"),this.length=(0,T.utilFromBase)(i,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unneccesary usage of long length form"),this.blockLength=a+1,t+this.blockLength}},{key:"toBER",value:function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return e=new ArrayBuffer(1),!1===r&&((t=new Uint8Array(e))[0]=128),e;if(!0===this.longFormUsed){var n=(0,T.utilToBase)(this.length,8);if(n.byteLength>127)return this.error="Too big length",new ArrayBuffer(0);if(e=new ArrayBuffer(n.byteLength+1),!0===r)return e;var a=new Uint8Array(n);(t=new Uint8Array(e))[0]=128|n.byteLength;for(var i=0;i<n.byteLength;i++)t[i+1]=a[i];return e}return e=new ArrayBuffer(1),!1===r&&((t=new Uint8Array(e))[0]=this.length),e}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.blockName=this.constructor.blockName(),e.isIndefiniteForm=this.isIndefiniteForm,e.longFormUsed=this.longFormUsed,e.length=this.length,e}}],[{key:"blockName",value:function(){return"lengthBlock"}}]),r}(a),c=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),t.call(this,e)}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}},{key:"toBER",value:function(){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}}],[{key:"blockName",value:function(){return"valueBlock"}}]),r}(a);t.ValueBlock=c;var s=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;return Object(p.a)(this,r),e=t.call(this,n),"name"in n&&(e.name=n.name),"optional"in n&&(e.optional=n.optional),"primitiveSchema"in n&&(e.primitiveSchema=n.primitiveSchema),e.idBlock=new o(n),e.lenBlock=new u(n),e.valueBlock=new a(n),e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"toBER",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.idBlock.toBER(t),n=this.valueBlock.toBER(!0);this.lenBlock.length=n.byteLength;var a,i=this.lenBlock.toBER(t);if(e=(0,T.utilConcatBuf)(r,i),a=!1===t?this.valueBlock.toBER(t):new ArrayBuffer(this.lenBlock.length),e=(0,T.utilConcatBuf)(e,a),!0===this.lenBlock.isIndefiniteForm){var o=new ArrayBuffer(2);if(!1===t){var u=new Uint8Array(o);u[0]=0,u[1]=0}e=(0,T.utilConcatBuf)(e,o)}return e}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.idBlock=this.idBlock.toJSON(),e.lenBlock=this.lenBlock.toJSON(),e.valueBlock=this.valueBlock.toJSON(),"name"in this&&(e.name=this.name),"optional"in this&&(e.optional=this.optional),"primitiveSchema"in this&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}}],[{key:"blockName",value:function(){return"BaseBlock"}}]),r}(a);t.BaseBlock=s;var y=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).valueHex="valueHex"in n?n.valueHex.slice(0):new ArrayBuffer(0),e.isHexOnly=(0,T.getParametersValue)(n,"isHexOnly",!0),e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){if(!1===(0,T.checkBufferParams)(this,e,t,r))return-1;var n=new Uint8Array(e,t,r);if(0===n.length)return this.warnings.push("Zero buffer length"),t;this.valueHex=new ArrayBuffer(n.length);for(var a=new Uint8Array(this.valueHex),i=0;i<n.length;i++)a[i]=n[i];return this.blockLength=r,t+r}},{key:"toBER",value:function(){return this.valueHex.slice(0)}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.valueHex=(0,T.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e.isHexOnly=this.isHexOnly,e}}],[{key:"blockName",value:function(){return"PrimitiveValueBlock"}}]),r}(c),d=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n,y)).idBlock.isConstructed=!1,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"PRIMITIVE"}}]),r}(s);t.Primitive=d;var g=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).value=(0,T.getParametersValue)(n,"value",[]),e.isIndefiniteForm=(0,T.getParametersValue)(n,"isIndefiniteForm",!1),e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){var n=t,a=r;if(!1===(0,T.checkBufferParams)(this,e,t,r))return-1;if(0===new Uint8Array(e,t,r).length)return this.warnings.push("Zero buffer length"),t;for(var i,o,u=t;i=this.isIndefiniteForm,o=r,(!0===i?1:o)>0;){var c=pe(e,u,r);if(-1===c.offset)return this.error=c.result.error,this.warnings.concat(c.result.warnings),-1;if(u=c.offset,this.blockLength+=c.result.blockLength,r-=c.result.blockLength,this.value.push(c.result),!0===this.isIndefiniteForm&&c.result.constructor.blockName()===w.blockName())break}return!0===this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.blockName()===w.blockName()?this.value.pop():this.warnings.push("No EndOfContent block encoded")),this.valueBeforeDecode=e.slice(n,n+a),u}},{key:"toBER",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new ArrayBuffer(0),r=0;r<this.value.length;r++){var n=this.value[r].toBER(e);t=(0,T.utilConcatBuf)(t,n)}return t}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(n){}e.isIndefiniteForm=this.isIndefiniteForm,e.value=[];for(var t=0;t<this.value.length;t++)e.value.push(this.value[t].toJSON());return e}}],[{key:"blockName",value:function(){return"ConstructedValueBlock"}}]),r}(c),k=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n,g)).idBlock.isConstructed=!0,e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}}],[{key:"blockName",value:function(){return"CONSTRUCTED"}}]),r}(s);t.Constructed=k;var m=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),t.call(this,e)}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){return t}},{key:"toBER",value:function(){return new ArrayBuffer(0)}}],[{key:"blockName",value:function(){return"EndOfContentValueBlock"}}]),r}(c),w=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n,m)).idBlock.tagClass=1,e.idBlock.tagNumber=0,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"EndOfContent"}}]),r}(s);t.EndOfContent=w;var O=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(p.a)(this,r),(e=t.call(this,n)).value=(0,T.getParametersValue)(n,"value",!1),e.isHexOnly=(0,T.getParametersValue)(n,"isHexOnly",!1),"valueHex"in n)e.valueHex=n.valueHex.slice(0);else if(e.valueHex=new ArrayBuffer(1),!0===e.value){var a=new Uint8Array(e.valueHex);a[0]=255}return e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){if(!1===(0,T.checkBufferParams)(this,e,t,r))return-1;var n=new Uint8Array(e,t,r);r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,this.valueHex=new ArrayBuffer(n.length);for(var a=new Uint8Array(this.valueHex),i=0;i<n.length;i++)a[i]=n[i];return 0!==T.utilDecodeTC.call(this)?this.value=!0:this.value=!1,this.blockLength=r,t+r}},{key:"toBER",value:function(){return this.valueHex}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.value=this.value,e.isHexOnly=this.isHexOnly,e.valueHex=(0,T.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}],[{key:"blockName",value:function(){return"BooleanValueBlock"}}]),r}(c),B=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n,O)).idBlock.tagClass=1,e.idBlock.tagNumber=1,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"Boolean"}}]),r}(s);t.Boolean=B;var A=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=16,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"Sequence"}}]),r}(k);t.Sequence=A;var j=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=17,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"Set"}}]),r}(k);t.Set=j;var x=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n,a)).idBlock.tagClass=1,e.idBlock.tagNumber=5,e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new ArrayBuffer(2);if(!0===e)return t;var r=new Uint8Array(t);return r[0]=5,r[1]=0,t}}],[{key:"blockName",value:function(){return"Null"}}]),r}(s);t.Null=x;var S=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).isConstructed=(0,T.getParametersValue)(n,"isConstructed",!1),e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,n){var a=0;if(!0===this.isConstructed){if(this.isHexOnly=!1,-1===(a=g.prototype.fromBER.call(this,e,t,n)))return a;for(var i=0;i<this.value.length;i++){var o=this.value[i].constructor.blockName();if(o===w.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(o!==C.blockName())return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,a=Object(l.a)(Object(h.a)(r.prototype),"fromBER",this).call(this,e,t,n),this.blockLength=n;return a}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!0===this.isConstructed)return g.prototype.toBER.call(this,e);var t=new ArrayBuffer(this.valueHex.byteLength);return!0===e||0===this.valueHex.byteLength?t:t=this.valueHex.slice(0)}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=(0,T.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}],[{key:"blockName",value:function(){return"OctetStringValueBlock"}}]),r}(i(g)),C=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n,S)).idBlock.tagClass=1,e.idBlock.tagNumber=4,e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,n){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===n?(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t):Object(l.a)(Object(h.a)(r.prototype),"fromBER",this).call(this,e,t,n)}},{key:"isEqual",value:function(e){return e instanceof r!==!1&&JSON.stringify(this)===JSON.stringify(e)}}],[{key:"blockName",value:function(){return"OctetString"}}]),r}(s);t.OctetString=C;var K=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).unusedBits=(0,T.getParametersValue)(n,"unusedBits",0),e.isConstructed=(0,T.getParametersValue)(n,"isConstructed",!1),e.blockLength=e.valueHex.byteLength,e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){if(0===r)return t;var n=-1;if(!0===this.isConstructed){if(-1===(n=g.prototype.fromBER.call(this,e,t,r)))return n;for(var a=0;a<this.value.length;a++){var i=this.value[a].constructor.blockName();if(i===w.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(i!==E.blockName())return this.error="BIT STRING may consists of BIT STRINGs only",-1;if(this.unusedBits>0&&this.value[a].valueBlock.unusedBits>0)return this.error='Usign of "unused bits" inside constructive BIT STRING allowed for least one only',-1;if(this.unusedBits=this.value[a].valueBlock.unusedBits,this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1}return n}if(!1===(0,T.checkBufferParams)(this,e,t,r))return-1;var o=new Uint8Array(e,t,r);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;this.valueHex=new ArrayBuffer(o.length-1);for(var u=new Uint8Array(this.valueHex),c=0;c<r-1;c++)u[c]=o[c+1];return this.blockLength=o.length,t+r}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!0===this.isConstructed)return g.prototype.toBER.call(this,e);if(!0===e)return new ArrayBuffer(this.valueHex.byteLength+1);if(0===this.valueHex.byteLength)return new ArrayBuffer(0);var t=new Uint8Array(this.valueHex),r=new ArrayBuffer(this.valueHex.byteLength+1),n=new Uint8Array(r);n[0]=this.unusedBits;for(var a=0;a<this.valueHex.byteLength;a++)n[a+1]=t[a];return r}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.unusedBits=this.unusedBits,e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=(0,T.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}],[{key:"blockName",value:function(){return"BitStringValueBlock"}}]),r}(i(g)),E=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n,K)).idBlock.tagClass=1,e.idBlock.tagNumber=3,e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,n){return 0===n?t:(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,Object(l.a)(Object(h.a)(r.prototype),"fromBER",this).call(this,e,t,n))}},{key:"isEqual",value:function(e){return e instanceof r!==!1&&JSON.stringify(this)===JSON.stringify(e)}}],[{key:"blockName",value:function(){return"BitString"}}]),r}(s);t.BitString=E;var N=function(e){Object(f.a)(a,e);var t=Object(v.a)(a);function a(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,a),e=t.call(this,r),"value"in r&&(e.valueDec=r.value),e}return Object(b.a)(a,[{key:"valueHex",get:function(){return this._valueHex},set:function(e){this._valueHex=e.slice(0),e.byteLength>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,e.byteLength>0&&(this._valueDec=T.utilDecodeTC.call(this)))}},{key:"valueDec",get:function(){return this._valueDec},set:function(e){this._valueDec=e,this.isHexOnly=!1,this._valueHex=(0,T.utilEncodeTC)(e)}},{key:"fromDER",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=this.fromBER(e,t,r);if(-1===a)return a;var i=new Uint8Array(this._valueHex);if(0===i[0]&&0!==(128&i[1])){var o=new ArrayBuffer(this._valueHex.byteLength-1),u=new Uint8Array(o);u.set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=o.slice(0)}else if(0!==n&&this._valueHex.byteLength<n){n-this._valueHex.byteLength>1&&(n=this._valueHex.byteLength+1);var c=new ArrayBuffer(n),s=new Uint8Array(c);s.set(i,n-this._valueHex.byteLength),this._valueHex=c.slice(0)}return a}},{key:"toDER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new Uint8Array(this._valueHex);switch(!0){case 0!==(128&t[0]):var r=new ArrayBuffer(this._valueHex.byteLength+1),n=new Uint8Array(r);n[0]=0,n.set(t,1),this._valueHex=r.slice(0);break;case 0===t[0]&&0===(128&t[1]):var a=new ArrayBuffer(this._valueHex.byteLength-1),i=new Uint8Array(a);i.set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=a.slice(0)}return this.toBER(e)}},{key:"fromBER",value:function(e,t,r){var n=Object(l.a)(Object(h.a)(a.prototype),"fromBER",this).call(this,e,t,r);return-1===n?n:(this.blockLength=r,t+r)}},{key:"toBER",value:function(){return this.valueHex.slice(0)}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(a.prototype),"toJSON",this).call(this)}catch(t){}return e.valueDec=this.valueDec,e}},{key:"toString",value:function(){function e(e,t){for(var r=new Uint8Array([0]),n=new Uint8Array(e),a=new Uint8Array(t),i=n.slice(0),o=i.length-1,u=a.slice(0),c=u.length-1,s=0,l=0,h=c<o?o:c;h>=0;h--,l++){switch(!0){case l<u.length:s=i[o-l]+u[c-l]+r[0];break;default:s=i[o-l]+r[0]}switch(r[0]=s/10,!0){case l>=i.length:i=(0,T.utilConcatView)(new Uint8Array([s%10]),i);break;default:i[o-l]=s%10}}return r[0]>0&&(i=(0,T.utilConcatView)(r,i)),i.slice(0)}function t(e){if(e>=r.length)for(var t=r.length;t<=e;t++){for(var n=new Uint8Array([0]),a=r[t-1].slice(0),i=a.length-1;i>=0;i--){var o=new Uint8Array([(a[i]<<1)+n[0]]);n[0]=o[0]/10,a[i]=o[0]%10}n[0]>0&&(a=(0,T.utilConcatView)(n,a)),r.push(a)}return r[e]}function a(e,t){for(var r,n=0,a=new Uint8Array(e),i=new Uint8Array(t),o=a.slice(0),u=o.length-1,c=i.slice(0),s=c.length-1,l=0,h=s;h>=0;h--,l++)switch(r=o[u-l]-c[s-l]-n,!0){case r<0:n=1,o[u-l]=r+10;break;default:n=0,o[u-l]=r}if(n>0)for(var f=u-s+1;f>=0;f--,l++){if(!((r=o[u-l]-n)<0)){n=0,o[u-l]=r;break}n=1,o[u-l]=r+10}return o.slice()}for(var i,o=8*this._valueHex.byteLength-1,u=new Uint8Array(8*this._valueHex.byteLength/3),c=0,s=new Uint8Array(this._valueHex),l="",h=!1,f=this._valueHex.byteLength-1;f>=0;f--){i=s[f];for(var v=0;v<8;v++){if(1===(1&i))switch(c){case o:u=a(t(c),u),l="-";break;default:u=e(u,t(c))}c++,i>>=1}}for(var y=0;y<u.length;y++)u[y]&&(h=!0),h&&(l+=n.charAt(u[y]));return!1===h&&(l+=n.charAt(0)),l}}],[{key:"blockName",value:function(){return"IntegerValueBlock"}}]),a}(i(c)),U=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n,N)).idBlock.tagClass=1,e.idBlock.tagNumber=2,e}return Object(b.a)(r,[{key:"isEqual",value:function(e){return e instanceof r?this.valueBlock.isHexOnly&&e.valueBlock.isHexOnly?(0,T.isEqualBuffer)(this.valueBlock.valueHex,e.valueBlock.valueHex):this.valueBlock.isHexOnly===e.valueBlock.isHexOnly&&this.valueBlock.valueDec===e.valueBlock.valueDec:e instanceof ArrayBuffer&&(0,T.isEqualBuffer)(this.valueBlock.valueHex,e)}},{key:"convertToDER",value:function(){var e=new r({valueHex:this.valueBlock.valueHex});return e.valueBlock.toDER(),e}},{key:"convertFromDER",value:function(){var e=this.valueBlock.valueHex.byteLength%2?this.valueBlock.valueHex.byteLength+1:this.valueBlock.valueHex.byteLength,t=new r({valueHex:this.valueBlock.valueHex});return t.valueBlock.fromDER(t.valueBlock.valueHex,0,t.valueBlock.valueHex.byteLength,e),t}}],[{key:"blockName",value:function(){return"Integer"}}]),r}(s);t.Integer=U;var P=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=10,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"Enumerated"}}]),r}(U);t.Enumerated=P;var L=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).valueDec=(0,T.getParametersValue)(n,"valueDec",-1),e.isFirstSid=(0,T.getParametersValue)(n,"isFirstSid",!1),e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){if(0===r)return t;if(!1===(0,T.checkBufferParams)(this,e,t,r))return-1;var n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);for(var a=new Uint8Array(this.valueHex),i=0;i<r&&(a[i]=127&n[i],this.blockLength++,0!==(128&n[i]));i++);for(var o=new ArrayBuffer(this.blockLength),u=new Uint8Array(o),c=0;c<this.blockLength;c++)u[c]=a[c];return this.valueHex=o.slice(0),a=new Uint8Array(this.valueHex),0!==(128&n[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===a[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=(0,T.utilFromBase)(a,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}},{key:"toBER",value:function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isHexOnly){if(!0===r)return new ArrayBuffer(this.valueHex.byteLength);var n=new Uint8Array(this.valueHex);e=new ArrayBuffer(this.blockLength),t=new Uint8Array(e);for(var a=0;a<this.blockLength-1;a++)t[a]=128|n[a];return t[this.blockLength-1]=n[this.blockLength-1],e}var i=(0,T.utilToBase)(this.valueDec,7);if(0===i.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(e=new ArrayBuffer(i.byteLength),!1===r){var o=new Uint8Array(i);t=new Uint8Array(e);for(var u=0;u<i.byteLength-1;u++)t[u]=128|o[u];t[i.byteLength-1]=o[i.byteLength-1]}return e}},{key:"toString",value:function(){var e="";if(!0===this.isHexOnly)e=(0,T.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength);else if(this.isFirstSid){var t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.valueDec=this.valueDec,e.isFirstSid=this.isFirstSid,e}}],[{key:"blockName",value:function(){return"sidBlock"}}]),r}(i(a)),H=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).fromString((0,T.getParametersValue)(n,"value","")),e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){for(var n=t;r>0;){var a=new L;if(-1===(n=a.fromBER(e,n,r)))return this.blockLength=0,this.error=a.error,n;0===this.value.length&&(a.isFirstSid=!0),this.blockLength+=a.blockLength,r-=a.blockLength,this.value.push(a)}return n}},{key:"toBER",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new ArrayBuffer(0),r=0;r<this.value.length;r++){var n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);t=(0,T.utilConcatBuf)(t,n)}return t}},{key:"fromString",value:function(e){this.value=[];var t=0,r=0,n="",a=!1;do{if(n=-1===(r=e.indexOf(".",t))?e.substr(t):e.substr(t,r-t),t=r+1,a){var i=this.value[0],o=0;switch(i.valueDec){case 0:break;case 1:o=40;break;case 2:o=80;break;default:return this.value=[],!1}var u=parseInt(n,10);if(isNaN(u))return!0;i.valueDec=u+o,a=!1}else{var c=new L;if(c.valueDec=parseInt(n,10),isNaN(c.valueDec))return!0;0===this.value.length&&(c.isFirstSid=!0,a=!0),this.value.push(c)}}while(-1!==r);return!0}},{key:"toString",value:function(){for(var e="",t=!1,r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;var n=this.value[r].toString();0!==r&&(e="".concat(e,".")),t?(n="{".concat(n,"}"),this.value[r].isFirstSid?e="2.{".concat(n," - 80}"):e+=n):e+=n}return e}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(n){}e.value=this.toString(),e.sidArray=[];for(var t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}],[{key:"blockName",value:function(){return"ObjectIdentifierValueBlock"}}]),r}(c),I=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n,H)).idBlock.tagClass=1,e.idBlock.tagNumber=6,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"ObjectIdentifier"}}]),r}(s);t.ObjectIdentifier=I;var R=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).isHexOnly=!0,e.value="",e}return Object(b.a)(r,[{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.value=this.value,e}}],[{key:"blockName",value:function(){return"Utf8StringValueBlock"}}]),r}(i(a)),D=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),e=t.call(this,n,R),"value"in n&&e.fromString(n.value),e.idBlock.tagClass=1,e.idBlock.tagNumber=12,e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e));try{this.valueBlock.value=decodeURIComponent(escape(this.valueBlock.value))}catch(t){this.warnings.push('Error during "decodeURIComponent": '.concat(t,", using raw string"))}}},{key:"fromString",value:function(e){var t=unescape(encodeURIComponent(e)),r=t.length;this.valueBlock.valueHex=new ArrayBuffer(r);for(var n=new Uint8Array(this.valueBlock.valueHex),a=0;a<r;a++)n[a]=t.charCodeAt(a);this.valueBlock.value=e}}],[{key:"blockName",value:function(){return"Utf8String"}}]),r}(s);t.Utf8String=D;var _=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).valueDec=(0,T.getParametersValue)(n,"valueDec",-1),e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){if(0===r)return t;if(!1===(0,T.checkBufferParams)(this,e,t,r))return-1;var n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);for(var a=new Uint8Array(this.valueHex),i=0;i<r&&(a[i]=127&n[i],this.blockLength++,0!==(128&n[i]));i++);for(var o=new ArrayBuffer(this.blockLength),u=new Uint8Array(o),c=0;c<this.blockLength;c++)u[c]=a[c];return this.valueHex=o.slice(0),a=new Uint8Array(this.valueHex),0!==(128&n[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===a[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=(0,T.utilFromBase)(a,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}},{key:"toBER",value:function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isHexOnly){if(!0===r)return new ArrayBuffer(this.valueHex.byteLength);var n=new Uint8Array(this.valueHex);e=new ArrayBuffer(this.blockLength),t=new Uint8Array(e);for(var a=0;a<this.blockLength-1;a++)t[a]=128|n[a];return t[this.blockLength-1]=n[this.blockLength-1],e}var i=(0,T.utilToBase)(this.valueDec,7);if(0===i.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(e=new ArrayBuffer(i.byteLength),!1===r){var o=new Uint8Array(i);t=new Uint8Array(e);for(var u=0;u<i.byteLength-1;u++)t[u]=128|o[u];t[i.byteLength-1]=o[i.byteLength-1]}return e}},{key:"toString",value:function(){return!0===this.isHexOnly?(0,T.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength):this.valueDec.toString()}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.valueDec=this.valueDec,e}}],[{key:"blockName",value:function(){return"relativeSidBlock"}}]),r}(i(a)),V=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).fromString((0,T.getParametersValue)(n,"value","")),e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){for(var n=t;r>0;){var a=new _;if(-1===(n=a.fromBER(e,n,r)))return this.blockLength=0,this.error=a.error,n;this.blockLength+=a.blockLength,r-=a.blockLength,this.value.push(a)}return n}},{key:"toBER",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new ArrayBuffer(0),r=0;r<this.value.length;r++){var n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);t=(0,T.utilConcatBuf)(t,n)}return t}},{key:"fromString",value:function(e){this.value=[];var t=0,r=0,n="";do{n=-1===(r=e.indexOf(".",t))?e.substr(t):e.substr(t,r-t),t=r+1;var a=new _;if(a.valueDec=parseInt(n,10),isNaN(a.valueDec))return!0;this.value.push(a)}while(-1!==r);return!0}},{key:"toString",value:function(){for(var e="",t=!1,r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;var n=this.value[r].toString();0!==r&&(e="".concat(e,".")),e+=t?n="{".concat(n,"}"):n}return e}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(n){}e.value=this.toString(),e.sidArray=[];for(var t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}],[{key:"blockName",value:function(){return"RelativeObjectIdentifierValueBlock"}}]),r}(c),J=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n,V)).idBlock.tagClass=1,e.idBlock.tagNumber=13,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"RelativeObjectIdentifier"}}]),r}(s);t.RelativeObjectIdentifier=J;var F=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).isHexOnly=!0,e.value="",e}return Object(b.a)(r,[{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.value=this.value,e}}],[{key:"blockName",value:function(){return"BmpStringValueBlock"}}]),r}(i(a)),M=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),e=t.call(this,n,F),"value"in n&&e.fromString(n.value),e.idBlock.tagClass=1,e.idBlock.tagNumber=30,e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){for(var t=e.slice(0),r=new Uint8Array(t),n=0;n<r.length;n+=2){var a=r[n];r[n]=r[n+1],r[n+1]=a}this.valueBlock.value=String.fromCharCode.apply(null,new Uint16Array(t))}},{key:"fromString",value:function(e){var t=e.length;this.valueBlock.valueHex=new ArrayBuffer(2*t);for(var r=new Uint8Array(this.valueBlock.valueHex),n=0;n<t;n++){var a=(0,T.utilToBase)(e.charCodeAt(n),8),i=new Uint8Array(a);if(!(i.length>2))for(var o=2-i.length,u=i.length-1;u>=0;u--)r[2*n+u+o]=i[u]}this.valueBlock.value=e}}],[{key:"blockName",value:function(){return"BmpString"}}]),r}(s);t.BmpString=M;var z=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).isHexOnly=!0,e.value="",e}return Object(b.a)(r,[{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.value=this.value,e}}],[{key:"blockName",value:function(){return"UniversalStringValueBlock"}}]),r}(i(a)),q=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),e=t.call(this,n,z),"value"in n&&e.fromString(n.value),e.idBlock.tagClass=1,e.idBlock.tagNumber=28,e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){for(var t=e.slice(0),r=new Uint8Array(t),n=0;n<r.length;n+=4)r[n]=r[n+3],r[n+1]=r[n+2],r[n+2]=0,r[n+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}},{key:"fromString",value:function(e){var t=e.length;this.valueBlock.valueHex=new ArrayBuffer(4*t);for(var r=new Uint8Array(this.valueBlock.valueHex),n=0;n<t;n++){var a=(0,T.utilToBase)(e.charCodeAt(n),8),i=new Uint8Array(a);if(!(i.length>4))for(var o=4-i.length,u=i.length-1;u>=0;u--)r[4*n+u+o]=i[u]}this.valueBlock.value=e}}],[{key:"blockName",value:function(){return"UniversalString"}}]),r}(s);t.UniversalString=q;var G=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).value="",e.isHexOnly=!0,e}return Object(b.a)(r,[{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.value=this.value,e}}],[{key:"blockName",value:function(){return"SimpleStringValueBlock"}}]),r}(i(a)),W=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),e=t.call(this,n,G),"value"in n&&e.fromString(n.value),e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e))}},{key:"fromString",value:function(e){var t=e.length;this.valueBlock.valueHex=new ArrayBuffer(t);for(var r=new Uint8Array(this.valueBlock.valueHex),n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}}],[{key:"blockName",value:function(){return"SIMPLESTRING"}}]),r}(s),Z=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=18,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"NumericString"}}]),r}(W);t.NumericString=Z;var X=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=19,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"PrintableString"}}]),r}(W);t.PrintableString=X;var $=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=20,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"TeletexString"}}]),r}(W);t.TeletexString=$;var Y=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=21,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"VideotexString"}}]),r}(W);t.VideotexString=Y;var Q=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=22,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"IA5String"}}]),r}(W);t.IA5String=Q;var ee=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=25,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"GraphicString"}}]),r}(W);t.GraphicString=ee;var te=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=26,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"VisibleString"}}]),r}(W);t.VisibleString=te;var re=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=27,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"GeneralString"}}]),r}(W);t.GeneralString=re;var ne=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=29,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"CharacterString"}}]),r}(W);t.CharacterString=ne;var ae=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(p.a)(this,r),(e=t.call(this,n)).year=0,e.month=0,e.day=0,e.hour=0,e.minute=0,e.second=0,"value"in n){e.fromString(n.value),e.valueBlock.valueHex=new ArrayBuffer(n.value.length);for(var a=new Uint8Array(e.valueBlock.valueHex),i=0;i<n.value.length;i++)a[i]=n.value.charCodeAt(i)}return"valueDate"in n&&(e.fromDate(n.valueDate),e.valueBlock.valueHex=e.toBuffer()),e.idBlock.tagClass=1,e.idBlock.tagNumber=23,e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}},{key:"toBuffer",value:function(){for(var e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t}},{key:"fromDate",value:function(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}},{key:"toDate",value:function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}},{key:"fromString",value:function(e){var t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null!==t){var r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}else this.error="Wrong input string for convertion"}},{key:"toString",value:function(){var e=new Array(7);return e[0]=(0,T.padNumber)(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=(0,T.padNumber)(this.month,2),e[2]=(0,T.padNumber)(this.day,2),e[3]=(0,T.padNumber)(this.hour,2),e[4]=(0,T.padNumber)(this.minute,2),e[5]=(0,T.padNumber)(this.second,2),e[6]="Z",e.join("")}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e}}],[{key:"blockName",value:function(){return"UTCTime"}}]),r}(te);t.UTCTime=ae;var ie=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(p.a)(this,r),(e=t.call(this,n)).year=0,e.month=0,e.day=0,e.hour=0,e.minute=0,e.second=0,e.millisecond=0,"value"in n){e.fromString(n.value),e.valueBlock.valueHex=new ArrayBuffer(n.value.length);for(var a=new Uint8Array(e.valueBlock.valueHex),i=0;i<n.value.length;i++)a[i]=n.value.charCodeAt(i)}return"valueDate"in n&&(e.fromDate(n.valueDate),e.valueBlock.valueHex=e.toBuffer()),e.idBlock.tagClass=1,e.idBlock.tagNumber=24,e}return Object(b.a)(r,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}},{key:"toBuffer",value:function(){for(var e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t}},{key:"fromDate",value:function(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}},{key:"toDate",value:function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}},{key:"fromString",value:function(e){var t,r=!1,n="",a="",i=0,o=0,u=0;if("Z"===e[e.length-1])n=e.substr(0,e.length-1),r=!0;else{var c=new Number(e[e.length-1]);if(isNaN(c.valueOf()))throw new Error("Wrong input string for convertion");n=e}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for convertion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for convertion")}else{var s=1,l=n.indexOf("+"),h="";if(-1===l&&(l=n.indexOf("-"),s=-1),-1!==l){if(h=n.substr(l+1),n=n.substr(0,l),2!==h.length&&4!==h.length)throw new Error("Wrong input string for convertion");var f=new Number(h.substr(0,2));if(isNaN(f.valueOf()))throw new Error("Wrong input string for convertion");if(o=s*f,4===h.length){if(f=new Number(h.substr(2,2)),isNaN(f.valueOf()))throw new Error("Wrong input string for convertion");u=s*f}}}var v=n.indexOf(".");if(-1===v&&(v=n.indexOf(",")),-1!==v){var y=new Number("0".concat(n.substr(v)));if(isNaN(y.valueOf()))throw new Error("Wrong input string for convertion");i=y.valueOf(),a=n.substr(0,v)}else a=n;switch(!0){case 8===a.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==v)throw new Error("Wrong input string for convertion");break;case 10===a.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==v){var p=60*i;this.minute=Math.floor(p),p=60*(p-this.minute),this.second=Math.floor(p),p=1e3*(p-this.second),this.millisecond=Math.floor(p)}break;case 12===a.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==v){var b=60*i;this.second=Math.floor(b),b=1e3*(b-this.second),this.millisecond=Math.floor(b)}break;case 14===a.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==v){var d=1e3*i;this.millisecond=Math.floor(d)}break;default:throw new Error("Wrong input string for convertion")}var g=t.exec(a);if(null===g)throw new Error("Wrong input string for convertion");for(var k=1;k<g.length;k++)switch(k){case 1:this.year=parseInt(g[k],10);break;case 2:this.month=parseInt(g[k],10);break;case 3:this.day=parseInt(g[k],10);break;case 4:this.hour=parseInt(g[k],10)+o;break;case 5:this.minute=parseInt(g[k],10)+u;break;case 6:this.second=parseInt(g[k],10);break;default:throw new Error("Wrong input string for convertion")}if(!1===r){var m=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=m.getUTCFullYear(),this.month=m.getUTCMonth(),this.day=m.getUTCDay(),this.hour=m.getUTCHours(),this.minute=m.getUTCMinutes(),this.second=m.getUTCSeconds(),this.millisecond=m.getUTCMilliseconds()}}},{key:"toString",value:function(){var e=[];return e.push((0,T.padNumber)(this.year,4)),e.push((0,T.padNumber)(this.month,2)),e.push((0,T.padNumber)(this.day,2)),e.push((0,T.padNumber)(this.hour,2)),e.push((0,T.padNumber)(this.minute,2)),e.push((0,T.padNumber)(this.second,2)),0!==this.millisecond&&(e.push("."),e.push((0,T.padNumber)(this.millisecond,3))),e.push("Z"),e.join("")}},{key:"toJSON",value:function(){var e={};try{e=Object(l.a)(Object(h.a)(r.prototype),"toJSON",this).call(this)}catch(t){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e.millisecond=this.millisecond,e}}],[{key:"blockName",value:function(){return"GeneralizedTime"}}]),r}(te);t.GeneralizedTime=ie;var oe=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=31,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"DATE"}}]),r}(D);t.DATE=oe;var ue=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=32,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"TimeOfDay"}}]),r}(D);t.TimeOfDay=ue;var ce=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=33,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"DateTime"}}]),r}(D);t.DateTime=ce;var se=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=34,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"Duration"}}]),r}(D);t.Duration=se;var le=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(p.a)(this,r),(e=t.call(this,n)).idBlock.tagClass=1,e.idBlock.tagNumber=14,e}return Object(b.a)(r,null,[{key:"blockName",value:function(){return"TIME"}}]),r}(D);t.TIME=le;var he=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(p.a)(this,e),this.value=(0,T.getParametersValue)(t,"value",[]),this.optional=(0,T.getParametersValue)(t,"optional",!1)};t.Choice=he;var fe=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(p.a)(this,e),this.name=(0,T.getParametersValue)(t,"name",""),this.optional=(0,T.getParametersValue)(t,"optional",!1)};t.Any=fe;var ve=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(p.a)(this,e),this.name=(0,T.getParametersValue)(t,"name",""),this.optional=(0,T.getParametersValue)(t,"optional",!1),this.value=(0,T.getParametersValue)(t,"value",new fe),this.local=(0,T.getParametersValue)(t,"local",!1)};t.Repeated=ve;var ye=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(p.a)(this,e),this.data=(0,T.getParametersValue)(t,"data",new ArrayBuffer(0))}return Object(b.a)(e,[{key:"fromBER",value:function(e,t,r){return this.data=e.slice(t,r),t+r}},{key:"toBER",value:function(){return this.data}}]),e}();function pe(e,t,r){var n=t;var i=new s({},Object),o=new a;if(!1===(0,T.checkBufferParams)(o,e,t,r))return i.error=o.error,{offset:-1,result:i};if(0===new Uint8Array(e,t,r).length)return this.error="Zero buffer length",{offset:-1,result:i};var u=i.idBlock.fromBER(e,t,r);if(i.warnings.concat(i.idBlock.warnings),-1===u)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=u,r-=i.idBlock.blockLength,u=i.lenBlock.fromBER(e,t,r),i.warnings.concat(i.lenBlock.warnings),-1===u)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=u,r-=i.lenBlock.blockLength,!1===i.idBlock.isConstructed&&!0===i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};var c=s;switch(i.idBlock.tagClass){case 1:if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(!0===i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};c=w;break;case 1:c=B;break;case 2:c=U;break;case 3:c=E;break;case 4:c=C;break;case 5:c=x;break;case 6:c=I;break;case 10:c=P;break;case 12:c=D;break;case 13:c=J;break;case 14:c=le;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:c=A;break;case 17:c=j;break;case 18:c=Z;break;case 19:c=X;break;case 20:c=$;break;case 21:c=Y;break;case 22:c=Q;break;case 23:c=ae;break;case 24:c=ie;break;case 25:c=ee;break;case 26:c=te;break;case 27:c=re;break;case 28:c=q;break;case 29:c=ne;break;case 30:c=M;break;case 31:c=oe;break;case 32:c=ue;break;case 33:c=ce;break;case 34:c=se;break;default:var l;(l=!0===i.idBlock.isConstructed?new k:new d).idBlock=i.idBlock,l.lenBlock=i.lenBlock,l.warnings=i.warnings,u=(i=l).fromBER(e,t,r)}break;case 2:case 3:case 4:default:c=!0===i.idBlock.isConstructed?k:d}return u=(i=function(e,t){if(e instanceof t)return e;var r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecode=e.valueBeforeDecode.slice(0),r}(i,c)).fromBER(e,t,!0===i.lenBlock.isIndefiniteForm?r:i.lenBlock.length),i.valueBeforeDecode=e.slice(n,n+i.blockLength),{offset:u,result:i}}function be(e){if(0===e.byteLength){var t=new s({},Object);return t.error="Input buffer has zero length",{offset:-1,result:t}}return pe(e,0,e.byteLength)}function de(e,t,r){if(r instanceof he){for(var n=0;n<r.value.length;n++){if(!0===de(e,t,r.value[n]).verified)return{verified:!0,result:e}}var a={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty("name")&&(a.name=r.name),a}if(r instanceof fe)return r.hasOwnProperty("name")&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object===!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object===!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("idBlock"in r===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("fromBER"in r.idBlock===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("toBER"in r.idBlock===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};var i=r.idBlock.toBER(!1);if(0===i.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(i,0,i.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if("isHexOnly"in r.idBlock===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(!0===r.idBlock.isHexOnly){if("valueHex"in r.idBlock===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};var o=new Uint8Array(r.idBlock.valueHex),u=new Uint8Array(t.idBlock.valueHex);if(o.length!==u.length)return{verified:!1,result:e};for(var c=0;c<o.length;c++)if(o[c]!==u[1])return{verified:!1,result:e}}if(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(e[r.name]=t)),!0===r.idBlock.isConstructed){var s=0,l={verified:!1},h=r.valueBlock.value.length;if(h>0&&r.valueBlock.value[0]instanceof ve&&(h=t.valueBlock.value.length),0===h)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){for(var f=!0,v=0;v<r.valueBlock.value.length;v++)f=f&&(r.valueBlock.value[v].optional||!1);return!0===f?{verified:!0,result:e}:(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(var y=0;y<h;y++)if(y-s>=t.valueBlock.value.length){if(!1===r.valueBlock.value[y].optional){var p={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],p.name=r.name)),p}}else if(r.valueBlock.value[0]instanceof ve){if(!1===(l=de(e,t.valueBlock.value[y],r.valueBlock.value[0].value)).verified){if(!0!==r.valueBlock.value[0].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),l;s++}if("name"in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){var b={};"undefined"===typeof(b="local"in r.valueBlock.value[0]&&!0===r.valueBlock.value[0].local?t:e)[r.valueBlock.value[0].name]&&(b[r.valueBlock.value[0].name]=[]),b[r.valueBlock.value[0].name].push(t.valueBlock.value[y])}}else if(!1===(l=de(e,t.valueBlock.value[y-s],r.valueBlock.value[y])).verified){if(!0!==r.valueBlock.value[y].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),l;s++}if(!1===l.verified){var d={verified:!1,result:e};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],d.name=r.name)),d}return{verified:!0,result:e}}if("primitiveSchema"in r&&"valueHex"in t.valueBlock){var g=be(t.valueBlock.valueHex);if(-1===g.offset){var k={verified:!1,result:g.result};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],k.name=r.name)),k}return de(e,g.result,r.primitiveSchema)}return{verified:!0,result:e}}t.RawData=ye})),D=(L=R)&&L.__esModule&&Object.prototype.hasOwnProperty.call(L,"default")?L.default:L,_=Object.freeze(Object.assign(Object.create(null),R,{default:D}));!function(e){e[e.Sequence=0]="Sequence",e[e.Set=1]="Set",e[e.Choice=2]="Choice"}(H||(H={})),function(e){e[e.Any=1]="Any",e[e.Boolean=2]="Boolean",e[e.OctetString=3]="OctetString",e[e.BitString=4]="BitString",e[e.Integer=5]="Integer",e[e.Enumerated=6]="Enumerated",e[e.ObjectIdentifier=7]="ObjectIdentifier",e[e.Utf8String=8]="Utf8String",e[e.BmpString=9]="BmpString",e[e.UniversalString=10]="UniversalString",e[e.NumericString=11]="NumericString",e[e.PrintableString=12]="PrintableString",e[e.TeletexString=13]="TeletexString",e[e.VideotexString=14]="VideotexString",e[e.IA5String=15]="IA5String",e[e.GraphicString=16]="GraphicString",e[e.VisibleString=17]="VisibleString",e[e.GeneralString=18]="GeneralString",e[e.CharacterString=19]="CharacterString",e[e.UTCTime=20]="UTCTime",e[e.GeneralizedTime=21]="GeneralizedTime",e[e.DATE=22]="DATE",e[e.TimeOfDay=23]="TimeOfDay",e[e.DateTime=24]="DateTime",e[e.Duration=25]="Duration",e[e.TIME=26]="TIME",e[e.Null=27]="Null"}(I||(I={}));var V={fromASN:function(e){return e instanceof R.Null?null:e.valueBeforeDecode},toASN:function(e){if(null===e)return new R.Null;var t=R.fromBER(e);if(t.result.error)throw new Error(t.result.error);return t.result}},J={fromASN:function(e){return e.valueBlock.valueHex.byteLength>4?e.valueBlock.toString():e.valueBlock.valueDec},toASN:function(e){return new R.Integer({value:e})}},F={fromASN:function(e){return e.valueBlock.valueDec},toASN:function(e){return new R.Enumerated({value:e})}},M={fromASN:function(e){return e.valueBlock.valueHex},toASN:function(e){return new R.BitString({valueHex:e})}},z={fromASN:function(e){return e.valueBlock.toString()},toASN:function(e){return new R.ObjectIdentifier({value:e})}},q={fromASN:function(e){return e.valueBlock.value},toASN:function(e){return new R.Boolean({value:e})}},G={fromASN:function(e){return e.valueBlock.valueHex},toASN:function(e){return new R.OctetString({valueHex:e})}};function W(e){return{fromASN:function(e){return e.valueBlock.value},toASN:function(t){return new e({value:t})}}}var Z=W(R.Utf8String),X=W(R.BmpString),$=W(R.UniversalString),Y=W(R.NumericString),Q=W(R.PrintableString),ee=W(R.TeletexString),te=W(R.VideotexString),re=W(R.IA5String),ne=W(R.GraphicString),ae=W(R.VisibleString),ie=W(R.GeneralString),oe=W(R.CharacterString),ue={fromASN:function(e){return e.toDate()},toASN:function(e){return new R.UTCTime({valueDate:e})}},ce={fromASN:function(e){return e.toDate()},toASN:function(e){return new R.GeneralizedTime({valueDate:e})}},se={fromASN:function(e){return null},toASN:function(e){return new R.Null}};function le(e){switch(e){case I.Any:return V;case I.BitString:return M;case I.BmpString:return X;case I.Boolean:return q;case I.CharacterString:return oe;case I.Enumerated:return F;case I.GeneralString:return ie;case I.GeneralizedTime:return ce;case I.GraphicString:return ne;case I.IA5String:return re;case I.Integer:return J;case I.Null:return se;case I.NumericString:return Y;case I.ObjectIdentifier:return z;case I.OctetString:return G;case I.PrintableString:return Q;case I.TeletexString:return ee;case I.UTCTime:return ue;case I.UniversalString:return $;case I.Utf8String:return Z;case I.VideotexString:return te;case I.VisibleString:return ae;default:return null}}var he=function(){function e(t){Object(p.a)(this,e),"number"===typeof t?this.buffer=new ArrayBuffer(t):B.isBufferSource(t)?this.buffer=B.toArrayBuffer(t):Array.isArray(t)?this.buffer=new Uint8Array(t):this.buffer=new ArrayBuffer(0)}return Object(b.a)(e,[{key:"byteLength",get:function(){return this.buffer.byteLength}},{key:"byteOffset",get:function(){return 0}},{key:"fromASN",value:function(e){if(!(e instanceof R.OctetString))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}},{key:"toASN",value:function(){return new R.OctetString({valueHex:this.buffer})}},{key:"toSchema",value:function(e){return new R.OctetString({name:e})}}]),e}();function fe(e){return e&&e.prototype?!(!e.prototype.toASN||!e.prototype.fromASN)||fe(e.prototype):!!(e&&e.toASN&&e.fromASN)}function ve(e){var t;if(e){var r=Object.getPrototypeOf(e);return(null===(t=null===r||void 0===r?void 0:r.prototype)||void 0===t?void 0:t.constructor)===Array||ve(r)}return!1}function ye(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;for(var r=new Uint8Array(e),n=new Uint8Array(t),a=0;a<e.byteLength;a++)if(r[a]!==n[a])return!1;return!0}var pe,be=new(function(){function e(){Object(p.a)(this,e),this.items=new WeakMap}return Object(b.a)(e,[{key:"has",value:function(e){return this.items.has(e)}},{key:"get",value:function(e){var t,r,n,a,i=this.items.get(e);if(!i)throw new Error("Cannot get schema for '".concat(null!==(a=null===(n=null===(r=null===(t=e)||void 0===t?void 0:t.prototype)||void 0===r?void 0:r.constructor)||void 0===n?void 0:n.name)&&void 0!==a?a:e,"' target"));return i}},{key:"cache",value:function(e){var t=this.get(e);t.schema||(t.schema=this.create(e,!0))}},{key:"createDefault",value:function(e){var t={type:H.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}},{key:"create",value:function(e,t){var r=this.items.get(e)||this.createDefault(e),n=[];for(var a in r.items){var i=r.items[a],o=t?a:"",u=void 0;if("number"===typeof i.type){var c=I[i.type],s=_[c];if(!s)throw new Error("Cannot get ASN1 class by name '".concat(c,"'"));u=new s({name:o})}else if(fe(i.type)){u=(new i.type).toSchema(o)}else if(i.optional){this.get(i.type).type===H.Choice?u=new R.Any({name:o}):(u=this.create(i.type,!1)).name=o}else u=new R.Any({name:o});var l=!!i.optional||void 0!==i.defaultValue;if(i.repeated)u.name="",u=new("set"===i.repeated?R.Set:R.Sequence)({name:"",value:[new R.Repeated({name:o,value:u})]});if(null!==i.context&&void 0!==i.context)if(i.implicit)if("number"===typeof i.type||fe(i.type)){var h=i.repeated?R.Constructed:R.Primitive;n.push(new h({name:o,optional:l,idBlock:{tagClass:3,tagNumber:i.context}}))}else{this.cache(i.type);var f=!!i.repeated,v=f?u:this.get(i.type).schema;v=v.valueBlock?v.valueBlock.value:v.value,n.push(new R.Constructed({name:f?"":o,optional:l,idBlock:{tagClass:3,tagNumber:i.context},value:v}))}else n.push(new R.Constructed({optional:l,idBlock:{tagClass:3,tagNumber:i.context},value:[u]}));else u.optional=l,n.push(u)}switch(r.type){case H.Sequence:return new R.Sequence({value:n,name:""});case H.Set:return new R.Set({value:n,name:""});case H.Choice:return new R.Choice({value:n,name:""});default:throw new Error("Unsupported ASN1 type in use")}}},{key:"set",value:function(e,t){return this.items.set(e,t),this}},{key:"findParentSchema",value:function(e){var t=e.__proto__;return t?this.items.get(t)||this.findParentSchema(t):null}}]),e}()),de=function(e){return function(t){var r;be.has(t)?r=be.get(t):(r=be.createDefault(t),be.set(t,r)),Object.assign(r,e)}},ge=function(e){return function(t,r){var n;be.has(t.constructor)?n=be.get(t.constructor):(n=be.createDefault(t.constructor),be.set(t.constructor,n));var a=Object.assign({},e);if("number"===typeof a.type&&!a.converter){var i=le(e.type);if(!i)throw new Error("Cannot get default converter for property '".concat(r,"' of ").concat(t.constructor.name));a.converter=i}n.items[r]=a}},ke=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).schemas=[],e}return r}(Object(s.a)(Error)),me=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"parse",value:function(e,t){var r;if(e instanceof ArrayBuffer)r=e;else if("undefined"!==typeof Buffer&&Buffer.isBuffer(e))r=new Uint8Array(e).buffer;else{if(!(ArrayBuffer.isView(e)||e.buffer instanceof ArrayBuffer))throw new TypeError("Wrong type of 'data' argument");r=e.buffer}var n=R.fromBER(r);if(n.result.error)throw new Error(n.result.error);return this.fromASN(n.result,t)}},{key:"fromASN",value:function(e,t){var r,n=this;try{if(fe(t))return(new t).fromASN(e);var a=be.get(t);be.cache(t);var i=a.schema;if(e.constructor===R.Constructed&&a.type!==H.Choice)for(var o in i=new R.Constructed({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:a.schema.valueBlock.value}),a.items)delete e[o];var u=R.compareSchema(e,e,i);if(!u.verified)throw new ke("Data does not match to ".concat(t.name," ASN1 schema. ").concat(u.result.error));var c=new t;if(ve(t)){if("number"===typeof a.itemType){var s=le(a.itemType);if(!s)throw new Error("Cannot get default converter for array item of ".concat(t.name," ASN1 schema"));return t.from(e.valueBlock.value,(function(e){return s.fromASN(e)}))}return t.from(e.valueBlock.value,(function(e){return n.fromASN(e,a.itemType)}))}var l=function(t){if(!e[t])return"continue";var i=a.items[t];if("number"===typeof i.type||fe(i.type)){var o=null!==(r=i.converter)&&void 0!==r?r:fe(i.type)?new i.type:null;if(!o)throw new Error("Converter is empty");if(i.repeated)if(i.implicit){var u=new("sequence"===i.repeated?R.Sequence:R.Set);u.valueBlock=e[t].valueBlock;var s=R.fromBER(u.toBER(!1)).result.valueBlock.value;c[t]=Array.from(s,(function(e){return o.fromASN(e)}))}else c[t]=Array.from(e[t],(function(e){return o.fromASN(e)}));else{var l=e[t];if(i.implicit){var h;if(fe(i.type))h=(new i.type).toSchema("");else{var f=I[i.type],v=_[f];if(!v)throw new Error("Cannot get '".concat(f,"' class from asn1js module"));h=new v}h.valueBlock=l.valueBlock,l=R.fromBER(h.toBER(!1)).result}c[t]=o.fromASN(l)}}else i.repeated?c[t]=Array.from(e[t],(function(e){return n.fromASN(e,i.type)})):c[t]=n.fromASN(e[t],i.type)};for(var h in a.items)l(h);return c}catch(f){throw f instanceof ke&&f.schemas.push(t.name),f}}}]),e}(),we=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"serialize",value:function(e){return e instanceof R.BaseBlock?e.toBER(!1):this.toASN(e).toBER(!1)}},{key:"toASN",value:function(t){var r=this;if(t&&fe(t.constructor))return t.toASN();var n=t.constructor,a=be.get(n);be.cache(n);var i,o=[];if(a.itemType)if("number"===typeof a.itemType){var u=le(a.itemType);if(!u)throw new Error("Cannot get default converter for array item of ".concat(n.name," ASN1 schema"));o=t.map((function(e){return u.toASN(e)}))}else o=t.map((function(e){return r.toAsnItem({type:a.itemType},"[]",n,e)}));else for(var c in a.items){var s=a.items[c],l=t[c];if(!(void 0===l||s.defaultValue===l||"object"===typeof s.defaultValue&&"object"===typeof l&&ye(this.serialize(s.defaultValue),this.serialize(l)))){var h=e.toAsnItem(s,c,n,l);if("number"===typeof s.context)if(s.implicit)if(s.repeated||"number"!==typeof s.type&&!fe(s.type))o.push(new R.Constructed({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:h.valueBlock.value}));else{var f={};f.valueHex=h.valueBlock.toBER(),o.push(new R.Primitive(Object.assign({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context}},f)))}else o.push(new R.Constructed({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:[h]}));else s.repeated?o=o.concat(h):o.push(h)}}switch(a.type){case H.Sequence:i=new R.Sequence({value:o});break;case H.Set:i=new R.Set({value:o});break;case H.Choice:if(!o[0])throw new Error("Schema '".concat(n.name,"' has wrong data. Choice cannot be empty."));i=o[0]}return i}},{key:"toAsnItem",value:function(e,t,r,n){var a,i=this;if("number"===typeof e.type){var o=e.converter;if(!o)throw new Error("Property '".concat(t,"' doesn't have converter for type ").concat(I[e.type]," in schema '").concat(r.name,"'"));if(e.repeated){var u=Array.from(n,(function(e){return o.toASN(e)}));a=new("sequence"===e.repeated?R.Sequence:R.Set)({value:u})}else a=o.toASN(n)}else if(e.repeated){var c=Array.from(n,(function(e){return i.toASN(e)}));a=new("sequence"===e.repeated?R.Sequence:R.Set)({value:c})}else a=this.toASN(n);return a}}]),e}(),Oe=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"serialize",value:function(e){return we.serialize(e)}},{key:"parse",value:function(e,t){return me.parse(e,t)}}]),e}(),Be=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n){var a;return Object(p.a)(this,r),(a=t.call(this,n?"".concat(e,". See the inner exception for more details."):e)).message=e,a.innerError=n,a}return r}(Object(s.a)(Error)),Ae=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n,a){return Object(p.a)(this,r),t.call(this,e,"JSON doesn't match to '".concat(e.target.name,"' schema. ").concat(n),a)}return r}(function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n,a){var i;return Object(p.a)(this,r),(i=t.call(this,n,a)).schema=e,i}return r}(Be)),je=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return r}(Be),xe=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n,a){var i;return Object(p.a)(this,r),(i=t.call(this,"Cannot serialize by '".concat(e,"' schema. ").concat(n),a)).schemaName=e,i}return r}(Be),Se=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(p.a)(this,r),(a=t.call(this,e,"Some keys doesn't match to schema")).keys=n,a.errors=i,a}return r}(Ae);function Ce(e,t){if(!function(e,t){switch(t){case pe.Boolean:return"boolean"===typeof e;case pe.Number:return"number"===typeof e;case pe.String:return"string"===typeof e}return!0}(e,t))throw new TypeError("Value must be ".concat(pe[t]))}function Ke(e){return e&&e.prototype?!(!e.prototype.toJSON||!e.prototype.fromJSON)||Ke(e.prototype):!!(e&&e.toJSON&&e.fromJSON)}!function(e){e[e.Any=0]="Any",e[e.Boolean=1]="Boolean",e[e.Number=2]="Number",e[e.String=3]="String"}(pe||(pe={}));var Ee="default",Ne=new(function(){function e(){Object(p.a)(this,e),this.items=new Map}return Object(b.a)(e,[{key:"has",value:function(e){return this.items.has(e)||!!this.findParentSchema(e)}},{key:"get",value:function(e){var t=this.items.get(e)||this.findParentSchema(e);if(!t)throw new Error("Cannot get schema for current target");return t}},{key:"create",value:function(e){var t={names:{}},r=this.findParentSchema(e);if(r)for(var n in Object.assign(t,r),t.names={},r.names)t.names[n]=Object.assign({},r.names[n]);return t.target=e,t}},{key:"set",value:function(e,t){return this.items.set(e,t),this}},{key:"findParentSchema",value:function(e){var t=e.__proto__;return t?this.items.get(t)||this.findParentSchema(t):null}}]),e}()),Ue=function(){function e(t){Object(p.a)(this,e),this.pattern=new RegExp(t)}return Object(b.a)(e,[{key:"validate",value:function(e){var t=new RegExp(this.pattern.source,this.pattern.flags);if("string"!==typeof e)throw new je("Incoming value must be string");if(!t.exec(e))throw new je("Value doesn't match to pattern '".concat(t.toString(),"'"))}}]),e}(),Pe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.MIN_VALUE,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;Object(p.a)(this,e),this.min=t,this.max=r}return Object(b.a)(e,[{key:"validate",value:function(e){if(Ce(e,pe.Number),!(this.min<=e&&e<=this.max)){var t=this.min===Number.MIN_VALUE?"MIN":this.min,r=this.max===Number.MAX_VALUE?"MAX":this.max;throw new je("Value doesn't match to diapason [".concat(t,",").concat(r,"]"))}}}]),e}(),Le=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.MIN_VALUE,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;Object(p.a)(this,e),this.min=t,this.max=r}return Object(b.a)(e,[{key:"validate",value:function(e){if(Ce(e,pe.Number),!(this.min<e&&e<this.max)){var t=this.min===Number.MIN_VALUE?"MIN":this.min,r=this.max===Number.MAX_VALUE?"MAX":this.max;throw new je("Value doesn't match to diapason (".concat(t,",").concat(r,")"))}}}]),e}(),He=function(){function e(t,r,n){Object(p.a)(this,e),this.length=t,this.minLength=r,this.maxLength=n}return Object(b.a)(e,[{key:"validate",value:function(e){if(void 0===this.length){if(void 0!==this.minLength&&e.length<this.minLength)throw new je("Value length must be more than ".concat(this.minLength,"."));if(void 0!==this.maxLength&&e.length>this.maxLength)throw new je("Value length must be less than ".concat(this.maxLength,"."))}else if(e.length!==this.length)throw new je("Value length must be exactly ".concat(this.length,"."))}}]),e}(),Ie=function(){function e(t){Object(p.a)(this,e),this.enumeration=t}return Object(b.a)(e,[{key:"validate",value:function(e){if(Ce(e,pe.String),!this.enumeration.includes(e))throw new je("Value must be one of ".concat(this.enumeration.map((function(e){return"'".concat(e,"'")})).join(", ")))}}]),e}(),Te=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"checkValues",value:function(e,t){var r,n=Array.isArray(e)?e:[e],a=Object(y.a)(n);try{for(a.s();!(r=a.n()).done;){var i,o=r.value,u=Object(y.a)(t.validations);try{for(u.s();!(i=u.n()).done;){var c=i.value;c instanceof He&&t.repeated?c.validate(e):c.validate(o)}}catch(on){u.e(on)}finally{u.f()}}}catch(on){a.e(on)}finally{a.f()}}},{key:"checkTypes",value:function(e,t){if(t.repeated&&!Array.isArray(e))throw new TypeError("Value must be Array");if("number"===typeof t.type){var r,n=Array.isArray(e)?e:[e],a=Object(y.a)(n);try{for(a.s();!(r=a.n()).done;){Ce(r.value,t.type)}}catch(on){a.e(on)}finally{a.f()}}}},{key:"getSchemaByName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ee;return Object(c.a)(Object(c.a)({},e.names.default),e.names[t])}}]),e}(),Re=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return Object(b.a)(r,null,[{key:"serialize",value:function(e,t,r,n){var a=this.toJSON(e,t);return JSON.stringify(a,r,n)}},{key:"toJSON",value:function(e){var t,r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.targetSchema,i=n.schemaName||Ee;if(Ke(e))return e.toJSON();if(Array.isArray(e)){t=[];var o,u=Object(y.a)(e);try{for(u.s();!(o=u.n()).done;){var c=o.value;t.push(this.toJSON(c,n))}}catch(on){u.e(on)}finally{u.f()}}else if("object"===typeof e){if(a&&!Ne.has(a))throw new Be("Cannot get schema for `targetSchema` param");if(a=a||e.constructor,Ne.has(a)){var s=Ne.get(a);t={};var l=this.getSchemaByName(s,i);for(var h in l)try{var f=function(){var n=l[h],o=e[h],u=void 0;if(n.optional&&void 0===o||void 0!==n.defaultValue&&o===n.defaultValue)return"continue";if(!n.optional&&void 0===o)throw new xe(a.name,"Property '".concat(h,"' is required."));u="number"===typeof n.type?n.converter?n.repeated?o.map((function(t){return n.converter.toJSON(t,e)})):n.converter.toJSON(o,e):o:n.repeated?o.map((function(e){return r.toJSON(e,{schemaName:i})})):r.toJSON(o,{schemaName:i}),r.checkTypes(u,n),r.checkValues(u,n),t[n.name||h]=u}();if("continue"===f)continue}catch(k){throw k instanceof xe?k:new xe(s.target.name,"Property '".concat(h,"' is wrong. ").concat(k.message),k)}}else for(var v in t={},e)t[v]=this.toJSON(e[v],{schemaName:i})}else t=e;return t}}]),r}(Te),De=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return Object(b.a)(r,null,[{key:"parse",value:function(e,t){var r=JSON.parse(e);return this.fromJSON(r,t)}},{key:"fromJSON",value:function(e,t){var n=this,a=t.targetSchema,i=t.schemaName||Ee,o=new a;if(Ke(o))return o.fromJSON(e);var u=Ne.get(a),s=this.getSchemaByName(u,i),l={};for(var h in t.strictProperty&&!Array.isArray(e)&&r.checkStrictProperty(e,s,u),s)try{if("continue"===function(){var r=s[h],a=r.name||h,l=e[a];if(void 0===l&&(r.optional||void 0!==r.defaultValue))return"continue";if(!r.optional&&void 0===l)throw new Ae(u,"Property '".concat(a,"' is required."));if(n.checkTypes(l,r),n.checkValues(l,r),"number"===typeof r.type)r.converter?r.repeated?o[h]=l.map((function(e){return r.converter.fromJSON(e,o)})):o[h]=r.converter.fromJSON(l,o):o[h]=l;else{var f=Object(c.a)(Object(c.a)({},t),{},{targetSchema:r.type,schemaName:i});r.repeated?o[h]=l.map((function(e){return n.fromJSON(e,f)})):o[h]=n.fromJSON(l,f)}}())continue}catch(k){if(k instanceof Ae||(k=new Ae(u,"Property '".concat(h,"' is wrong. ").concat(k.message),k)),!t.strictAllKeys)throw k;l[h]=k}var f=Object.keys(l);if(f.length)throw new Se(u,f,l);return o}},{key:"checkStrictProperty",value:function(e,t,r){for(var n=Object.keys(e),a=Object.keys(t),i=[],o=0,u=n;o<u.length;o++){var c=u[o];-1===a.indexOf(c)&&i.push(c)}if(i.length)throw new Se(r,i)}}]),r}(Te);function _e(e){var t=[];return e.pattern&&t.push(new Ue(e.pattern)),e.type!==pe.Number&&e.type!==pe.Any||(void 0===e.minInclusive&&void 0===e.maxInclusive||t.push(new Pe(e.minInclusive,e.maxInclusive)),void 0===e.minExclusive&&void 0===e.maxExclusive||t.push(new Le(e.minExclusive,e.maxExclusive)),void 0!==e.enumeration&&t.push(new Ie(e.enumeration))),(e.type===pe.String||e.repeated||e.type===pe.Any)&&(void 0===e.length&&void 0===e.minLength&&void 0===e.maxLength||t.push(new He(e.length,e.minLength,e.maxLength))),t}var Ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,r){var n,a="Cannot set type for ".concat(r," property of ").concat(t.constructor.name," schema");Ne.has(t.constructor)?(n=Ne.get(t.constructor)).target!==t.constructor&&(n=Ne.create(t.constructor),Ne.set(t.constructor,n)):(n=Ne.create(t.constructor),Ne.set(t.constructor,n));var i,o={type:pe.Any,validations:[]},u=Object.assign(o,e);if(u.validations=_e(u),"number"!==typeof u.type&&!Ne.has(u.type)&&!Ke(u.type))throw new Error("".concat(a,". Assigning type doesn't have schema."));i=Array.isArray(e.schema)?e.schema:[e.schema||Ee];var c,s=Object(y.a)(i);try{for(s.s();!(c=s.n()).done;){var l=c.value;n.names[l]||(n.names[l]={}),n.names[l][r]=u}}catch(on){s.e(on)}finally{s.f()}}},Je=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return r}(Object(s.a)(Error)),Fe=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return r}(Je),Me=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e){return Object(p.a)(this,r),t.call(this,"Unsupported operation: ".concat(e?"".concat(e):""))}return r}(Je),ze=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return r}(Je),qe=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e){return Object(p.a)(this,r),t.call(this,"".concat(e,": Missing required property"))}return r}(Je);function Ge(e){return"object"===typeof e&&"kty"in e}var We=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,[{key:"digest",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,r=new Array(t),n=0;n<t;n++)r[n]=a[n];return this.checkDigest.apply(this,r),e.abrupt("return",this.onDigest.apply(this,r));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkDigest",value:function(e,t){this.checkAlgorithmName(e)}},{key:"onDigest",value:function(){var e=Object(u.a)(o.mark((function e(t,r){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Me("digest");case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"generateKey",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,r=new Array(t),n=0;n<t;n++)r[n]=a[n];return this.checkGenerateKey.apply(this,r),e.abrupt("return",this.onGenerateKey.apply(this,r));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkGenerateKey",value:function(e,t,r){if(this.checkAlgorithmName(e),this.checkGenerateKeyParams(e),!r||!r.length)throw new TypeError("Usages cannot be empty when creating a key.");var n;n=Array.isArray(this.usages)?this.usages:this.usages.privateKey.concat(this.usages.publicKey),this.checkKeyUsages(r,n)}},{key:"checkGenerateKeyParams",value:function(e){}},{key:"onGenerateKey",value:function(){var e=Object(u.a)(o.mark((function e(t,r,n){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Me("generateKey");case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,r=new Array(t),n=0;n<t;n++)r[n]=a[n];return this.checkSign.apply(this,r),e.abrupt("return",this.onSign.apply(this,r));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkSign",value:function(e,t,r){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,"sign")}},{key:"onSign",value:function(){var e=Object(u.a)(o.mark((function e(t,r,n){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Me("sign");case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"verify",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,r=new Array(t),n=0;n<t;n++)r[n]=a[n];return this.checkVerify.apply(this,r),e.abrupt("return",this.onVerify.apply(this,r));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkVerify",value:function(e,t,r,n){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,"verify")}},{key:"onVerify",value:function(){var e=Object(u.a)(o.mark((function e(t,r,n,a){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Me("verify");case 1:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"encrypt",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,r=new Array(t),n=0;n<t;n++)r[n]=a[n];return this.checkEncrypt.apply(this,r),e.abrupt("return",this.onEncrypt.apply(this,r));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkEncrypt",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,n.keyUsage?"encrypt":void 0)}},{key:"onEncrypt",value:function(){var e=Object(u.a)(o.mark((function e(t,r,n){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Me("encrypt");case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"decrypt",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,r=new Array(t),n=0;n<t;n++)r[n]=a[n];return this.checkDecrypt.apply(this,r),e.abrupt("return",this.onDecrypt.apply(this,r));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkDecrypt",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,n.keyUsage?"decrypt":void 0)}},{key:"onDecrypt",value:function(){var e=Object(u.a)(o.mark((function e(t,r,n){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Me("decrypt");case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"deriveBits",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,r=new Array(t),n=0;n<t;n++)r[n]=a[n];return this.checkDeriveBits.apply(this,r),e.abrupt("return",this.onDeriveBits.apply(this,r));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkDeriveBits",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,n.keyUsage?"deriveBits":void 0),r%8!==0)throw new ze("length: Is not multiple of 8")}},{key:"onDeriveBits",value:function(){var e=Object(u.a)(o.mark((function e(t,r,n){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Me("deriveBits");case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"exportKey",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,r=new Array(t),n=0;n<t;n++)r[n]=a[n];return this.checkExportKey.apply(this,r),e.abrupt("return",this.onExportKey.apply(this,r));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkExportKey",value:function(e,t){if(this.checkKeyFormat(e),this.checkCryptoKey(t),!t.extractable)throw new Je("key: Is not extractable")}},{key:"onExportKey",value:function(){var e=Object(u.a)(o.mark((function e(t,r){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Me("exportKey");case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"importKey",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,r=new Array(t),n=0;n<t;n++)r[n]=a[n];return this.checkImportKey.apply(this,r),e.abrupt("return",this.onImportKey.apply(this,r));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkImportKey",value:function(e,t,r,n,a){this.checkKeyFormat(e),this.checkKeyData(e,t),this.checkAlgorithmName(r),this.checkImportParams(r),Array.isArray(this.usages)&&this.checkKeyUsages(a,this.usages)}},{key:"onImportKey",value:function(){var e=Object(u.a)(o.mark((function e(t,r,n,a,i){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Me("importKey");case 1:case"end":return e.stop()}}),e)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"checkAlgorithmName",value:function(e){if(e.name.toLowerCase()!==this.name.toLowerCase())throw new Fe("Unrecognized name")}},{key:"checkAlgorithmParams",value:function(e){}},{key:"checkDerivedKeyParams",value:function(e){}},{key:"checkKeyUsages",value:function(e,t){var r,n=Object(y.a)(e);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(-1===t.indexOf(a))throw new TypeError("Cannot create a key using the specified key usages")}}catch(on){n.e(on)}finally{n.f()}}},{key:"checkCryptoKey",value:function(e,t){if(this.checkAlgorithmName(e.algorithm),t&&-1===e.usages.indexOf(t))throw new Je("key does not match that of operation")}},{key:"checkRequiredProperty",value:function(e,t){if(!(t in e))throw new qe(t)}},{key:"checkHashAlgorithm",value:function(e,t){var r,n=Object(y.a)(t);try{for(n.s();!(r=n.n()).done;){if(r.value.toLowerCase()===e.name.toLowerCase())return}}catch(on){n.e(on)}finally{n.f()}throw new ze("hash: Must be one of ".concat(t.join(", ")))}},{key:"checkImportParams",value:function(e){}},{key:"checkKeyFormat",value:function(e){switch(e){case"raw":case"pkcs8":case"spki":case"jwk":break;default:throw new TypeError("format: Is invalid value. Must be 'jwk', 'raw', 'spki', or 'pkcs8'")}}},{key:"checkKeyData",value:function(e,t){if(!t)throw new TypeError("keyData: Cannot be empty on empty on key importing");if("jwk"===e){if(!Ge(t))throw new TypeError("keyData: Is not JsonWebToken")}else if(!B.isBufferSource(t))throw new TypeError("keyData: Is not ArrayBufferView or ArrayBuffer")}},{key:"prepareData",value:function(e){return B.toArrayBuffer(e)}}]),e}(),Ze=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return Object(b.a)(r,[{key:"checkGenerateKeyParams",value:function(e){if(this.checkRequiredProperty(e,"length"),"number"!==typeof e.length)throw new TypeError("length: Is not of type Number");switch(e.length){case 128:case 192:case 256:break;default:throw new TypeError("length: Must be 128, 192, or 256")}}},{key:"checkDerivedKeyParams",value:function(e){this.checkGenerateKeyParams(e)}}]),r}(We),Xe=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="AES-CBC",e.usages=["encrypt","decrypt","wrapKey","unwrapKey"],e}return Object(b.a)(r,[{key:"checkAlgorithmParams",value:function(e){if(this.checkRequiredProperty(e,"iv"),!(e.iv instanceof ArrayBuffer||ArrayBuffer.isView(e.iv)))throw new TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(16!==e.iv.byteLength)throw new TypeError("iv: Must have length 16 bytes")}}]),r}(Ze),$e=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="AES-CTR",e.usages=["encrypt","decrypt","wrapKey","unwrapKey"],e}return Object(b.a)(r,[{key:"checkAlgorithmParams",value:function(e){if(this.checkRequiredProperty(e,"counter"),!(e.counter instanceof ArrayBuffer||ArrayBuffer.isView(e.counter)))throw new TypeError("counter: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(16!==e.counter.byteLength)throw new TypeError("iv: Must have length 16 bytes");if(this.checkRequiredProperty(e,"length"),"number"!==typeof e.length)throw new TypeError("length: Is not a Number");if(e.length<1)throw new ze("length: Must be more than 0")}}]),r}(Ze),Ye=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="AES-ECB",e.usages=["encrypt","decrypt","wrapKey","unwrapKey"],e}return r}(Ze),Qe=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="AES-GCM",e.usages=["encrypt","decrypt","wrapKey","unwrapKey"],e}return Object(b.a)(r,[{key:"checkAlgorithmParams",value:function(e){if(this.checkRequiredProperty(e,"iv"),!(e.iv instanceof ArrayBuffer||ArrayBuffer.isView(e.iv)))throw new TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(e.iv.byteLength<1)throw new ze("iv: Must have length more than 0 and less than 2^64 - 1");switch("tagLength"in e||(e.tagLength=128),e.tagLength){case 32:case 64:case 96:case 104:case 112:case 120:case 128:break;default:throw new ze("tagLength: Must be one of 32, 64, 96, 104, 112, 120 or 128")}}}]),r}(Ze),et=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="AES-KW",e.usages=["wrapKey","unwrapKey"],e}return r}(Ze),tt=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).usages=["encrypt","decrypt","wrapKey","unwrapKey"],e}return Object(b.a)(r,[{key:"checkAlgorithmParams",value:function(e){if(this.ivSize){if(this.checkRequiredProperty(e,"iv"),!(e.iv instanceof ArrayBuffer||ArrayBuffer.isView(e.iv)))throw new TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(e.iv.byteLength!==this.ivSize)throw new TypeError("iv: Must have length ".concat(this.ivSize," bytes"))}}},{key:"checkGenerateKeyParams",value:function(e){if(this.checkRequiredProperty(e,"length"),"number"!==typeof e.length)throw new TypeError("length: Is not of type Number");if(e.length!==this.keySizeBits)throw new ze("algorith.length: Must be ".concat(this.keySizeBits))}},{key:"checkDerivedKeyParams",value:function(e){this.checkGenerateKeyParams(e)}}]),r}(We),rt=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],e}return Object(b.a)(r,[{key:"checkGenerateKeyParams",value:function(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),this.checkRequiredProperty(e,"publicExponent"),!(e.publicExponent&&e.publicExponent instanceof Uint8Array))throw new TypeError("publicExponent: Missing or not a Uint8Array");var t=j.ToBase64(e.publicExponent);if("Aw=="!==t&&"AQAB"!==t)throw new TypeError("publicExponent: Must be [3] or [1,0,1]");switch(this.checkRequiredProperty(e,"modulusLength"),e.modulusLength){case 1024:case 2048:case 4096:break;default:throw new TypeError("modulusLength: Must be 1024, 2048, or 4096")}}},{key:"checkImportParams",value:function(e){this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms)}}]),r}(We),nt=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="RSASSA-PKCS1-v1_5",e.usages={privateKey:["sign"],publicKey:["verify"]},e}return r}(rt),at=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="RSA-PSS",e.usages={privateKey:["sign"],publicKey:["verify"]},e}return Object(b.a)(r,[{key:"checkAlgorithmParams",value:function(e){if(this.checkRequiredProperty(e,"saltLength"),"number"!==typeof e.saltLength)throw new TypeError("saltLength: Is not a Number");if(e.saltLength<0)throw new RangeError("saltLength: Must be positive number")}}]),r}(rt),it=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="RSA-OAEP",e.usages={privateKey:["decrypt","unwrapKey"],publicKey:["encrypt","wrapKey"]},e}return Object(b.a)(r,[{key:"checkAlgorithmParams",value:function(e){if(e.label&&!(e.label instanceof ArrayBuffer||ArrayBuffer.isView(e.label)))throw new TypeError("label: Is not of type '(ArrayBuffer or ArrayBufferView)'")}}]),r}(rt),ot=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return Object(b.a)(r,[{key:"checkGenerateKeyParams",value:function(e){this.checkRequiredProperty(e,"namedCurve"),this.checkNamedCurve(e.namedCurve)}},{key:"checkNamedCurve",value:function(e){var t,r=Object(y.a)(this.namedCurves);try{for(r.s();!(t=r.n()).done;){if(t.value.toLowerCase()===e.toLowerCase())return}}catch(on){r.e(on)}finally{r.f()}throw new ze("namedCurve: Must be one of ".concat(this.namedCurves.join(", ")))}}]),r}(We),ut=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="ECDSA",e.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],e.usages={privateKey:["sign"],publicKey:["verify"]},e.namedCurves=["P-256","P-384","P-521","K-256"],e}return Object(b.a)(r,[{key:"checkAlgorithmParams",value:function(e){this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms)}}]),r}(ot),ct=["secret","private","public"],st=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,[{key:Symbol.toStringTag,get:function(){return"CryptoKey"}}],[{key:"create",value:function(e,t,r,n){var a=new this;return a.algorithm=e,a.type=t,a.extractable=r,a.usages=n,a}},{key:"isKeyType",value:function(e){return-1!==ct.indexOf(e)}}]),e}(),lt=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="ECDH",e.usages={privateKey:["deriveBits","deriveKey"],publicKey:[]},e.namedCurves=["P-256","P-384","P-521","K-256"],e}return Object(b.a)(r,[{key:"checkAlgorithmParams",value:function(e){if(this.checkRequiredProperty(e,"public"),!(e.public instanceof st))throw new TypeError("public: Is not a CryptoKey");if("public"!==e.public.type)throw new ze("public: Is not a public key");if(e.public.algorithm.name!==this.name)throw new ze("public: Is not ".concat(this.name," key"))}}]),r}(ot),ht=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="EdDSA",e.usages={privateKey:["sign"],publicKey:["verify"]},e.namedCurves=["Ed25519","Ed448"],e}return r}(ot),ft=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="HMAC",e.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],e.usages=["sign","verify"],e}return Object(b.a)(r,[{key:"getDefaultLength",value:function(e){switch(e.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":return 512;default:throw new Error("Unknown algorithm name '".concat(e,"'"))}}},{key:"checkGenerateKeyParams",value:function(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),"length"in e){if("number"!==typeof e.length)throw new TypeError("length: Is not a Number");if(e.length<1)throw new RangeError("length: Number is out of range")}}},{key:"checkImportParams",value:function(e){this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms)}}]),r}(We),vt=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="PBKDF2",e.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],e.usages=["deriveBits","deriveKey"],e}return Object(b.a)(r,[{key:"checkAlgorithmParams",value:function(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),this.checkRequiredProperty(e,"salt"),!(e.salt instanceof ArrayBuffer||ArrayBuffer.isView(e.salt)))throw new TypeError("salt: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(this.checkRequiredProperty(e,"iterations"),"number"!==typeof e.iterations)throw new TypeError("iterations: Is not a Number");if(e.iterations<1)throw new TypeError("iterations: Is less than 1")}},{key:"checkImportKey",value:function(e,t,n,a,i){if(Object(l.a)(Object(h.a)(r.prototype),"checkImportKey",this).call(this,e,t,n,a,i),a)throw new SyntaxError("extractable: Must be 'false'")}}]),r}(We),yt=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,[{key:Symbol.toStringTag,get:function(){return"Crypto"}}]),e}(),pt=function(){function e(){Object(p.a)(this,e),this.items={}}return Object(b.a)(e,[{key:"get",value:function(e){return this.items[e.toLowerCase()]||null}},{key:"set",value:function(e){this.items[e.name.toLowerCase()]=e}},{key:"removeAt",value:function(e){var t=this.get(e.toLowerCase());return t&&delete this.items[e],t}},{key:"has",value:function(e){return!!this.get(e)}},{key:"length",get:function(){return Object.keys(this.items).length}},{key:"algorithms",get:function(){var e=[];for(var t in this.items){var r=this.items[t];e.push(r.name)}return e.sort()}}]),e}(),bt=function(){function e(){Object(p.a)(this,e),this.providers=new pt}return Object(b.a)(e,[{key:Symbol.toStringTag,get:function(){return"SubtleCrypto"}},{key:"digest",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a,u,c,s,l,h,f,v=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=v.length,r=new Array(t),n=0;n<t;n++)r[n]=v[n];return this.checkRequiredArguments(r,2,"digest"),a=r[0],u=r[1],c=r.slice(2),s=this.prepareAlgorithm(a),l=B.toArrayBuffer(u),h=this.getProvider(s.name),e.next=8,h.digest.apply(h,[s,l].concat(Object(i.a)(c)));case 8:return f=e.sent,e.abrupt("return",f);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generateKey",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a,u,s,l,h,f,v,y=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=y.length,r=new Array(t),n=0;n<t;n++)r[n]=y[n];return this.checkRequiredArguments(r,3,"generateKey"),a=r[0],u=r[1],s=r[2],l=r.slice(3),h=this.prepareAlgorithm(a),f=this.getProvider(h.name),e.next=7,f.generateKey.apply(f,[Object(c.a)(Object(c.a)({},h),{},{name:f.name}),u,s].concat(Object(i.a)(l)));case 7:return v=e.sent,e.abrupt("return",v);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a,u,s,l,h,f,v,y,p=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=p.length,r=new Array(t),n=0;n<t;n++)r[n]=p[n];return this.checkRequiredArguments(r,3,"sign"),a=r[0],u=r[1],s=r[2],l=r.slice(3),this.checkCryptoKey(u),h=this.prepareAlgorithm(a),f=B.toArrayBuffer(s),v=this.getProvider(h.name),e.next=9,v.sign.apply(v,[Object(c.a)(Object(c.a)({},h),{},{name:v.name}),u,f].concat(Object(i.a)(l)));case 9:return y=e.sent,e.abrupt("return",y);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"verify",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a,u,s,l,h,f,v,y,p,b,d=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=d.length,r=new Array(t),n=0;n<t;n++)r[n]=d[n];return this.checkRequiredArguments(r,4,"verify"),a=r[0],u=r[1],s=r[2],l=r[3],h=r.slice(4),this.checkCryptoKey(u),f=this.prepareAlgorithm(a),v=B.toArrayBuffer(l),y=B.toArrayBuffer(s),p=this.getProvider(f.name),e.next=10,p.verify.apply(p,[Object(c.a)(Object(c.a)({},f),{},{name:p.name}),u,y,v].concat(Object(i.a)(h)));case 10:return b=e.sent,e.abrupt("return",b);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"encrypt",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a,u,s,l,h,f,v,y,p=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=p.length,r=new Array(t),n=0;n<t;n++)r[n]=p[n];return this.checkRequiredArguments(r,3,"encrypt"),a=r[0],u=r[1],s=r[2],l=r.slice(3),this.checkCryptoKey(u),h=this.prepareAlgorithm(a),f=B.toArrayBuffer(s),v=this.getProvider(h.name),e.next=9,v.encrypt.apply(v,[Object(c.a)(Object(c.a)({},h),{},{name:v.name}),u,f,{keyUsage:!0}].concat(Object(i.a)(l)));case 9:return y=e.sent,e.abrupt("return",y);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"decrypt",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a,u,s,l,h,f,v,y,p=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=p.length,r=new Array(t),n=0;n<t;n++)r[n]=p[n];return this.checkRequiredArguments(r,3,"decrypt"),a=r[0],u=r[1],s=r[2],l=r.slice(3),this.checkCryptoKey(u),h=this.prepareAlgorithm(a),f=B.toArrayBuffer(s),v=this.getProvider(h.name),e.next=9,v.decrypt.apply(v,[Object(c.a)(Object(c.a)({},h),{},{name:v.name}),u,f,{keyUsage:!0}].concat(Object(i.a)(l)));case 9:return y=e.sent,e.abrupt("return",y);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deriveBits",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a,u,s,l,h,f,v,y=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=y.length,r=new Array(t),n=0;n<t;n++)r[n]=y[n];return this.checkRequiredArguments(r,3,"deriveBits"),a=r[0],u=r[1],s=r[2],l=r.slice(3),this.checkCryptoKey(u),h=this.prepareAlgorithm(a),f=this.getProvider(h.name),e.next=8,f.deriveBits.apply(f,[Object(c.a)(Object(c.a)({},h),{},{name:f.name}),u,s,{keyUsage:!0}].concat(Object(i.a)(l)));case 8:return v=e.sent,e.abrupt("return",v);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deriveKey",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a,u,s,l,h,f,v,y,p,b,d=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=d.length,r=new Array(t),n=0;n<t;n++)r[n]=d[n];return this.checkRequiredArguments(r,5,"deriveKey"),a=r[0],u=r[1],s=r[2],l=r[3],h=r[4],f=r.slice(5),v=this.prepareAlgorithm(s),this.getProvider(v.name).checkDerivedKeyParams(v),y=this.prepareAlgorithm(a),(p=this.getProvider(y.name)).checkCryptoKey(u,"deriveKey"),e.next=11,p.deriveBits.apply(p,[Object(c.a)(Object(c.a)({},y),{},{name:p.name}),u,s.length||512,{keyUsage:!1}].concat(Object(i.a)(f)));case 11:return b=e.sent,e.abrupt("return",this.importKey.apply(this,["raw",b,s,l,h].concat(Object(i.a)(f))));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"exportKey",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a,u,c,s,l,h=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=h.length,r=new Array(t),n=0;n<t;n++)r[n]=h[n];return this.checkRequiredArguments(r,2,"exportKey"),a=r[0],u=r[1],c=r.slice(2),this.checkCryptoKey(u),s=this.getProvider(u.algorithm.name),e.next=7,s.exportKey.apply(s,[a,u].concat(Object(i.a)(c)));case 7:return l=e.sent,e.abrupt("return",l);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"importKey",value:function(){var e=Object(u.a)(o.mark((function e(){var t,r,n,a,u,s,l,h,f,v,y,p,b=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=b.length,r=new Array(t),n=0;n<t;n++)r[n]=b[n];if(this.checkRequiredArguments(r,5,"importKey"),a=r[0],u=r[1],s=r[2],l=r[3],h=r[4],f=r.slice(5),v=this.prepareAlgorithm(s),y=this.getProvider(v.name),-1===["pkcs8","spki","raw"].indexOf(a)){e.next=10;break}return p=B.toArrayBuffer(u),e.abrupt("return",y.importKey.apply(y,[a,p,Object(c.a)(Object(c.a)({},v),{},{name:y.name}),l,h].concat(Object(i.a)(f))));case 10:if(u.kty){e.next=12;break}throw new TypeError("keyData: Is not JSON");case 12:return e.abrupt("return",y.importKey.apply(y,[a,u,Object(c.a)(Object(c.a)({},v),{},{name:y.name}),l,h].concat(Object(i.a)(f))));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"wrapKey",value:function(){var e=Object(u.a)(o.mark((function e(t,r,n,a){var i,u,s,l,h,f,v,y,p=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=p.length,u=new Array(i>4?i-4:0),s=4;s<i;s++)u[s-4]=p[s];return e.next=3,this.exportKey.apply(this,[t,r].concat(u));case 3:return l=e.sent,"jwk"===t&&(h=JSON.stringify(l),l=j.FromUtf8String(h)),f=this.prepareAlgorithm(a),v=B.toArrayBuffer(l),y=this.getProvider(f.name),e.abrupt("return",y.encrypt.apply(y,[Object(c.a)(Object(c.a)({},f),{},{name:y.name}),n,v,{keyUsage:!1}].concat(u)));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"unwrapKey",value:function(){var e=Object(u.a)(o.mark((function e(t,r,n,a,i,u,s){var l,h,f,v,y,p,b,d,g=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(l=this.prepareAlgorithm(a),h=B.toArrayBuffer(r),f=this.getProvider(l.name),v=g.length,y=new Array(v>7?v-7:0),p=7;p<v;p++)y[p-7]=g[p];return e.next=6,f.decrypt.apply(f,[Object(c.a)(Object(c.a)({},l),{},{name:f.name}),n,h,{keyUsage:!1}].concat(y));case 6:if(b=e.sent,"jwk"!==t){e.next=17;break}e.prev=8,b=JSON.parse(j.ToUtf8String(b)),e.next=17;break;case 12:throw e.prev=12,e.t0=e.catch(8),(d=new TypeError("wrappedKey: Is not a JSON")).internal=e.t0,d;case 17:return e.abrupt("return",this.importKey.apply(this,[t,b,i,u,s].concat(y)));case 18:case"end":return e.stop()}}),e,this,[[8,12]])})));return function(t,r,n,a,i,o,u){return e.apply(this,arguments)}}()},{key:"checkRequiredArguments",value:function(e,t,r){if(e.length<t)throw new TypeError("Failed to execute '".concat(r,"' on 'SubtleCrypto': ").concat(t," arguments required, but only ").concat(e.length," present"))}},{key:"prepareAlgorithm",value:function(t){if("string"===typeof t)return{name:t};if(e.isHashedAlgorithm(t)){var r=Object(c.a)({},t);return r.hash=this.prepareAlgorithm(t.hash),r}return Object(c.a)({},t)}},{key:"getProvider",value:function(e){var t=this.providers.get(e);if(!t)throw new Fe("Unrecognized name");return t}},{key:"checkCryptoKey",value:function(e){if(!(e instanceof st))throw new TypeError("Key is not of type 'CryptoKey'")}}],[{key:"isHashedAlgorithm",value:function(e){return!!(e&&"object"===typeof e&&"name"in e&&"hash"in e)}}]),e}(),dt=function e(t){Object(p.a)(this,e),t&&(this.value=t)};x([ge({type:I.ObjectIdentifier})],dt.prototype,"value",void 0),dt=x([de({type:H.Choice})],dt);var gt=function e(t){Object(p.a)(this,e),Object.assign(this,t)};x([ge({type:I.ObjectIdentifier})],gt.prototype,"algorithm",void 0),x([ge({type:I.Any,optional:!0})],gt.prototype,"parameters",void 0);var kt=function e(){Object(p.a)(this,e),this.version=0,this.privateKeyAlgorithm=new gt,this.privateKey=new ArrayBuffer(0)};x([ge({type:I.Integer})],kt.prototype,"version",void 0),x([ge({type:gt})],kt.prototype,"privateKeyAlgorithm",void 0),x([ge({type:I.OctetString})],kt.prototype,"privateKey",void 0),x([ge({type:I.Any,optional:!0})],kt.prototype,"attributes",void 0);var mt=function e(){Object(p.a)(this,e),this.publicKeyAlgorithm=new gt,this.publicKey=new ArrayBuffer(0)};x([ge({type:gt})],mt.prototype,"publicKeyAlgorithm",void 0),x([ge({type:I.BitString})],mt.prototype,"publicKey",void 0);var wt={fromJSON:function(e){return j.FromBase64Url(e)},toJSON:function(e){return j.ToBase64Url(new Uint8Array(e))}},Ot={fromASN:function(e){var t=e.valueBlock.valueHex;return new Uint8Array(t)[0]?e.valueBlock.valueHex:e.valueBlock.valueHex.slice(1)},toASN:function(e){var t=new Uint8Array(e)[0]>127?Buffer.concat([Buffer.from([0]),Buffer.from(e)]):Buffer.from(e);return new R.Integer({valueHex:new Uint8Array(t).buffer})}},Bt=function e(){Object(p.a)(this,e),this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0)};x([ge({type:I.Integer,converter:J})],Bt.prototype,"version",void 0),x([ge({type:I.Integer,converter:Ot}),Ve({name:"n",converter:wt})],Bt.prototype,"modulus",void 0),x([ge({type:I.Integer,converter:Ot}),Ve({name:"e",converter:wt})],Bt.prototype,"publicExponent",void 0),x([ge({type:I.Integer,converter:Ot}),Ve({name:"d",converter:wt})],Bt.prototype,"privateExponent",void 0),x([ge({type:I.Integer,converter:Ot}),Ve({name:"p",converter:wt})],Bt.prototype,"prime1",void 0),x([ge({type:I.Integer,converter:Ot}),Ve({name:"q",converter:wt})],Bt.prototype,"prime2",void 0),x([ge({type:I.Integer,converter:Ot}),Ve({name:"dp",converter:wt})],Bt.prototype,"exponent1",void 0),x([ge({type:I.Integer,converter:Ot}),Ve({name:"dq",converter:wt})],Bt.prototype,"exponent2",void 0),x([ge({type:I.Integer,converter:Ot}),Ve({name:"qi",converter:wt})],Bt.prototype,"coefficient",void 0),x([ge({type:I.Any,optional:!0})],Bt.prototype,"otherPrimeInfos",void 0);var At=function e(){Object(p.a)(this,e),this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0)};x([ge({type:I.Integer,converter:Ot}),Ve({name:"n",converter:wt})],At.prototype,"modulus",void 0),x([ge({type:I.Integer,converter:Ot}),Ve({name:"e",converter:wt})],At.prototype,"publicExponent",void 0);var jt=function(){function e(t){Object(p.a)(this,e),this.value=new ArrayBuffer(0),t&&(this.value=t)}return Object(b.a)(e,[{key:"toJSON",value:function(){var e=new Uint8Array(this.value);if(4!==e[0])throw new Je("Wrong ECPoint. Current version supports only Uncompressed (0x04) point");var t=(e=new Uint8Array(this.value.slice(1))).length/2;return{x:j.ToBase64Url(e.buffer.slice(0,0+t)),y:j.ToBase64Url(e.buffer.slice(0+t,0+t+t))}}},{key:"fromJSON",value:function(e){if(!("x"in e))throw new Error("x: Missing required property");if(!("y"in e))throw new Error("y: Missing required property");var t=j.FromBase64Url(e.x),r=j.FromBase64Url(e.y),n=Buffer.concat([new Uint8Array([4]),new Uint8Array(t),new Uint8Array(r)]);return this.value=new Uint8Array(n).buffer,this}}]),e}();x([ge({type:I.OctetString})],jt.prototype,"value",void 0),jt=x([de({type:H.Choice})],jt);var xt=function(){function e(){Object(p.a)(this,e),this.version=1,this.privateKey=new ArrayBuffer(0)}return Object(b.a)(e,[{key:"fromJSON",value:function(e){if(!("d"in e))throw new Error("d: Missing required property");if(this.privateKey=j.FromBase64Url(e.d),"x"in e){var t=new jt;t.fromJSON(e),this.publicKey=we.toASN(t).valueBlock.valueHex}return this}},{key:"toJSON",value:function(){var e={};return e.d=j.ToBase64Url(this.privateKey),this.publicKey&&Object.assign(e,new jt(this.publicKey).toJSON()),e}}]),e}();x([ge({type:I.Integer,converter:J})],xt.prototype,"version",void 0),x([ge({type:I.OctetString})],xt.prototype,"privateKey",void 0),x([ge({context:0,type:I.Any,optional:!0})],xt.prototype,"parameters",void 0),x([ge({context:1,type:I.BitString,optional:!0})],xt.prototype,"publicKey",void 0);var St={fromASN:function(e){var t=new Uint8Array(e.valueBlock.valueHex);return 0===t[0]?t.buffer.slice(1):t.buffer},toASN:function(e){var t=new Uint8Array(e);if(t[0]>127){var r=new Uint8Array(t.length+1);return r.set(t,1),new R.Integer({valueHex:r.buffer})}return new R.Integer({valueHex:e})}},Ct=Object.freeze({__proto__:null,AsnIntegerWithoutPaddingConverter:St}),Kt=function(){function e(){Object(p.a)(this,e),this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0)}return Object(b.a)(e,[{key:"toWebCryptoSignature",value:function(e){e=this.getPointSize();var t=this.addPadding(e,B.toUint8Array(this.r)),r=this.addPadding(e,B.toUint8Array(this.s)),n=new Uint8Array(t.byteLength+r.byteLength);return n.set(t,0),n.set(r,t.length),n.buffer}},{key:"getPointSize",value:function(){switch(Math.max(this.r.byteLength,this.s.byteLength)){case 31:case 32:return 32;case 47:case 48:return 48;case 65:case 66:return 66}throw new Error("Unsupported EC point size")}},{key:"addPadding",value:function(e,t){var r=new Uint8Array(e),n=B.toUint8Array(t);return r.set(n,e-n.length),r}},{key:"removePadding",value:function(e){for(var t=B.toUint8Array(e),r=0;r<t.length;r++)if(t[r])return t.slice(r);return new Uint8Array(0)}}],[{key:"fromWebCryptoSignature",value:function(e){var t=B.toUint8Array(e),r=t.byteLength/2,n=new this;return n.r=n.removePadding(t.slice(0,r)),n.s=n.removePadding(t.slice(r,2*r)),n}}]),e}();x([ge({type:I.Integer,converter:St})],Kt.prototype,"r",void 0),x([ge({type:I.Integer,converter:St})],Kt.prototype,"s",void 0);var Et=function e(){Object(p.a)(this,e)};x([ge({type:I.OctetString}),Ve({type:pe.String,converter:wt})],Et.prototype,"d",void 0),Et=x([de({type:H.Choice})],Et);var Nt,Ut=Object.freeze({__proto__:null,converters:Ct,get ObjectIdentifier(){return dt},AlgorithmIdentifier:gt,PrivateKeyInfo:kt,PublicKeyInfo:mt,RsaPrivateKey:Bt,RsaPublicKey:At,EcPrivateKey:xt,get EcPublicKey(){return jt},EcDsaSignature:Kt,get CurvePrivateKey(){return Et},idX25519:"1.3.101.110",idX448:"1.3.101.111",idEd25519:"1.3.101.112",idEd448:"1.3.101.113"}),Pt=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"enabled",get:function(){return"undefined"!==typeof self&&self.PV_WEBCRYPTO_LINER_LOG}},{key:"log",value:function(){if(this.enabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];console.log.apply(console,t)}}},{key:"error",value:function(){if(this.enabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];console.error.apply(console,t)}}},{key:"info",value:function(){if(this.enabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];console.info.apply(console,t)}}},{key:"warn",value:function(){if(this.enabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];console.warn.apply(console,t)}}},{key:"trace",value:function(){if(this.enabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];console.trace.apply(console,t)}}}]),e}();function Lt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=new Uint8Array(t.map((function(e){return e.length})).reduce((function(e,t){return e+t}))),a=0;return t.forEach((function(e,t){for(var r=0;r<e.length;r++)n[a+r]=e[r];a+=e.length})),n}!function(e){e.Unknown="Unknown",e.IE="Internet Explorer",e.Safari="Safari",e.Edge="Edge",e.Chrome="Chrome",e.Firefox="Firefox Mozilla",e.Mobile="Mobile"}(Nt||(Nt={}));var Ht=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n,a,i){var o;return Object(p.a)(this,r),(o=t.call(this)).extractable=n,o.type=a,o.usages=i,o.algorithm=Object.assign({},e),o}return r}(st);function It(e,t){return e.name.toUpperCase()===t.toUpperCase()}var Tt=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n,a,i){var o;return Object(p.a)(this,r),(o=t.call(this,e,n,"secret",a)).raw=i,o}return Object(b.a)(r,[{key:"toJSON",value:function(){return{kty:"oct",alg:this.getJwkAlgorithm(),k:j.ToBase64Url(this.raw),ext:this.extractable,key_ops:this.usages}}},{key:"getJwkAlgorithm",value:function(){switch(this.algorithm.name.toUpperCase()){case"AES-CBC":return"A".concat(this.algorithm.length,"CBC");case"AES-CTR":return"A".concat(this.algorithm.length,"CTR");case"AES-GCM":return"A".concat(this.algorithm.length,"GCM");case"AES-ECB":return"A".concat(this.algorithm.length,"ECB");default:throw new Fe("Unsupported algorithm name")}}}]),r}(Ht),Rt=function(){function r(){Object(p.a)(this,r)}return Object(b.a)(r,null,[{key:"checkCryptoKey",value:function(e){if(!(e instanceof Tt))throw new TypeError("key: Is not AesCryptoKey")}},{key:"generateKey",value:function(t,r,n){return S(this,void 0,void 0,o.mark((function a(){var i;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=e.nativeCrypto.getRandomValues(new Uint8Array(t.length/8)),a.abrupt("return",new Tt(t,r,n,i));case 2:case"end":return a.stop()}}),a)})))}},{key:"encrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.cipher(e,t,B.toUint8Array(r),!0));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"decrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.cipher(e,t,B.toUint8Array(r),!1));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"exportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=e,r.next="jwk"===r.t0?3:"raw"===r.t0?4:5;break;case 3:return r.abrupt("return",t.toJSON());case 4:return r.abrupt("return",t.raw.buffer);case 5:throw new ze("format: Must be 'jwk' or 'raw'");case 6:case"end":return r.stop()}}),r)})))}},{key:"importKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function e(){var i,u;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Ge(t)?j.FromBase64Url(t.k):B.toArrayBuffer(t),e.t0=i.byteLength<<3,e.next=128===e.t0||192===e.t0||256===e.t0?4:5;break;case 4:return e.abrupt("break",6);case 5:throw new ze("keyData: Is wrong key length");case 6:return u=new Tt({name:r.name,length:i.byteLength<<3},n,a,new Uint8Array(i)),e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)})))}},{key:"cipher",value:function(e,n,a,i){return S(this,void 0,void 0,o.mark((function u(){var c,s,l,h,f,v;return o.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(c=i?"encrypt":"decrypt",!It(e,r.AesCBC)){o.next=6;break}l=B.toUint8Array(e.iv),s=t.AES_CBC[c](a,n.raw,void 0,l),o.next=18;break;case 6:if(!It(e,r.AesGCM)){o.next=13;break}h=B.toUint8Array(e.iv),e.additionalData&&(f=B.toArrayBuffer(e.additionalData)),v=(e.tagLength||128)/8,s=t.AES_GCM[c](a,n.raw,h,f,v),o.next=18;break;case 13:if(!It(e,r.AesECB)){o.next=17;break}s=t.AES_ECB[c](a,n.raw,!0),o.next=18;break;case 17:throw new ze("algorithm: Is not recognized");case 18:return o.abrupt("return",B.toArrayBuffer(s));case 19:case"end":return o.stop()}}),u)})))}}]),r}();Rt.AesCBC="AES-CBC",Rt.AesECB="AES-ECB",Rt.AesGCM="AES-GCM";var Dt=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return Object(b.a)(r,[{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Rt.generateKey(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onEncrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Rt.encrypt(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onDecrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Rt.decrypt(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Rt.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Rt.importKey(e,t,r,n,a));case 1:case"end":return i.stop()}}),i)})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(r.prototype),"checkCryptoKey",this).call(this,e,t),Rt.checkCryptoKey(e)}}]),r}(Xe),_t=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return Object(b.a)(r,[{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Rt.generateKey(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onEncrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Rt.encrypt(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onDecrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Rt.decrypt(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Rt.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Rt.importKey(e,t,r,n,a));case 1:case"end":return i.stop()}}),i)})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(r.prototype),"checkCryptoKey",this).call(this,e,t),Rt.checkCryptoKey(e)}}]),r}(Ye),Vt=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return Object(b.a)(r,[{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Rt.generateKey(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onEncrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Rt.encrypt(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onDecrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Rt.decrypt(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Rt.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Rt.importKey(e,t,r,n,a));case 1:case"end":return i.stop()}}),i)})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(r.prototype),"checkCryptoKey",this).call(this,e,t),Rt.checkCryptoKey(e)}}]),r}(Qe),Jt=function(e){Object(f.a)(n,e);var r=Object(v.a)(n);function n(){return Object(p.a)(this,n),r.apply(this,arguments)}return Object(b.a)(n,[{key:"onEncrypt",value:function(e,r,n){return S(this,void 0,void 0,o.mark((function a(){var i;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=new t.AES_CTR(r.raw,B.toUint8Array(e.counter)).encrypt(B.toUint8Array(n)),a.abrupt("return",B.toArrayBuffer(i));case 2:case"end":return a.stop()}}),a)})))}},{key:"onDecrypt",value:function(e,r,n){return S(this,void 0,void 0,o.mark((function a(){var i;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=new t.AES_CTR(r.raw,B.toUint8Array(e.counter)).decrypt(B.toUint8Array(n)),a.abrupt("return",B.toArrayBuffer(i));case 2:case"end":return a.stop()}}),a)})))}},{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Rt.generateKey(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Rt.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Rt.importKey(e,t,r,n,a));case 1:case"end":return i.stop()}}),i)})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(n.prototype),"checkCryptoKey",this).call(this,e,t),Rt.checkCryptoKey(e)}}]),n}($e),Ft=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return Object(b.a)(r,[{key:"onEncrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return e.stop()}}),e)})))}},{key:"onDecrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return e.stop()}}),e)})))}},{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return e.stop()}}),e)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return e.stop()}}),e)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return e.stop()}}),e)})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(r.prototype),"checkCryptoKey",this).call(this,e,t),Rt.checkCryptoKey(e)}}]),r}(et),Mt=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n,a,i,o){var u;return Object(p.a)(this,r),(u=t.call(this,e,n,a,i)).data=o,u}return r}(Ht),zt=function(){function t(){Object(p.a)(this,t)}return Object(b.a)(t,null,[{key:"checkCryptoKey",value:function(e){if(!(e instanceof Mt))throw new TypeError("key: Is not RsaCryptoKey")}},{key:"generateKey",value:function(t,r,n){return S(this,void 0,void 0,o.mark((function a(){var i,u,c,s,l,h,f,v=this;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i={name:"RSA-PSS",hash:"SHA-256",publicExponent:t.publicExponent,modulusLength:t.modulusLength},a.next=3,e.nativeSubtle.generateKey(i,!0,["sign","verify"]);case 3:return u=a.sent,c=new tn,a.next=7,c.subtle.exportKey("pkcs8",u.privateKey);case 7:return s=a.sent,a.next=10,c.subtle.importKey("pkcs8",s,t,r,n.filter((function(e){return v.privateUsages.includes(e)})));case 10:return l=a.sent,a.next=13,c.subtle.exportKey("spki",u.publicKey);case 13:return h=a.sent,a.next=16,c.subtle.importKey("spki",h,t,!0,n.filter((function(e){return v.publicUsages.includes(e)})));case 16:return f=a.sent,a.abrupt("return",{privateKey:l,publicKey:f});case 18:case"end":return a.stop()}}),a)})))}},{key:"exportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=e,r.next="pkcs8"===r.t0?3:"spki"===r.t0?4:"jwk"===r.t0?5:6;break;case 3:return r.abrupt("return",this.exportPkcs8Key(t));case 4:return r.abrupt("return",this.exportSpkiKey(t));case 5:return r.abrupt("return",this.exportJwkKey(t));case 6:throw new ze("format: Must be 'jwk', 'pkcs8' or 'spki'");case 7:case"end":return r.stop()}}),r,this)})))}},{key:"importKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){var u,c;return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=e,i.next="pkcs8"===i.t0?3:"spki"===i.t0?5:"jwk"===i.t0?7:9;break;case 3:return u=this.importPkcs8Key(t),i.abrupt("break",10);case 5:return u=this.importSpkiKey(t),i.abrupt("break",10);case 7:return u=this.importJwkKey(t),i.abrupt("break",10);case 9:throw new ze("format: Must be 'jwk', 'pkcs8' or 'spki'");case 10:return c=new Mt(Object.assign({publicExponent:1===u[1][1]?u[1].slice(1):u[1].slice(3),modulusLength:u[0].byteLength<<3},r),n,2===u.length?"public":"private",a,u),i.abrupt("return",c);case 12:case"end":return i.stop()}}),i,this)})))}},{key:"randomNonZeroValues",value:function(t){return(t=e.nativeCrypto.getRandomValues(t)).map((function(t){for(;!t;)t=e.nativeCrypto.getRandomValues(new Uint8Array(1))[0];return t}))}},{key:"exportPkcs8Key",value:function(e){var t=new Ut.PrivateKeyInfo;return t.privateKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",t.privateKeyAlgorithm.parameters=null,t.privateKey=Oe.serialize(this.exportAsmKey(e.data)),Oe.serialize(t)}},{key:"importPkcs8Key",value:function(e){var t=Oe.parse(e,Ut.PrivateKeyInfo),r=Oe.parse(t.privateKey,Ut.RsaPrivateKey);return this.importAsmKey(r)}},{key:"importSpkiKey",value:function(e){var t=Oe.parse(e,Ut.PublicKeyInfo),r=Oe.parse(t.publicKey,Ut.RsaPublicKey);return this.importAsmKey(r)}},{key:"exportSpkiKey",value:function(e){var t=new Ut.RsaPublicKey;t.modulus=e.data[0].buffer,t.publicExponent=1===e.data[1][1]?e.data[1].buffer.slice(1):e.data[1].buffer.slice(3);var r=new Ut.PublicKeyInfo;return r.publicKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",r.publicKeyAlgorithm.parameters=null,r.publicKey=Oe.serialize(t),Oe.serialize(r)}},{key:"importJwkKey",value:function(e){var t;return t=e.d?De.fromJSON(e,{targetSchema:Ut.RsaPrivateKey}):De.fromJSON(e,{targetSchema:Ut.RsaPublicKey}),this.importAsmKey(t)}},{key:"exportJwkKey",value:function(e){var t=this.exportAsmKey(e.data),r=Re.toJSON(t);return r.ext=!0,r.key_ops=e.usages,r.kty="RSA",r.alg=this.getJwkAlgorithm(e.algorithm),r}},{key:"getJwkAlgorithm",value:function(e){switch(e.name.toUpperCase()){case"RSA-OAEP":var t=/(\d+)$/.exec(e.hash.name)[1];return"RSA-OAEP".concat("1"!==t?"-".concat(t):"");case"RSASSA-PKCS1-V1_5":return"RS".concat(/(\d+)$/.exec(e.hash.name)[1]);case"RSA-PSS":return"PS".concat(/(\d+)$/.exec(e.hash.name)[1]);case"RSAES-PKCS1-V1_5":return"PS1";default:throw new ze("algorithm: Is not recognized")}}},{key:"exportAsmKey",value:function(e){var t;if(e.length>2){var r=new Ut.RsaPrivateKey;r.privateExponent=e[2].buffer,r.prime1=e[3].buffer,r.prime2=e[4].buffer,r.exponent1=e[5].buffer,r.exponent2=e[6].buffer,r.coefficient=e[7].buffer,t=r}else t=new Ut.RsaPublicKey;return t.modulus=e[0].buffer,t.publicExponent=1===e[1][1]?e[1].buffer.slice(1):e[1].buffer.slice(3),t}},{key:"importAsmKey",value:function(e){var t=new Uint8Array(4-e.publicExponent.byteLength),r=[new Uint8Array(e.modulus),Lt(t,new Uint8Array(e.publicExponent))];return e instanceof Ut.RsaPrivateKey&&(r.push(new Uint8Array(e.privateExponent)),r.push(new Uint8Array(e.prime1)),r.push(new Uint8Array(e.prime2)),r.push(new Uint8Array(e.exponent1)),r.push(new Uint8Array(e.exponent2)),r.push(new Uint8Array(e.coefficient))),r}}]),t}();zt.RsaSsa="RSASSA-PKCS1-v1_5",zt.RsaPss="RSA-PSS",zt.RsaOaep="RSA-OAEP",zt.privateUsages=["sign","decrypt","unwrapKey"],zt.publicUsages=["verify","encrypt","wrapKey"];var qt=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"getDigest",value:function(e){switch(e){case"SHA-1":return new t.Sha1;case"SHA-256":return new t.Sha256;case"SHA-512":return new t.Sha512;default:throw new Fe("keyAlgorithm.hash: Is not recognized")}}},{key:"digest",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){var n,a;return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.getDigest(e.name),a=n.process(B.toUint8Array(t)).finish().result,r.abrupt("return",B.toArrayBuffer(a));case 3:case"end":return r.stop()}}),r,this)})))}}]),e}(),Gt=function(e){Object(f.a)(n,e);var r=Object(v.a)(n);function n(){return Object(p.a)(this,n),r.apply(this,arguments)}return Object(b.a)(n,[{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",zt.generateKey(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",zt.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",zt.importKey(e,t,r,n,a));case 1:case"end":return i.stop()}}),i)})))}},{key:"onEncrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.cipher(e,t,r));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"onDecrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.cipher(e,t,r));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(n.prototype),"checkCryptoKey",this).call(this,e,t),zt.checkCryptoKey(e)}},{key:"cipher",value:function(e,r,n){var a,i=qt.getDigest(r.algorithm.hash.name);e.label&&(a=B.toUint8Array(e.label));var o,u=new t.RSA_OAEP(r.data,i,a),c=B.toUint8Array(n);return o="public"===r.type?u.encrypt(c):u.decrypt(c),B.toArrayBuffer(o)}}]),n}(it),Wt=function(e){Object(f.a)(n,e);var r=Object(v.a)(n);function n(){return Object(p.a)(this,n),r.apply(this,arguments)}return Object(b.a)(n,[{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",zt.generateKey(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",zt.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",zt.importKey(e,t,r,n,a));case 1:case"end":return i.stop()}}),i)})))}},{key:"onSign",value:function(e,r,n){return S(this,void 0,void 0,o.mark((function a(){var i,u;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=new t.RSA_PSS(r.data,qt.getDigest(r.algorithm.hash.name),e.saltLength),u=i.sign(B.toUint8Array(n)),a.abrupt("return",B.toArrayBuffer(u));case 3:case"end":return a.stop()}}),a)})))}},{key:"onVerify",value:function(e,r,n,a){return S(this,void 0,void 0,o.mark((function i(){var u;return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:u=new t.RSA_PSS(r.data,qt.getDigest(r.algorithm.hash.name),e.saltLength),i.prev=1,u.verify(B.toUint8Array(n),B.toUint8Array(a)),i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(1),i.abrupt("return",!1);case 8:return i.abrupt("return",!0);case 9:case"end":return i.stop()}}),i,null,[[1,5]])})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(n.prototype),"checkCryptoKey",this).call(this,e,t),zt.checkCryptoKey(e)}}]),n}(at),Zt=function(e){Object(f.a)(n,e);var r=Object(v.a)(n);function n(){return Object(p.a)(this,n),r.apply(this,arguments)}return Object(b.a)(n,[{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",zt.generateKey(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",zt.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",zt.importKey(e,t,r,n,a));case 1:case"end":return i.stop()}}),i)})))}},{key:"onSign",value:function(e,r,n){return S(this,void 0,void 0,o.mark((function e(){var a,i;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new t.RSA_PKCS1_v1_5(r.data,qt.getDigest(r.algorithm.hash.name)),i=a.sign(B.toUint8Array(n)),e.abrupt("return",B.toArrayBuffer(i));case 3:case"end":return e.stop()}}),e)})))}},{key:"onVerify",value:function(e,r,n,a){return S(this,void 0,void 0,o.mark((function e(){var i;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=new t.RSA_PKCS1_v1_5(r.data,qt.getDigest(r.algorithm.hash.name)),e.prev=1,i.verify(B.toUint8Array(n),B.toUint8Array(a)),e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(1),e.abrupt("return",!1);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e,null,[[1,5]])})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(n.prototype),"checkCryptoKey",this).call(this,e,t),zt.checkCryptoKey(e)}}]),n}(nt),Xt=function(e){Object(f.a)(n,e);var r=Object(v.a)(n);function n(){var e;return Object(p.a)(this,n),(e=r.apply(this,arguments)).name="RSAES-PKCS1-v1_5",e.usages={publicKey:["encrypt","wrapKey"],privateKey:["decrypt","unwrapKey"]},e.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],e}return Object(b.a)(n,[{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",zt.generateKey(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"checkGenerateKeyParams",value:function(e){if(this.checkRequiredProperty(e,"publicExponent"),!(e.publicExponent&&e.publicExponent instanceof Uint8Array))throw new TypeError("publicExponent: Missing or not a Uint8Array");var t=j.ToBase64(e.publicExponent);if("Aw=="!==t&&"AQAB"!==t)throw new TypeError("publicExponent: Must be [3] or [1,0,1]");switch(this.checkRequiredProperty(e,"modulusLength"),e.modulusLength){case 1024:case 2048:case 4096:break;default:throw new TypeError("modulusLength: Must be 1024, 2048, or 4096")}}},{key:"onDecrypt",value:function(e,r,n){return S(this,void 0,void 0,o.mark((function e(){var a,i,u;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new t.RSA(r.data).decrypt(new t.BigNumber(B.toUint8Array(n))).result,i=r.algorithm.modulusLength>>3,n.byteLength===i){e.next=4;break}throw new Je("Decryption error. Encrypted message size doesn't match to key length");case 4:if(u=0,!a[u++]&&2===a[u++]){e.next=7;break}throw new Je("Decryption error");case 7:if(0!==a[u++]){e.next=9;break}return e.abrupt("break",10);case 9:if(u<a.length){e.next=7;break}case 10:if(!(u<11)){e.next=12;break}throw new Je("Decryption error. PS is less than 8 octets.");case 12:if(u!==a.length){e.next=14;break}throw new Je("Decryption error. There is no octet with hexadecimal value 0x00 to separate PS from M");case 14:return e.abrupt("return",a.buffer.slice(u));case 15:case"end":return e.stop()}}),e)})))}},{key:"onEncrypt",value:function(e,r,n){return S(this,void 0,void 0,o.mark((function e(){var a,i,u,c,s;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.algorithm.modulusLength>>3,!(n.byteLength>a-11)){e.next=3;break}throw new Je("Message too long");case 3:return i=a-n.byteLength-3,u=zt.randomNonZeroValues(new Uint8Array(i)),(c=new Uint8Array(a))[0]=0,c[1]=2,c.set(u,2),c[2+i]=0,c.set(new Uint8Array(n),3+i),s=new t.RSA(r.data).encrypt(new t.BigNumber(c)).result,e.abrupt("return",B.toArrayBuffer(s));case 13:case"end":return e.stop()}}),e)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",zt.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){var u;return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,zt.importKey(e,t,Object.assign(Object.assign({},r),{name:this.name}),n,a);case 2:return u=i.sent,i.abrupt("return",u);case 4:case"end":return i.stop()}}),i,this)})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(n.prototype),"checkCryptoKey",this).call(this,e,t),zt.checkCryptoKey(e)}},{key:"prepareSignData",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){var n;return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=new tn,r.abrupt("return",n.subtle.digest(e.hash,t));case 2:case"end":return r.stop()}}),r)})))}}]),n}(We),$t={"1.2.840.10045.3.1.7":"P-256","P-256":"1.2.840.10045.3.1.7","1.3.132.0.34":"P-384","P-384":"1.3.132.0.34","1.3.132.0.35":"P-521","P-521":"1.3.132.0.35","1.3.132.0.10":"K-256","K-256":"1.3.132.0.10"};function Yt(e){var t=$t[e];if(!t)throw new ze("Cannot convert WebCrypto named curve '".concat(e,"' to OID"));return t}var Qt=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n,a,i,o){var u;return Object(p.a)(this,r),(u=t.call(this,e,n,a,i)).data=o,u}return r}(Ht),er=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"checkLib",value:function(){if("undefined"===typeof m)throw new ze("Cannot implement EC mechanism. Add 'https://peculiarventures.github.io/pv-webcrypto-tests/src/elliptic.js' script to your project")}},{key:"generateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){var a,i,u,c,s=this;return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.checkLib(),a=this.initEcKey(e.namedCurve),(i=a.genKeyPair()).getPublic(),u=new Qt(Object.assign({},e),t,"private",r.filter((function(e){return~s.privateUsages.indexOf(e)})),i),c=new Qt(Object.assign({},e),!0,"public",r.filter((function(e){return~s.publicUsages.indexOf(e)})),i),n.abrupt("return",{privateKey:u,publicKey:c});case 7:case"end":return n.stop()}}),n,this)})))}},{key:"checkCryptoKey",value:function(e){if(!(e instanceof Qt))throw new TypeError("key: Is not EcCryptoKey")}},{key:"concat",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=new Uint8Array(t.map((function(e){return e.length})).reduce((function(e,t){return e+t}))),a=0;return t.forEach((function(e,t){for(var r=0;r<e.length;r++)n[a+r]=e[r];a+=e.length})),n}},{key:"exportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:this.checkLib(),r.t0=e,r.next="pkcs8"===r.t0?4:"spki"===r.t0?5:"jwk"===r.t0?6:"raw"===r.t0?7:8;break;case 4:return r.abrupt("return",this.exportPkcs8Key(t));case 5:return r.abrupt("return",this.exportSpkiKey(t));case 6:return r.abrupt("return",this.exportJwkKey(t));case 7:return r.abrupt("return",new Uint8Array(t.data.getPublic("der")).buffer);case 8:throw new ze("format: Must be 'jwk', 'raw, 'pkcs8' or 'spki'");case 9:case"end":return r.stop()}}),r,this)})))}},{key:"importKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){var u,c;return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:this.checkLib(),i.t0=e,i.next="pkcs8"===i.t0?4:"spki"===i.t0?6:"raw"===i.t0?8:"jwk"===i.t0?10:12;break;case 4:return u=this.importPkcs8Key(t,r.namedCurve),i.abrupt("break",13);case 6:return u=this.importSpkiKey(t,r.namedCurve),i.abrupt("break",13);case 8:return u=this.importEcKey(new Ut.EcPublicKey(t),r.namedCurve),i.abrupt("break",13);case 10:return u=this.importJwkKey(t),i.abrupt("break",13);case 12:throw new ze("format: Must be 'jwk', 'raw', 'pkcs8' or 'spki'");case 13:return c=new Qt(Object.assign({},r),n,u.priv?"private":"public",a,u),i.abrupt("return",c);case 15:case"end":return i.stop()}}),i,this)})))}},{key:"getNamedCurve",value:function(e){var t=e.toUpperCase(),r="";if(["P-256","P-384","P-521"].indexOf(t)>-1)r=t.replace("-","").toLowerCase();else{if("K-256"!==t)throw new ze("Unsupported named curve '".concat(e,"'"));r="secp256k1"}return r}},{key:"initEcKey",value:function(e){return r.ec(this.getNamedCurve(e))}},{key:"exportPkcs8Key",value:function(e){var t=new Ut.PrivateKeyInfo;return t.privateKeyAlgorithm.algorithm=this.ASN_ALGORITHM,t.privateKeyAlgorithm.parameters=Oe.serialize(new Ut.ObjectIdentifier(Yt(e.algorithm.namedCurve))),t.privateKey=Oe.serialize(this.exportEcKey(e)),Oe.serialize(t)}},{key:"importPkcs8Key",value:function(e,t){var r=Oe.parse(e,Ut.PrivateKeyInfo),n=Oe.parse(r.privateKey,Ut.EcPrivateKey);return this.importEcKey(n,t)}},{key:"importSpkiKey",value:function(e,t){var r=Oe.parse(e,Ut.PublicKeyInfo),n=new Ut.EcPublicKey(r.publicKey);return this.importEcKey(n,t)}},{key:"exportSpkiKey",value:function(e){var t=new Ut.EcPublicKey(new Uint8Array(e.data.getPublic("der")).buffer),r=new Ut.PublicKeyInfo;return r.publicKeyAlgorithm.algorithm=this.ASN_ALGORITHM,r.publicKeyAlgorithm.parameters=Oe.serialize(new Ut.ObjectIdentifier(Yt(e.algorithm.namedCurve))),r.publicKey=t.value,Oe.serialize(r)}},{key:"importJwkKey",value:function(e){var t;return t=e.d?De.fromJSON(e,{targetSchema:Ut.EcPrivateKey}):De.fromJSON(e,{targetSchema:Ut.EcPublicKey}),this.importEcKey(t,e.crv)}},{key:"exportJwkKey",value:function(e){var t=this.exportEcKey(e),r=Re.toJSON(t);return r.ext=!0,r.key_ops=e.usages,r.crv=e.algorithm.namedCurve,r.kty="EC",r}},{key:"exportEcKey",value:function(e){if("private"===e.type){var t=new Ut.EcPrivateKey,r=new Uint8Array(e.data.getPrivate("der").toArray()),n=new Uint8Array(this.getPointSize(e.algorithm.namedCurve)-r.length);return t.privateKey=Lt(n,r),t.publicKey=new Uint8Array(e.data.getPublic("der")),t}if(e.data.pub)return new Ut.EcPublicKey(new Uint8Array(e.data.getPublic("der")).buffer);throw new Error("Cannot get private or public key")}},{key:"importEcKey",value:function(e,t){var r=this.initEcKey(t);return e instanceof Ut.EcPublicKey?r.keyFromPublic(new Uint8Array(e.value)):r.keyFromPrivate(new Uint8Array(e.privateKey))}},{key:"getPointSize",value:function(e){switch(e){case"P-256":case"K-256":return 32;case"P-384":return 48;case"P-521":return 66}throw new Error("namedCurve: Is not recognized")}}]),e}();er.privateUsages=["sign","deriveKey","deriveBits"],er.publicUsages=["verify"],er.ASN_ALGORITHM="1.2.840.10045.2.1";var tr=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return Object(b.a)(r,[{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",er.generateKey(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",er.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",er.importKey(e,t,r,n,a));case 1:case"end":return i.stop()}}),i)})))}},{key:"onDeriveBits",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){var a,i,u,c;return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return er.checkLib(),a=t.data.derive(e.public.data.getPublic()),i=new Uint8Array(a.toArray()),u=(u=i.length)>32?u>48?66:48:32,i.length<u&&(i=er.concat(new Uint8Array(u-i.length),i)),c=i.slice(0,r/8).buffer,n.abrupt("return",c);case 8:case"end":return n.stop()}}),n)})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(r.prototype),"checkCryptoKey",this).call(this,e,t),er.checkCryptoKey(e)}}]),r}(lt);function rr(e){for(var t=new Uint8Array(e),r=[],n=0;n<t.length;n++)r.push(t[n]);return r}function nr(e,t){e.length%2&&(e="0"+e);for(var r=new Uint8Array(e.length/2),n=0;n<e.length;n++){var a=e.slice(n,1+ ++n);r[(n-1)/2]=parseInt(a,16)}if(t){var i=r.length;i=i>32?i>48?66:48:32,r.length<i&&(r=er.concat(new Uint8Array(i-r.length),r))}return r}function ar(e,t){for(var r="",n=0;n<e.length;n++){var a=e[n].toString(16);r+=a.length%2?"0"+a:a}if(t){var i=e.length;i=i>32?i>48?66:48:32,r.length/2<i&&(r=new Array(2*i-r.length+1).join("0")+r)}return r}var ir=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return Object(b.a)(r,[{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",er.generateKey(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",er.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",er.importKey(e,t,r,n,a));case 1:case"end":return i.stop()}}),i)})))}},{key:"onSign",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){var a,i,u,c,s;return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return er.checkLib(),a=new tn,n.next=4,a.subtle.digest(e.hash,r);case 4:return u=n.sent,i=rr(u),n.next=8,t.data.sign(i);case 8:return c=n.sent,s=ar(c.r.toArray(),!0)+ar(c.s.toArray(),!0),n.abrupt("return",nr(s).buffer);case 11:case"end":return n.stop()}}),n)})))}},{key:"onVerify",value:function(e,t,r,n){return S(this,void 0,void 0,o.mark((function a(){var i,u,c,s;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return er.checkLib(),i=new tn,u={r:new Uint8Array(r.slice(0,r.byteLength/2)),s:new Uint8Array(r.slice(r.byteLength/2))},a.next=5,i.subtle.digest(e.hash,n);case 5:return c=a.sent,s=rr(c),a.abrupt("return",t.data.verify(s,u));case 8:case"end":return a.stop()}}),a)})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(r.prototype),"checkCryptoKey",this).call(this,e,t),er.checkCryptoKey(e)}}]),r}(ut),or=(g={},Object(a.a)(g,Ut.idEd448,"Ed448"),Object(a.a)(g,"ed448",Ut.idEd448),Object(a.a)(g,Ut.idX448,"X448"),Object(a.a)(g,"x448",Ut.idX448),Object(a.a)(g,Ut.idEd25519,"Ed25519"),Object(a.a)(g,"ed25519",Ut.idEd25519),Object(a.a)(g,Ut.idX25519,"X25519"),Object(a.a)(g,"x25519",Ut.idX25519),g);function ur(e){var t=or[e.toLowerCase()];if(!t)throw new ze("Cannot convert WebCrypto named curve '".concat(e,"' to OID"));return t}var cr=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e,r,a,i){var o;return Object(p.a)(this,n),(o=t.call(this,e,r,"private",a)).data=i,o}return Object(b.a)(n,[{key:"toJSON",value:function(){var e={kty:"OKP",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(e,{d:j.ToBase64Url(j.FromHex(/^ed/i.test(e.crv)?this.data.getSecret("hex"):this.data.getPrivate("hex")))})}},{key:"fromJSON",value:function(e){if(!e.d)throw new ze("Cannot get private data from JWK. Property 'd' is required");if(!e.crv)throw new ze("Cannot get named curve from JWK. Property 'crv' is required");var t=j.ToHex(j.FromBase64Url(e.d));if(/^ed/i.test(e.crv)){var n=new r.eddsa(e.crv.toLowerCase());this.data=n.keyFromSecret(t)}else{var a=r.ec(e.crv.replace(/^x/i,"curve"));this.data=a.keyFromPrivate(t,"hex")}return this}}]),n}(Ht),sr=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e,r,a,i){var o;return Object(p.a)(this,n),(o=t.call(this,e,r,"public",a)).data=i,o}return Object(b.a)(n,[{key:"toJSON",value:function(){var e={kty:"OKP",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(e,{x:j.ToBase64Url(j.FromHex(this.data.getPublic("hex")))})}},{key:"fromJSON",value:function(e){if(!e.crv)throw new ze("Cannot get named curve from JWK. Property 'crv' is required");if(!e.x)throw new ze("Cannot get property from JWK. Property 'x' is required");var t=j.ToHex(j.FromBase64Url(e.x));if(/^ed/i.test(e.crv)){var n=new r.eddsa(e.crv.toLowerCase());this.data=n.keyFromPublic(t,"hex")}else{var a=r.ec(e.crv.replace(/^x/i,"curve"));this.data=a.keyFromPublic(t,"hex")}return this}}]),n}(Ht),lr=function(){function t(){Object(p.a)(this,t)}return Object(b.a)(t,null,[{key:"checkLib",value:function(){if("undefined"===typeof m)throw new ze("Cannot implement EC mechanism. Add 'https://peculiarventures.github.io/pv-webcrypto-tests/src/elliptic.js' script to your project")}},{key:"concat",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=new Uint8Array(t.map((function(e){return e.length})).reduce((function(e,t){return e+t}))),a=0;return t.forEach((function(e,t){for(var r=0;r<e.length;r++)n[a+r]=e[r];a+=e.length})),n}},{key:"generateKey",value:function(t,n,a){return S(this,void 0,void 0,o.mark((function i(){var u,c,s,l,h,f,v=this;return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return this.checkLib(),"ed25519"===(u="x25519"===t.namedCurve.toLowerCase()?"curve25519":"ed25519")?(s=e.nativeCrypto.getRandomValues(new Uint8Array(32)),l=new r.eddsa(u),c=l.keyFromSecret(s)):(c=r.ec(u).genKeyPair()).getPublic(),h=new cr(t,n,a.filter((function(e){return-1!==v.privateKeyUsages.indexOf(e)})),c),f=new sr(t,!0,a.filter((function(e){return-1!==v.publicKeyUsages.indexOf(e)})),c),i.abrupt("return",{privateKey:h,publicKey:f});case 6:case"end":return i.stop()}}),i,this)})))}},{key:"sign",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function e(){var n,a;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkLib(),n=rr(r),a=t.data.sign(n).toHex(),e.abrupt("return",j.FromHex(a));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"verify",value:function(e,t,r,n){return S(this,void 0,void 0,o.mark((function e(){var a,i;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkLib(),a=rr(n),i=t.data.verify(a,j.ToHex(r)),e.abrupt("return",i);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"deriveBits",value:function(e,r,n){return S(this,void 0,void 0,o.mark((function a(){var i,u,c,s;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return this.checkLib(),i=r.data.derive(e.public.data.getPublic()),u=new Uint8Array(i.toArray()),c=(c=u.length)>32?c>48?66:48:32,u.length<c&&(u=t.concat(new Uint8Array(c-u.length),u)),s=u.slice(0,n/8).buffer,a.abrupt("return",s);case 8:case"end":return a.stop()}}),a,this)})))}},{key:"exportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){var n,a,i,u;return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:this.checkLib(),r.t0=e.toLowerCase(),r.next="jwk"===r.t0?4:"pkcs8"===r.t0?5:"spki"===r.t0?10:"raw"===r.t0?15:16;break;case 4:return r.abrupt("return",Re.toJSON(t));case 5:return n=j.FromHex(/^x/i.test(t.algorithm.namedCurve)?t.data.getPrivate("hex"):t.data.getSecret("hex")),(a=new Ut.PrivateKeyInfo).privateKeyAlgorithm.algorithm=ur(t.algorithm.namedCurve),a.privateKey=Oe.serialize(new he(n)),r.abrupt("return",Oe.serialize(a));case 10:return i=j.FromHex(t.data.getPublic("hex")),(u=new Ut.PublicKeyInfo).publicKeyAlgorithm.algorithm=ur(t.algorithm.namedCurve),u.publicKey=i,r.abrupt("return",Oe.serialize(u));case 15:return r.abrupt("return",j.FromHex(t.data.getPublic("hex")));case 16:throw new ze("format: Must be 'jwk', 'raw', pkcs8' or 'spki'");case 17:case"end":return r.stop()}}),r,this)})))}},{key:"importKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){var u,c,s,l,h;return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:this.checkLib(),i.t0=e.toLowerCase(),i.next="jwk"===i.t0?4:"raw"===i.t0?13:"spki"===i.t0?14:"pkcs8"===i.t0?16:19;break;case 4:if(!(u=t).d){i.next=10;break}return c=De.fromJSON(t,{targetSchema:Ut.CurvePrivateKey}),i.abrupt("return",this.importPrivateKey(c,r,n,a));case 10:if(u.x){i.next=12;break}throw new TypeError("keyData: Cannot get required 'x' filed");case 12:return i.abrupt("return",this.importPublicKey(j.FromBase64Url(u.x),r,n,a));case 13:return i.abrupt("return",this.importPublicKey(t,r,n,a));case 14:return s=Oe.parse(new Uint8Array(t),Ut.PublicKeyInfo),i.abrupt("return",this.importPublicKey(s.publicKey,r,n,a));case 16:return l=Oe.parse(new Uint8Array(t),Ut.PrivateKeyInfo),h=Oe.parse(l.privateKey,Ut.CurvePrivateKey),i.abrupt("return",this.importPrivateKey(h,r,n,a));case 19:throw new ze("format: Must be 'jwk', 'raw', 'pkcs8' or 'spki'");case 20:case"end":return i.stop()}}),i,this)})))}},{key:"importPrivateKey",value:function(e,t,r,n){var a=new cr(Object.assign({},t),r,n,null);return a.fromJSON({crv:t.namedCurve,d:j.ToBase64Url(e.d)}),a}},{key:"importPublicKey",value:function(e,t,r,n){return S(this,void 0,void 0,o.mark((function a(){var i;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return(i=new sr(Object.assign({},t),r,n,null)).fromJSON({crv:t.namedCurve,x:j.ToBase64Url(e)}),a.abrupt("return",i);case 3:case"end":return a.stop()}}),a)})))}}]),t}();lr.publicKeyUsages=["verify"],lr.privateKeyUsages=["sign","deriveKey","deriveBits"];var hr=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).namedCurves=["Ed25519"],e}return Object(b.a)(r,[{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){var a;return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,lr.generateKey({name:this.name,namedCurve:e.namedCurve.replace(/^ed/i,"Ed")},t,r);case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"onSign",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",lr.sign(e,t,new Uint8Array(r)));case 1:case"end":return n.stop()}}),n)})))}},{key:"onVerify",value:function(e,t,r,n){return S(this,void 0,void 0,o.mark((function a(){return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",lr.verify(e,t,new Uint8Array(r),new Uint8Array(n)));case 1:case"end":return a.stop()}}),a)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",lr.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){var u;return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,lr.importKey(e,t,Object.assign(Object.assign({},r),{name:this.name}),n,a);case 2:return u=i.sent,i.abrupt("return",u);case 4:case"end":return i.stop()}}),i,this)})))}}]),r}(ht),fr=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="SHA-1",e.usages=[],e}return Object(b.a)(r,[{key:"onDigest",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",qt.digest(e,t));case 1:case"end":return r.stop()}}),r)})))}}]),r}(We),vr=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="SHA-256",e}return r}(fr),yr=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).name="SHA-512",e}return r}(fr),pr=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n,a,i){var o;return Object(p.a)(this,r),(o=t.call(this,e,n,"secret",a)).raw=i,o}return r}(Ht),br=function(e){Object(f.a)(n,e);var r=Object(v.a)(n);function n(){return Object(p.a)(this,n),r.apply(this,arguments)}return Object(b.a)(n,[{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new pr(r,n,a,B.toUint8Array(t)));case 1:case"end":return e.stop()}}),e)})))}},{key:"onDeriveBits",value:function(e,r,n){return S(this,void 0,void 0,o.mark((function a(){var i,u,c;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:u=B.toUint8Array(e.salt),c=r.raw,a.t0=e.hash.name.toUpperCase(),a.next="SHA-1"===a.t0?5:"SHA-256"===a.t0?7:"SHA-512"===a.t0?9:11;break;case 5:return i=t.Pbkdf2HmacSha1(c,u,e.iterations,n>>3),a.abrupt("break",12);case 7:return i=t.Pbkdf2HmacSha256(c,u,e.iterations,n>>3),a.abrupt("break",12);case 9:return i=t.Pbkdf2HmacSha512(c,u,e.iterations,n>>3),a.abrupt("break",12);case 11:throw new ze("algorithm.hash: '".concat(e.hash.name,"' hash algorithm is not supported"));case 12:return a.abrupt("return",B.toArrayBuffer(i));case 13:case"end":return a.stop()}}),a)})))}},{key:"checkCryptoKey",value:function(e,t){if(Object(l.a)(Object(h.a)(n.prototype),"checkCryptoKey",this).call(this,e,t),!(e instanceof pr))throw new TypeError("key: Is not PbkdfCryptoKey")}}]),n}(vt),dr=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24],gr=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11],kr=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7],mr={readUInt32BE:function(e,t){return(e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])>>>0},writeUInt32BE:function(e,t,r){e[0+r]=t>>>24,e[1+r]=t>>>16&255,e[2+r]=t>>>8&255,e[3+r]=255&t},ip:function(e,t,r,n){for(var a=0,i=0,o=6;o>=0;o-=2){for(var u=0;u<=24;u+=8)a<<=1,a|=t>>>u+o&1;for(u=0;u<=24;u+=8)a<<=1,a|=e>>>u+o&1}for(o=6;o>=0;o-=2){for(u=1;u<=25;u+=8)i<<=1,i|=t>>>u+o&1;for(u=1;u<=25;u+=8)i<<=1,i|=e>>>u+o&1}r[n+0]=a>>>0,r[n+1]=i>>>0},rip:function(e,t,r,n){for(var a=0,i=0,o=0;o<4;o++)for(var u=24;u>=0;u-=8)a<<=1,a|=t>>>u+o&1,a<<=1,a|=e>>>u+o&1;for(o=4;o<8;o++)for(u=24;u>=0;u-=8)i<<=1,i|=t>>>u+o&1,i<<=1,i|=e>>>u+o&1;r[n+0]=a>>>0,r[n+1]=i>>>0},pc1:function(e,t,r,n){for(var a=0,i=0,o=7;o>=5;o--){for(var u=0;u<=24;u+=8)a<<=1,a|=t>>u+o&1;for(u=0;u<=24;u+=8)a<<=1,a|=e>>u+o&1}for(u=0;u<=24;u+=8)a<<=1,a|=t>>u+o&1;for(o=1;o<=3;o++){for(u=0;u<=24;u+=8)i<<=1,i|=t>>u+o&1;for(u=0;u<=24;u+=8)i<<=1,i|=e>>u+o&1}for(u=0;u<=24;u+=8)i<<=1,i|=e>>u+o&1;r[n+0]=a>>>0,r[n+1]=i>>>0},r28shl:function(e,t){return e<<t&268435455|e>>>28-t},pc2:function(e,t,r,n){for(var a=0,i=0,o=dr.length>>>1,u=0;u<o;u++)a<<=1,a|=e>>>dr[u]&1;for(u=o;u<dr.length;u++)i<<=1,i|=t>>>dr[u]&1;r[n+0]=a>>>0,r[n+1]=i>>>0},expand:function(e,t,r){var n=0,a=0;n=(1&e)<<5|e>>>27;for(var i=23;i>=15;i-=4)n<<=6,n|=e>>>i&63;for(i=11;i>=3;i-=4)a|=e>>>i&63,a<<=6;a|=(31&e)<<1|e>>>31,t[r+0]=n>>>0,t[r+1]=a>>>0},substitute:function(e,t){for(var r=0,n=0;n<4;n++){r<<=4,r|=gr[64*n+(e>>>18-6*n&63)]}for(n=0;n<4;n++){r<<=4,r|=gr[256+64*n+(t>>>18-6*n&63)]}return r>>>0},permute:function(e){for(var t=0,r=0;r<kr.length;r++)t<<=1,t|=e>>>kr[r]&1;return t>>>0},padSplit:function(e,t,r){for(var n=e.toString(2);n.length<t;)n="0"+n;for(var a=[],i=0;i<t;i+=r)a.push(n.slice(i,i+r));return a.join(" ")}},wr=Or;function Or(e,t){if(!e)throw new Error(t||"Assertion failed")}function Br(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}Or.equal=function(e,t,r){if(e!=t)throw new Error(r||"Assertion failed: "+e+" != "+t)};var Ar=Br;Br.prototype._init=function(){},Br.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},Br.prototype._buffer=function(e,t){for(var r=Math.min(this.buffer.length-this.bufferOff,e.length-t),n=0;n<r;n++)this.buffer[this.bufferOff+n]=e[t+n];return this.bufferOff+=r,r},Br.prototype._flushBuffer=function(e,t){return this._update(this.buffer,0,e,t),this.bufferOff=0,this.blockSize},Br.prototype._updateEncrypt=function(e){var t=0,r=0,n=(this.bufferOff+e.length)/this.blockSize|0,a=new Array(n*this.blockSize);0!==this.bufferOff&&(t+=this._buffer(e,t),this.bufferOff===this.buffer.length&&(r+=this._flushBuffer(a,r)));for(var i=e.length-(e.length-t)%this.blockSize;t<i;t+=this.blockSize)this._update(e,t,a,r),r+=this.blockSize;for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return a},Br.prototype._updateDecrypt=function(e){for(var t=0,r=0,n=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,a=new Array(n*this.blockSize);n>0;n--)t+=this._buffer(e,t),r+=this._flushBuffer(a,r);return t+=this._buffer(e,t),a},Br.prototype.final=function(e){var t,r;return e&&(t=this.update(e)),r="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),t?t.concat(r):r},Br.prototype._pad=function(e,t){if(0===t)return!1;for(;t<e.length;)e[t++]=0;return!0},Br.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e},Br.prototype._unpad=function(e){return e},Br.prototype._finalDecrypt=function(){wr.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)};var jr=C((function(e){"function"===typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}})),xr=C((function(e){try{var t=w.default;if("function"!==typeof t.inherits)throw"";e.exports=t.inherits}catch(k){e.exports=jr}}));function Sr(){this.tmp=new Array(2),this.keys=null}function Cr(e){Ar.call(this,e);var t=new Sr;this._desState=t,this.deriveKeys(t,e.key)}xr(Cr,Ar);var Kr=Cr;Cr.create=function(e){return new Cr(e)};var Er=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];Cr.prototype.deriveKeys=function(e,t){e.keys=new Array(32),wr.equal(t.length,this.blockSize,"Invalid key length");var r=mr.readUInt32BE(t,0),n=mr.readUInt32BE(t,4);mr.pc1(r,n,e.tmp,0),r=e.tmp[0],n=e.tmp[1];for(var a=0;a<e.keys.length;a+=2){var i=Er[a>>>1];r=mr.r28shl(r,i),n=mr.r28shl(n,i),mr.pc2(r,n,e.keys,a)}},Cr.prototype._update=function(e,t,r,n){var a=this._desState,i=mr.readUInt32BE(e,t),o=mr.readUInt32BE(e,t+4);mr.ip(i,o,a.tmp,0),i=a.tmp[0],o=a.tmp[1],"encrypt"===this.type?this._encrypt(a,i,o,a.tmp,0):this._decrypt(a,i,o,a.tmp,0),i=a.tmp[0],o=a.tmp[1],mr.writeUInt32BE(r,i,n),mr.writeUInt32BE(r,o,n+4)},Cr.prototype._pad=function(e,t){for(var r=e.length-t,n=t;n<e.length;n++)e[n]=r;return!0},Cr.prototype._unpad=function(e){for(var t=e[e.length-1],r=e.length-t;r<e.length;r++)wr.equal(e[r],t);return e.slice(0,e.length-t)},Cr.prototype._encrypt=function(e,t,r,n,a){for(var i=t,o=r,u=0;u<e.keys.length;u+=2){var c=e.keys[u],s=e.keys[u+1];mr.expand(o,e.tmp,0),c^=e.tmp[0],s^=e.tmp[1];var l=mr.substitute(c,s),h=o;o=(i^mr.permute(l))>>>0,i=h}mr.rip(o,i,n,a)},Cr.prototype._decrypt=function(e,t,r,n,a){for(var i=r,o=t,u=e.keys.length-2;u>=0;u-=2){var c=e.keys[u],s=e.keys[u+1];mr.expand(i,e.tmp,0),c^=e.tmp[0],s^=e.tmp[1];var l=mr.substitute(c,s),h=i;i=(o^mr.permute(l))>>>0,o=h}mr.rip(i,o,n,a)};var Nr={};function Ur(e){wr.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}var Pr=function(e){function t(t){e.call(this,t),this._cbcInit()}xr(t,e);for(var r=Object.keys(Nr),n=0;n<r.length;n++){var a=r[n];t.prototype[a]=Nr[a]}return t.create=function(e){return new t(e)},t};Nr._cbcInit=function(){var e=new Ur(this.options.iv);this._cbcState=e},Nr._update=function(e,t,r,n){var a=this._cbcState,i=this.constructor.super_.prototype,o=a.iv;if("encrypt"===this.type){for(var u=0;u<this.blockSize;u++)o[u]^=e[t+u];i._update.call(this,o,0,r,n);for(u=0;u<this.blockSize;u++)o[u]=r[n+u]}else{i._update.call(this,e,t,r,n);for(u=0;u<this.blockSize;u++)r[n+u]^=o[u];for(u=0;u<this.blockSize;u++)o[u]=e[t+u]}};var Lr={instantiate:Pr};function Hr(e,t){wr.equal(t.length,24,"Invalid key length");var r=t.slice(0,8),n=t.slice(8,16),a=t.slice(16,24);this.ciphers="encrypt"===e?[Kr.create({type:"encrypt",key:r}),Kr.create({type:"decrypt",key:n}),Kr.create({type:"encrypt",key:a})]:[Kr.create({type:"decrypt",key:a}),Kr.create({type:"encrypt",key:n}),Kr.create({type:"decrypt",key:r})]}function Ir(e){Ar.call(this,e);var t=new Hr(this.type,this.options.key);this._edeState=t}xr(Ir,Ar);var Tr=Ir;Ir.create=function(e){return new Ir(e)},Ir.prototype._update=function(e,t,r,n){var a=this._edeState;a.ciphers[0]._update(e,t,r,n),a.ciphers[1]._update(r,n,r,n),a.ciphers[2]._update(r,n,r,n)},Ir.prototype._pad=Kr.prototype._pad,Ir.prototype._unpad=Kr.prototype._unpad;var Rr=mr,Dr=Ar,_r=Kr,Vr=Lr,Jr=Tr,Fr={utils:Rr,Cipher:Dr,DES:_r,CBC:Vr,EDE:Jr},Mr=Object.freeze(Object.assign(Object.create(null),Fr,{default:Fr,utils:Rr,Cipher:Dr,DES:_r,CBC:Vr,EDE:Jr})),zr=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n,a,i){var o;return Object(p.a)(this,r),(o=t.call(this,e,n,"secret",a)).raw=i,o}return Object(b.a)(r,[{key:"toJSON",value:function(){return{kty:"oct",alg:this.getJwkAlgorithm(),k:j.ToBase64Url(this.raw),ext:this.extractable,key_ops:this.usages}}},{key:"getJwkAlgorithm",value:function(){switch(this.algorithm.name.toUpperCase()){case"DES-CBC":return"DES-CBC";case"DES-EDE3-CBC":return"3DES-CBC";default:throw new Fe("Unsupported algorithm name")}}}]),r}(Ht),qr=function(){function t(){Object(p.a)(this,t)}return Object(b.a)(t,null,[{key:"checkLib",value:function(){if("undefined"===typeof Mr)throw new ze("Cannot implement DES mechanism. Add 'https://peculiarventures.github.io/pv-webcrypto-tests/src/des.js' script to your project")}},{key:"checkCryptoKey",value:function(e){if(!(e instanceof zr))throw new TypeError("key: Is not DesCryptoKey")}},{key:"generateKey",value:function(t,r,n){return S(this,void 0,void 0,o.mark((function a(){var i;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return this.checkLib(),i=e.nativeCrypto.getRandomValues(new Uint8Array(t.length/8)),a.abrupt("return",new zr(t,r,n,i));case 3:case"end":return a.stop()}}),a,this)})))}},{key:"exportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:this.checkLib(),r.t0=e,r.next="jwk"===r.t0?4:"raw"===r.t0?5:6;break;case 4:return r.abrupt("return",t.toJSON());case 5:return r.abrupt("return",t.raw.buffer);case 6:throw new ze("format: Must be 'jwk' or 'raw'");case 7:case"end":return r.stop()}}),r,this)})))}},{key:"importKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function e(){var i,u;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.checkLib(),i=Ge(t)?j.FromBase64Url(t.k):B.toArrayBuffer(t),!("DES-CBC"===r.name&&8!==i.byteLength||"DES-EDE3-CBC"===r.name&&24!==i.byteLength)){e.next=4;break}throw new ze("keyData: Is wrong key length");case 4:return u=new zr({name:r.name,length:i.byteLength<<3},n,a,new Uint8Array(i)),e.abrupt("return",u);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"encrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.cipher(e,t,r,!0));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"decrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.cipher(e,t,r,!1));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"cipher",value:function(e,t,r,n){return S(this,void 0,void 0,o.mark((function a(){var i,u,c,s;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:this.checkLib(),i=n?"encrypt":"decrypt",c=B.toUint8Array(e.iv),a.t0=e.name.toUpperCase(),a.next="DES-CBC"===a.t0?6:"DES-EDE3-CBC"===a.t0?8:10;break;case 6:return u=Vr.instantiate(_r).create({key:t.raw,type:i,iv:c}),a.abrupt("break",11);case 8:return u=Vr.instantiate(Jr).create({key:t.raw,type:i,iv:c}),a.abrupt("break",11);case 10:throw new ze("algorithm: Is not recognized");case 11:return s=u.update(new Uint8Array(r)).concat(u.final()),a.abrupt("return",new Uint8Array(s).buffer);case 13:case"end":return a.stop()}}),a,this)})))}}]),t}(),Gr=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).keySizeBits=64,e.ivSize=8,e.name="DES-CBC",e}return Object(b.a)(r,[{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",qr.generateKey(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",qr.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",qr.importKey(e,t,r,n,a));case 1:case"end":return i.stop()}}),i)})))}},{key:"onEncrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",qr.encrypt(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onDecrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",qr.decrypt(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(r.prototype),"checkCryptoKey",this).call(this,e,t),qr.checkCryptoKey(e)}}]),r}(tt),Wr=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(p.a)(this,r),(e=t.apply(this,arguments)).keySizeBits=192,e.ivSize=8,e.name="DES-EDE3-CBC",e}return Object(b.a)(r,[{key:"onGenerateKey",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",qr.generateKey(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",qr.exportKey(e,t));case 1:case"end":return r.stop()}}),r)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",qr.importKey(e,t,r,n,a));case 1:case"end":return i.stop()}}),i)})))}},{key:"onEncrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",qr.encrypt(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"onDecrypt",value:function(e,t,r){return S(this,void 0,void 0,o.mark((function n(){return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",qr.decrypt(e,t,r));case 1:case"end":return n.stop()}}),n)})))}},{key:"checkCryptoKey",value:function(e,t){Object(l.a)(Object(h.a)(r.prototype),"checkCryptoKey",this).call(this,e,t),qr.checkCryptoKey(e)}}]),r}(tt),Zr={fromJSON:function(e){return Buffer.from(j.FromBase64Url(e))},toJSON:function(e){return j.ToBase64Url(e)}},Xr=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"HMAC"},a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Uint8Array(0);return Object(p.a)(this,r),(e=t.call(this,n,a,"secret",i)).kty="oct",e.data=o,e}return Object(b.a)(r,[{key:"alg",get:function(){var e=this.algorithm.hash.name.toUpperCase();return"HS".concat(e.replace("SHA-",""))},set:function(e){}}]),r}(Ht);x([Ve({name:"ext",type:pe.Boolean,optional:!0})],Xr.prototype,"extractable",void 0),x([Ve({name:"key_ops",type:pe.String,repeated:!0,optional:!0})],Xr.prototype,"usages",void 0),x([Ve({name:"k",converter:Zr})],Xr.prototype,"data",void 0),x([Ve({type:pe.String})],Xr.prototype,"kty",void 0),x([Ve({type:pe.String})],Xr.prototype,"alg",null);var $r,Yr=function(r){Object(f.a)(a,r);var n=Object(v.a)(a);function a(){return Object(p.a)(this,a),n.apply(this,arguments)}return Object(b.a)(a,[{key:"onGenerateKey",value:function(t,r,n){return S(this,void 0,void 0,o.mark((function a(){var i,u,c;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=t.length||this.getDefaultLength(t.hash.name),u=e.nativeCrypto.getRandomValues(new Uint8Array(i>>3)),c=new Xr(t,r,n,u),a.abrupt("return",c);case 4:case"end":return a.stop()}}),a,this)})))}},{key:"onSign",value:function(e,r,n){return S(this,void 0,void 0,o.mark((function e(){var a,i;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r.algorithm.hash.name.toUpperCase(),e.next="SHA-1"===e.t0?3:"SHA-256"===e.t0?5:"SHA-512"===e.t0?7:9;break;case 3:return a=t.HmacSha1,e.abrupt("break",10);case 5:return a=t.HmacSha256,e.abrupt("break",10);case 7:return a=t.HmacSha512,e.abrupt("break",10);case 9:throw new ze("key.algorithm.hash: Is not recognized");case 10:return i=new a(r.data).process(B.toUint8Array(n)).finish().result,e.abrupt("return",B.toArrayBuffer(i));case 12:case"end":return e.stop()}}),e)})))}},{key:"onVerify",value:function(e,t,r,n){return S(this,void 0,void 0,o.mark((function a(){var i;return o.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.onSign(e,t,n);case 2:return i=a.sent,a.abrupt("return",j.ToHex(i)===j.ToHex(r));case 4:case"end":return a.stop()}}),a,this)})))}},{key:"onImportKey",value:function(e,t,r,n,a){return S(this,void 0,void 0,o.mark((function i(){var u;return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=e.toLowerCase(),i.next="jwk"===i.t0?3:"raw"===i.t0?5:9;break;case 3:return u=De.fromJSON(t,{targetSchema:Xr}),i.abrupt("break",10);case 5:if(B.isBufferSource(t)){i.next=7;break}throw new TypeError("keyData: Is not ArrayBuffer or ArrayBufferView");case 7:return u=new Xr(r,n,a,B.toUint8Array(t)),i.abrupt("break",10);case 9:throw new ze("format: Must be 'jwk' or 'raw'");case 10:return u.algorithm={hash:{name:r.hash.name},name:this.name,length:u.data.length<<3},u.extractable=n,u.usages=a,i.abrupt("return",u);case 14:case"end":return i.stop()}}),i,this)})))}},{key:"onExportKey",value:function(e,t){return S(this,void 0,void 0,o.mark((function r(){var n;return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=e.toLowerCase(),r.next="jwk"===r.t0?3:"raw"===r.t0?5:6;break;case 3:return n=Re.toJSON(t),r.abrupt("return",n);case 5:return r.abrupt("return",new Uint8Array(t.data).buffer);case 6:throw new ze("format: Must be 'jwk' or 'raw'");case 7:case"end":return r.stop()}}),r)})))}},{key:"checkCryptoKey",value:function(e,t){if(Object(l.a)(Object(h.a)(a.prototype),"checkCryptoKey",this).call(this,e,t),!(e instanceof Xr))throw new TypeError("key: Is not HMAC CryptoKey")}}]),a}(ft),Qr=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,a,i,o,u){var c;return Object(p.a)(this,r),c=t.call(this,e,a,i,o),$r.set(Object(n.a)(c),void 0),function(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");t.set(e,r)}(Object(n.a)(c),$r,u),c}return Object(b.a)(r,[{key:"getNative",value:function(){return function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}(this,$r)}}]),r}(Ht);$r=new WeakMap;var en=function(t){Object(f.a)(n,t);var r=Object(v.a)(n);function n(){var e;return Object(p.a)(this,n),(e=r.call(this)).browserInfo=function(){var e={name:Nt.Unknown,version:"0"};if("undefined"===typeof self)return e;var t,r=self.navigator.userAgent;return(t=/edge\/([\d\.]+)/i.exec(r))?(e.name=Nt.Edge,e.version=t[1]):/msie/i.test(r)?(e.name=Nt.IE,e.version=/msie ([\d\.]+)/i.exec(r)[1]):/Trident/i.test(r)?(e.name=Nt.IE,e.version=/rv:([\d\.]+)/i.exec(r)[1]):/chrome/i.test(r)?(e.name=Nt.Chrome,e.version=/chrome\/([\d\.]+)/i.exec(r)[1]):/firefox/i.test(r)?(e.name=Nt.Firefox,e.version=/firefox\/([\d\.]+)/i.exec(r)[1]):/mobile/i.test(r)?(e.name=Nt.Mobile,e.version=/mobile\/([\w]+)/i.exec(r)[1]):/safari/i.test(r)&&(e.name=Nt.Safari,e.version=/version\/([\d\.]+)/i.exec(r)[1]),e}(),e.providers.set(new Dt),e.providers.set(new Jt),e.providers.set(new _t),e.providers.set(new Vt),e.providers.set(new Ft),e.providers.set(new Gr),e.providers.set(new Wr),e.providers.set(new Zt),e.providers.set(new Wt),e.providers.set(new Gt),e.providers.set(new Xt),e.providers.set(new ir),e.providers.set(new tr),e.providers.set(new fr),e.providers.set(new vr),e.providers.set(new yr),e.providers.set(new br),e.providers.set(new Yr),e.providers.set(new hr),e}return Object(b.a)(n,[{key:"digest",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.wrapNative.apply(this,["digest"].concat(t)));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"importKey",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.fixFirefoxEcImportPkcs8(t),e.abrupt("return",this.wrapNative.apply(this,["importKey"].concat(t)));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"exportKey",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fixFirefoxEcExportPkcs8(t);case 2:if(e.t0=e.sent,e.t0){e.next=7;break}return e.next=6,this.wrapNative.apply(this,["exportKey"].concat(t));case 6:e.t0=e.sent;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"generateKey",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.wrapNative.apply(this,["generateKey"].concat(t)));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"sign",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.wrapNative.apply(this,["sign"].concat(t)));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"verify",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.wrapNative.apply(this,["verify"].concat(t)));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"encrypt",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.wrapNative.apply(this,["encrypt"].concat(t)));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"decrypt",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.wrapNative.apply(this,["decrypt"].concat(t)));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"wrapKey",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.wrapNative.apply(this,["wrapKey"].concat(t)));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"unwrapKey",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.wrapNative.apply(this,["unwrapKey"].concat(t)));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"deriveBits",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.wrapNative.apply(this,["deriveBits"].concat(t)));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"deriveKey",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return S(this,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.wrapNative.apply(this,["deriveKey"].concat(t)));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"wrapNative",value:function(t){for(var r=this,a=arguments.length,i=new Array(a>1?a-1:0),u=1;u<a;u++)i[u-1]=arguments[u];var c=function(e){return Object(l.a)(Object(h.a)(n.prototype),e,r)};return S(this,void 0,void 0,o.mark((function r(){var a,u,s,l,h,f,v,p,b,d,g,k,m,w,O;return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(~["generateKey","unwrapKey","deriveKey","importKey"].indexOf(t)&&this.fixAlgorithmName(i),r.prev=1,"digest"===t&&i.some((function(e){return e instanceof Ht}))){r.next=9;break}return a=this.fixNativeArguments(t,i),Pt.info("Call native '".concat(t,"' method"),a),r.next=7,e.nativeSubtle[t].apply(e.nativeSubtle,a);case 7:return u=r.sent,r.abrupt("return",this.fixNativeResult(t,i,u));case 9:r.next=14;break;case 11:r.prev=11,r.t0=r.catch(1),Pt.warn("Error on native '".concat(t,"' calling. ").concat(r.t0.message),r.t0);case 14:if("wrapKey"!==t){r.next=30;break}return r.prev=15,Pt.info("Trying to wrap key by using native functions",i),r.next=19,this.exportKey(i[0],i[1]);case 19:return s=r.sent,l="jwk"===i[0]?j.FromUtf8String(JSON.stringify(s)):s,r.next=23,this.encrypt(i[3],i[2],l);case 23:return h=r.sent,r.abrupt("return",h);case 27:r.prev=27,r.t1=r.catch(15),Pt.warn("Cannot wrap key by native functions. ".concat(r.t1.message),r.t1);case 30:if("unwrapKey"!==t){r.next=46;break}return r.prev=31,Pt.info("Trying to unwrap key by using native functions",i),r.next=35,this.decrypt(i[3],i[2],i[1]);case 35:return f=r.sent,v="jwk"===i[0]?JSON.parse(j.ToUtf8String(f)):f,r.next=39,this.importKey(i[0],v,i[4],i[5],i[6]);case 39:return p=r.sent,r.abrupt("return",p);case 43:r.prev=43,r.t2=r.catch(31),Pt.warn("Cannot unwrap key by native functions. ".concat(r.t2.message),r.t2);case 46:if("deriveKey"!==t){r.next=61;break}return r.prev=47,Pt.info("Trying to derive key by using native functions",i),r.next=51,this.deriveBits(i[0],i[1],i[2].length);case 51:return b=r.sent,r.next=54,this.importKey("raw",b,i[2],i[3],i[4]);case 54:return d=r.sent,r.abrupt("return",d);case 58:r.prev=58,r.t3=r.catch(47),Pt.warn("Cannot derive key by native functions. ".concat(r.t3.message),r.t3);case 61:if("deriveBits"!==t&&"deriveKey"!==t){r.next=81;break}g=Object(y.a)(i),r.prev=63,g.s();case 65:if((k=g.n()).done){r.next=73;break}if("object"!==typeof(m=k.value)||!m.public||!n.isAnotherKey(m.public)){r.next=71;break}return r.next=70,this.castKey(m.public);case 70:m.public=r.sent;case 71:r.next=65;break;case 73:r.next=78;break;case 75:r.prev=75,r.t4=r.catch(63),g.e(r.t4);case 78:return r.prev=78,g.f(),r.finish(78);case 81:w=0;case 82:if(!(w<i.length)){r.next=91;break}if(O=i[w],!n.isAnotherKey(O)){r.next=88;break}return r.next=87,this.castKey(O);case 87:i[w]=r.sent;case 88:w++,r.next=82;break;case 91:return r.abrupt("return",c(t).apply(this,i));case 92:case"end":return r.stop()}}),r,this,[[1,11],[15,27],[31,43],[47,58],[63,75,78,81]])})))}},{key:"fixNativeArguments",value:function(e,t){var r,n,a,o,u,c,s,l,h=Object(i.a)(t);if("importKey"===e&&(this.browserInfo.name!==Nt.IE||"jwk"!==(null===(n=null===(r=h[0])||void 0===r?void 0:r.toLowerCase)||void 0===n?void 0:n.call(r))||B.isBufferSource(h[1])||(h[1]=j.FromUtf8String(JSON.stringify(h[1])))),this.browserInfo.name===Nt.IE&&t[1]instanceof Qr)switch(e){case"sign":case"verify":case"encrypt":case"decrypt":h[0]=Object.assign(Object.assign({},this.prepareAlgorithm(h[0])),{hash:null===(u=null===(o=null===(a=h[1])||void 0===a?void 0:a.algorithm)||void 0===o?void 0:o.hash)||void 0===u?void 0:u.name});break;case"wrapKey":case"unwrapKey":h[4]=Object.assign(Object.assign({},this.prepareAlgorithm(h[4])),{hash:null===(l=null===(s=null===(c=h[3])||void 0===c?void 0:c.algorithm)||void 0===s?void 0:s.hash)||void 0===l?void 0:l.name})}for(var f=0;f<h.length;f++){var v=h[f];v instanceof Qr&&(h[f]=v.getNative())}return h}},{key:"fixNativeResult",value:function(e,t,r){var n,a;if(this.browserInfo.name===Nt.IE){if("exportKey"===e&&"jwk"===(null===(a=null===(n=t[0])||void 0===n?void 0:n.toLowerCase)||void 0===a?void 0:a.call(n))&&r instanceof ArrayBuffer)return JSON.parse(j.ToUtf8String(r));if("privateKey"in r){var i=["sign","decrypt","unwrapKey","deriveKey","deriveBits"],o=["verify","encrypt","wrapKey"];return{privateKey:this.wrapNativeKey(r.privateKey,t[0],t[1],t[2].filter((function(e){return i.includes(e)}))),publicKey:this.wrapNativeKey(r.publicKey,t[0],t[1],t[2].filter((function(e){return o.includes(e)})))}}if("extractable"in r){var u,c;switch(e){case"importKey":u=t[2],c=t[4];break;case"unwrapKey":u=t[4],c=t[6];break;case"generateKey":u=t[0],c=t[2];break;default:throw new ze("Cannot wrap native key. Unsupported method in use")}return this.wrapNativeKey(r,u,r.extractable,c)}}return r}},{key:"wrapNativeKey",value:function(e,t,r,n){if(this.browserInfo.name===Nt.IE){var a=["RSASSA-PKCS1-v1_5","RSA-PSS","RSA-OAEP","AES-CBC","AES-CTR","AES-KW","HMAC"],i=a.map((function(e){return e.toLowerCase()})).indexOf(e.algorithm.name.toLowerCase());if(-1!==i){var o=this.prepareAlgorithm(t),u=Object.assign(Object.assign({},e.algorithm),{name:a[i]});return bt.isHashedAlgorithm(o)&&(u.hash={name:o.hash.name.toUpperCase()}),Pt.info("Wrapping ".concat(a[i]," crypto key to WrappedNativeCryptoKey")),new Qr(u,r,e.type,n,e)}}return e}},{key:"castKey",value:function(e){return S(this,void 0,void 0,o.mark((function t(){var r,n;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Pt.info("Cast native CryptoKey to linter key.",e),e.extractable){t.next=3;break}throw new Error("Cannot cast unextractable crypto key");case 3:return r=this.getProvider(e.algorithm.name),t.next=6,this.exportKey("jwk",e);case 6:return n=t.sent,t.abrupt("return",r.importKey("jwk",n,e.algorithm,!0,e.usages));case 8:case"end":return t.stop()}}),t,this)})))}},{key:"fixAlgorithmName",value:function(e){if(this.browserInfo.name===Nt.Edge)for(var t=0;t<e.length;t++){var r=e[0];if("string"===typeof r){var n,a=Object(y.a)(this.providers.algorithms);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.toLowerCase()===r.toLowerCase()){e[t]=i;break}}}catch(on){a.e(on)}finally{a.f()}}else if("object"===typeof r&&"string"===typeof r.name){var o,u=Object(y.a)(this.providers.algorithms);try{for(u.s();!(o=u.n()).done;){var c=o.value;c.toLowerCase()===r.name.toLowerCase()&&(r.name=c),("string"===typeof r.hash&&c.toLowerCase()===r.hash.toLowerCase()||"object"===typeof r.hash&&"string"===typeof r.hash.name&&c.toLowerCase()===r.hash.name.toLowerCase())&&(r.hash={name:c})}}catch(on){u.e(on)}finally{u.f()}}}}},{key:"fixFirefoxEcImportPkcs8",value:function(e){var t=this.prepareAlgorithm(e[2]),r=t.name.toUpperCase();if(this.browserInfo.name===Nt.Firefox&&"pkcs8"===e[0]&&~["ECDSA","ECDH"].indexOf(r)&&~["P-256","P-384","P-521"].indexOf(t.namedCurve)){if(!B.isBufferSource(e[1]))throw new TypeError("data: Is not ArrayBuffer or ArrayBufferView");var n=B.toArrayBuffer(e[1]),a=Oe.parse(n,Ut.PrivateKeyInfo),i=Oe.parse(a.privateKey,Ut.EcPrivateKey),o=Re.toJSON(i);o.ext=!0,o.key_ops=e[4],o.crv=t.namedCurve,o.kty="EC",e[0]="jwk",e[1]=o}}},{key:"fixFirefoxEcExportPkcs8",value:function(e){return S(this,void 0,void 0,o.mark((function t(){var r,n,a;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.browserInfo.name!==Nt.Firefox||"pkcs8"!==e[0]||!~["ECDSA","ECDH"].indexOf(e[1].algorithm.name)||!~["P-256","P-384","P-521"].indexOf(e[1].algorithm.namedCurve)){t.next=11;break}return t.next=4,this.exportKey("jwk",e[1]);case 4:return r=t.sent,n=De.fromJSON(r,{targetSchema:Ut.EcPrivateKey}),(a=new Ut.PrivateKeyInfo).privateKeyAlgorithm.algorithm=er.ASN_ALGORITHM,a.privateKeyAlgorithm.parameters=Oe.serialize(new Ut.ObjectIdentifier(Yt(e[1].algorithm.namedCurve))),a.privateKey=Oe.serialize(n),t.abrupt("return",Oe.serialize(a));case 11:t.next=17;break;case 13:return t.prev=13,t.t0=t.catch(0),Pt.error(t.t0),t.abrupt("return",null);case 17:case"end":return t.stop()}}),t,this,[[0,13]])})))}}],[{key:"isAnotherKey",value:function(e){return"object"===typeof e&&"string"===typeof e.type&&"boolean"===typeof e.extractable&&"object"===typeof e.algorithm&&!(e instanceof Ht)}}]),n}(bt);en.methods=["digest","importKey","exportKey","sign","verify","generateKey","encrypt","decrypt","deriveBits","deriveKey","wrapKey","unwrapKey"];var tn=function(t){Object(f.a)(n,t);var r=Object(v.a)(n);function n(){var e;return Object(p.a)(this,n),(e=r.apply(this,arguments)).subtle=new en,e}return Object(b.a)(n,[{key:"nativeCrypto",get:function(){return e.nativeCrypto}},{key:"getRandomValues",value:function(t){return e.nativeCrypto.getRandomValues(t)}}]),n}(yt);function rn(e,t){var r=e[t];e[t]=function(){var n=arguments;return new Promise((function(a,i){var o=r.apply(e,n);o.oncomplete=function(e){a(e.target.result)},o.onerror=function(e){i("Error on running '".concat(t,"' function"))}}))}}"undefined"!==typeof self&&self.msCrypto&&(rn(e.nativeSubtle,"generateKey"),rn(e.nativeSubtle,"digest"),rn(e.nativeSubtle,"sign"),rn(e.nativeSubtle,"verify"),rn(e.nativeSubtle,"encrypt"),rn(e.nativeSubtle,"decrypt"),rn(e.nativeSubtle,"importKey"),rn(e.nativeSubtle,"exportKey"),rn(e.nativeSubtle,"wrapKey"),rn(e.nativeSubtle,"unwrapKey"),rn(e.nativeSubtle,"deriveKey"),rn(e.nativeSubtle,"deriveBits")),Math.imul||(Math.imul=function(e,t){var r=65535&e,n=65535&t;return r*n+((e>>>16&65535)*n+r*(t>>>16&65535)<<16>>>0)|0});var nn=self;e.nativeCrypto&&Object.freeze(e.nativeCrypto.getRandomValues);try{delete self.crypto,nn.crypto=new tn,Object.freeze(nn.crypto)}catch(k){Pt.error(k)}var an=nn.crypto;e.Crypto=tn,e.CryptoKey=Ht,e.crypto=an,e.setCrypto=function(t){e.nativeCrypto=t,e.nativeSubtle=t.subtle},Object.defineProperty(e,"__esModule",{value:!0})}({},self.asmCrypto,self.elliptic)}}]);
//# sourceMappingURL=11.d63ca6e2.chunk.js.map